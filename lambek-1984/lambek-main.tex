%!TEX root = lambek-1984-pal.tex
%\usepackage[dotinlabels]{titletoc}
%\titlelabel{{\thetitle}.\quad}
%\input{../helpers/psu-plain-titles.tex}
%\input{../helpers/psu-sc-headers.tex}
%\input{../helpers/fix-revtex-12.tex}
%\DeclareSymbolFont{CMlargesymbols}{OMX}{cmex}{m}{n}
%\DeclareMathSymbol{\sum}{\mathop}{CMlargesymbols}{"50}

\usepackage[papersize={6.6in, 10.0in}, left=.5in, right=.5in, top=.6in, bottom=.9in]{geometry}
\linespread{1.05}
\sloppy
\raggedbottom
\usepackage[leqno]{amsmath}

\pagestyle{plain}
\usepackage{mathpartir}
\usepackage{stmaryrd}
\usepackage{mathtools}
\usepackage{tikz-cd}
\usepackage{microtype}
\usepackage{amssymb}
\usepackage{enumitem}
\usepackage{nccmath}
\usetikzlibrary {arrows.meta,bending,positioning}

\newcommand{\mprime}{\ensuremath{^\prime}}

%\usepackage{fdsymbol}

% these include amsmath and that can cause trouble in older docs.
\input{../helpers/cmrsum}
\input{../helpers/fix-underbrace.tex}

% some nicer symbols
\input{../helpers/matha-symbols.tex}

\usepackage[tiny]{titlesec}
\titleformat{\section}
  {\normalfont\bfseries}
  {\thesection.}
  {.5em}
  {}

\usepackage{cite}

% make sure there is enough TOC for reasonable pdf bookmarks.
\setcounter{tocdepth}{3}
\usepackage{amsthm}

\theoremstyle{definition}


\usepackage[colorlinks=true
,breaklinks=true
,urlcolor=blue
,anchorcolor=blue
,citecolor=blue
,filecolor=blue
,linkcolor=blue
,menucolor=blue
,linktocpage=true]{hyperref}
\hypersetup{
bookmarksopen=true,
bookmarksnumbered=true,
bookmarksopenlevel=10,
}

\date{}
\def\trans{\Phi}
\def\mm{\Vdash}
\def\kxa{\kappa_{x \in A}}
\def\prAB{\pi_{A,B}}
\def\prpAB{\pi'_{A,B}}
\def\pr#1{\pi_{#1}}
\def\prp#1{\pi'_{#1}}
\def\to{\longrightarrow}
\def\xto#1{\xrightarrow{\kern.6em #1 \kern.6em}}
\def\sxto#1{\xrightarrow{\kern.3em #1 \kern.3em}}
\def\ent{\vdash}
\def\imp{\shortrightarrow}
\def\iff{\leftrightarrow}
\def\from{\Leftarrow}
\def\impl{\Rightarrow}
\def\union{\cup}
\def\fexp#1#2{#1^{#2}}
\def\fexpBA{\fexp{B}{A}}
\def\inc{\subseteq}
\def\dom{\mathop{\rm dom}}
\def\cod{\mathop{\rm cod}}
\def\id{{\mathrm 1}}
\def\res{\!\upharpoonleft\!}
\def\ffam{\varphi}
\def\comp{\circ}
\def\bbone{\mathbb 1}
\def\one{1}
\def\zeromap{0}
\def\bbzero{{\mathbb O}}
\def\ccc{{c.c.c.}}
\def\ev{\varepsilon}
\def\ebc{\varepsilon_{BC}}
\def\evBA{\varepsilon_{B,A}}
\def\L{\Lambda}
\def\LC{{\mathcal L}}
\def\MC{{\mathcal M}}
\def\l{\lambda}
\def\lamC{\l\text{-{\bf{\kern 0.2pt}calc}}}
\def\lx{\lambda_x}
\def\ly{\lambda_y}
\def\lu{\lambda_u}
\def\lv{\lambda_v}
\def\lz{\lambda_z}
\def\lxa{\l_{x \in A}}
\def\subX{\ensuremath{_\text{X}}}
\def\lm#1.#2{\lambda#1.\, #2}
\def\br#1{[\, #1 \, ]}
\def\V{V}
\def\U{U}
\def\D{D}
\def\cart{\text{\bf Cart}}
\def\C{\mathcal C}
\def\S{\mathcal S}
\def\lxy{\l x\, \l y . \,}
\def\lmm#1#2.#3{\l #1\, \l #2 . \, #3}
\def\sss{(*\!*\!*)}
\def\ss{(**)}
\def\ssn{(**_n)}
\def\scop{\S^{\C^{op}}}
\def\sland{\wedge}
\def\PU{\mathcal P U}
\def\P{\mathcal P}
\def\UU{(U\to U)}
\def\BA{B \to A}
\def\AB{A \to B}
\def\calA{{\cal A}}
\def\calB{{\cal B}}
\def\cI{{I}}
\def\cS{{S}}
\def\cK{{K}}
\def\cIA{\cI_{A}}
\def\cKAB{\cK_{A,B}}
\def\cSABC{\cS_{A,B,C}}
\def\la{\langle}
\def\ra{\rangle}
\def\bracket#1{\la #1 \ra}
\def\app{\mathop{{}^\wr}\kern-.8pt}
\def\schon{Sch\"onfinkel}
\def\nat{\mathbb N}
\def\pf{\varphi}

\newcommand{\be}{\begin{equation}}
\newcommand{\ee}{\end{equation}}
\newcommand{\bes}{\begin{equation*}}
\newcommand{\ees}{\end{equation*}}

\newcommand{\fcat}[1]{{\mathbf {#1}}} 
\newcommand{\Set}{\fcat{Sets}}
\newcommand{\grph}{\fcat{Grph}}

\DeclareMathOperator{\Hom}{{Hom}}

\newcommand{\iso}{\cong}                % Isomorphism
\newcommand{\eqv}{\simeq}               % Equivalence
\newcommand{\sub}{\subseteq}            % Subset (possibly not proper)

\usepackage{amsmath,amsthm}

\theoremstyle{definition}

\newtheorem{thm}{Theorem}[section]
\newtheorem{lemma}[thm]{Lemma}
\newtheorem{prop}[thm]{Proposition}
\newtheorem{cor}[thm]{Corollary}
\newtheorem{defn}[thm]{Definition}
\newtheorem{example}[thm]{Example}
\newtheorem{remark}[thm]{Remark}
\newtheorem{note}[thm]{Note}

% makes "=" with "x" under it
\makeatletter
\DeclareRobustCommand{\eqx}{\mathrel{\mathpalette\eq@{X}}}
\DeclareRobustCommand{\eqlx}{\mathrel{\mathpalette\eq@{x}}}
\DeclareRobustCommand{\eqy}{\mathrel{\mathpalette\eq@{Y}}}
\DeclareRobustCommand{\eqxx}{\mathrel{\mathpalette\eq@{X \union x}}}
\DeclareRobustCommand{\eqtx}{\mathrel{\mathpalette\eq@{\trans(X)}}}
\newcommand{\eq@}[2]{%
  \vtop{\offinterlineskip
    \ialign{\hfil##\hfil\cr
      $\m@th#1=$\cr % top
      \noalign{\sbox\z@{$\m@th#1\mkern0mu$}\kern-\wd\z@}
      $\m@th\alexey@demote{#1}#2$\cr
    }%
  }%
}
\DeclareRobustCommand{\eqdX}{\mathrel{\mathpalette\eqd@{X}}}
\DeclareRobustCommand{\eqdx}{\mathrel{\mathpalette\eqd@{x}}}
\newcommand{\eqd@}[2]{%
  \vtop{\offinterlineskip
    \ialign{\hfil##\hfil\cr
      $\m@th#1\doteq$\cr % top
      \noalign{\sbox\z@{$\m@th#1\mkern0mu$}\kern-\wd\z@}
      $\m@th\alexey@demote{#1}#2$\cr
    }%
  }%
}
\newcommand{\alexey@demote}[1]{%
  \ifx#1\displaystyle\scriptstyle\else
  \ifx#1\textstyle\scriptstyle\else
  \scriptscriptstyle\fi\fi
}

\makeatother

% footnote tricks
\usepackage{footmisc}
%\renewcommand{\thefootnote}{\fnsymbol{footnote}}

\makeatletter
\let\original@footnotemark\footnotemark
\newcommand{\align@footnotemark}{%
  \ifmeasuring@
    \chardef\@tempfn=\value{footnote}%
    \original@footnotemark
    \setcounter{footnote}{\@tempfn}%
  \else
    \iffirstchoice@
      \original@footnotemark
    \fi
  \fi}
\pretocmd{\start@align}{\let\footnotemark\align@footnotemark}{}{}
\makeatother

\makeatletter
\newcommand*\dotop{\mathpalette\bigcdot@{.6}}
\newcommand*\bigcdot@[2]{\mathbin{\vcenter{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

\title{\large Aspects of Higher Order Categorical Logic\footnote{The authors belong to the ``Groupe interuniversitaire en etudes categoriques'' in Montreal. They acknowledge support from the Natural Sciences and
Engineering Research Council of Canada and from the Quebec Department of
Education. They wish to thank Denis Higgs and the referee for their careful
reading of the manuscript.}}
\author{\normalsize J. Lambek and P. J. Scott}

\setcounter{section}{-1}
\begin{document}

\maketitle

\section{Introduction}

It has become clear for some time that categorists and logicians have been
doing the same thing under different names. This situation is strikingly
illustrated in higher order logic, where the connections are particularly
illuminating. In this article we briefly survey portions of our forthcoming
book [LS6], to which the reader is referred for more details.

Systems of higher order logic have been studied for a long time. We have
in mind logical systems in which variables and quantifiers range over functions
(as in the $\l$-calculus) or elements and subsets of given sets (as in type
theory), not just over individuals (as in first order logic). Higher order
concepts naturally occur in mathematics: algebraists quantify over ideals,
topologists over open sets and analysts over functions. Yet, in spite of its
expressive advantage, higher order logic never achieved the popularity of first
order logic. Perhaps its proof theory and model theory were deemed to be too
hard.

Thus, after the monumental work in type theory by Russell and Whitehead
(Principia Mathematica, 1908), there are only sporadic important contributions
to the literature. G\"{o}del (1931) established his incompleteness theorem for
type theory and related systems, Church (1940) combined $\l$-calculus with type
theory, Henkin (1949) discussed models for type theory and, more recently,
Abraham Robinson (1964) used type theory in his book ``Nonstandard Analysis'',
a lead not continued by his followers. Let us also mention that type theories
have recently become important in computer science.

Theories of functionality, namely $\l$-calculi, have fared somewhat better.
After pioneering work by Sch\"onfinkel, Curry, Church and Rosser in the 1920's
and 30's, these systems had a small but devoted following. In the late 60's,
an explosion of activity surrounding the models of Dana Scott (1971) and concomitant
work in computer science revived interest in them.

Meanwhile, the categorical side saw rapid development. The ready accept-
ance of category theory as a working language in many areas of mathematics
foreshadowed its introduction into logic and foundations. Nevertheless, it
came as a surprise to many people when, in the 1960's, Lawvere (1969, 1970) and
one of the present authors [L1] pointed out some remarkable connections between
category theory and logic. Indeed, after -the discovery of elementary toposes
by Lawvere and Tierney (1970), the field of "categorical logic" underwent
intense development. The reader is referred to the survey article by Kock and
Reyes (1977) and the monograph by Makkai and Reyes (1977).

The situation in higher order logic, as far as it is treated in our book,
is summarized as follows:

\medskip
\renewcommand{\arraystretch}{1.5}

\begin{center}
\begin{tabular}{ c | c }
 \hline
Logic & Algebra \\
 \hline
 untyped $\l$-calculus & C-monoids \\
 typed $\l$-calculus & cartesian closed categories \\
 type theory & toposes \\
 \hline
\end{tabular}
\end{center}
\medskip

\noindent
Indeed, we shall see that each side, when suitably formulated, gives rise to a
category. Moreover, the comparison between the two sides is mediated by
functors which set up an equivalence or adjointness. In the meantime, Robert
Seely, has found another such comparison:

\begin{center}
\begin{tabular}{ c | c }
 \hline
Logic & Algebra \\
 \hline
Martin-L\"of type theory  & locally cartesian closed categories \\
 \hline
\end{tabular}
\end{center}
\medskip

\noindent
Undoubtedly, there are many other such situations. For example, it would be
interesting to pinpoint the logical equivalent of cartesian closed categories
with equalizers.

\section{Cartesian closed categories and typed $\l$-calculi}

Cartesian closed categories are becoming increasingly important in many
branches of mathematics. Indeed, as we shall see, in logic they play a fundamental
role.

A {\em cartesian closed category} is a category $\C$ with (canonical) finite
products and exponentiation. This means that $\C$ has a terminal object $\one$ and
objects $A \times B$ and $\fexp{B}{A}$, for all $A,B$ in $\C$, together
with natural isomorphisms:

\bes
\Hom(C ,A) \times \Hom(C ,B)  \iso \Hom(C ,A \times B) ,
\tag{a}
\ees
\bes
\Hom(C \times A,B) \iso \Hom(C,\fexp{B}{A}).
\tag{b}
\ees

Cartesian closed categories abound in mathematics. For example, all
functor categories $\Set^{\C}$ ($\C$ small) and all toposes (see below) are cartesian
closed. So are the categories of Kelley spaces and Kuratowski limit spaces
(see MacLane, 1971).

A useful alternative presentation considers both products and exponentials
as adjoint functors, hence equationally definable (e.g., see MacLane, 1971).

\def\deq{\mathop{\cdot\mkern-5mu=\mkern-5mu\cdot}}

\begin{defn}
A {\em cartesian closed category} has the following objects,
arrows and equations:

\paragraph{Objects:}
\begin{enumerate}
\item[(i)] $\one$ is an object.
\item[(ii)] If $A$ and $B$ are objects, so are $A \times B$ and $\fexp{B}{A}$
\end{enumerate}

\paragraph{Arrows:}
\begin{enumerate}
\item[(i)] $1_A: A \to A$, $0_A: A \to \one$, $\prAB: A \times B \to A$, $\prpAB: A \times B \to B$, and $\evBA: \fexpBA \to A \times B$ are arrows.

\item[(ii)] The following rules generate new arrows from old:

\[
\inferrule {f: A \to B \quad g: B \to C}{gf: A \to C},\quad
\inferrule {f: C \to A \quad\! g: C \to B}{\la f, g \ra: C \to A \times B}, \quad
\inferrule {f: C \times A \to B}{f^*: C \to \fexpBA}
\]

\end{enumerate}

\paragraph{Equations:}
\begin{enumerate}
\item[(1)] $f1_A \doteq f$, $1_Bf \doteq f$, and $(hg)f \doteq g(hf)$,
for all $f:A \to B$, $g:B \to C$, $h: C\to D$;
\item[(2)] $f \doteq 0_A$, for all $f: A \to 1$;
$\prAB\bracket{f,g} \doteq f$, $\prpAB\bracket{f,g} \doteq g$, and
$\la\prAB h, \prpAB h\ra \doteq h$,
for all $f:C \to A$, $g:C \to B$, and $h: C\to A\sland B$;
\item[(3)] $\evBA\bracket{f^*\pr{C,A}, \prp{C,A}} \doteq f$, and
$(\evBA\bracket{g\,\pr{C,A}, \prp{C,A}})^* \doteq g$,
for all $f: C\times A \to B$, and $g: C \to \fexpBA$.
\end{enumerate}

\end{defn}
\noindent
It is understood that $\doteq$ is a congruence relation%
\footnote{Editor's note: the original paper used a symbol more like $\deq$ for this equivalence relation. I changed it to $\doteq$ because to really do it right I'd need to make a new glyph in some font somewhere and I don't want to do that.}
on $\Hom$-sets satisfying the
above. There may be other objects, arrows and equations than follow from the
above.

The reader may easily verify that the equations (1) to (3) contain not
only the equations of a category with a terminal object, but yield also the
natural isomorphisms (a) and (b). These equations may be viewed as presenting
a multi-sorted partial algebra structure on the $\Hom$-sets, with nullary, unary
and binary operations satisfying appropriate identities. Alternatively, they
may be looked upon as describing a ``graphical algebra'' in the spirit of
Burroni (1981). To see this, the reader may first wish to replace the rule of
arrow formation introducing $f^*$ by another basic arrow 
$\eta_{C,A}: C \to \fexp{(C \times A)}{A}$.

Another view of cartesian closed categories is to consider them as
{\em deductive systems} [Ll]. Write the objects $\one$, $A \times B$, and $\fexpBA$
as $\top$, $A \sland B$, and $A \impl B$ respectively. One may then think of an arrow
$f: A \to B$ as a {\em deduction} of $B$ from $A$ or as a {\em proof}
of the {\em entailment} $A \ent B$. Proofs may
be writ ten in ``tree form''. For example:

\[
\inferrule {A \sland B \xto{\pi'} B \quad A \sland B \xto{\pi} A}{A \sland B \xto{\la \pi', \pi \ra}  B \sland A}
\]
proves the commutative law for conjunction, while
\[
\inferrule{ }{(A \impl B) \sland A \xto{\evBA} B}
\]
may be regarded as an "axiom" (at least in a freely generated deductive system).

Logicians might say that we have presented a system of natural deduction
for the positive intuitionistic propositional calculus, but with an additional
twist: the equations of a cartesian closed category impose an {\em equality
relation} between proofs (or proof trees). For example:
\[
\begin{aligned}
\inferrule*
	{\inferrule*{C \xto{f} A \quad C \xto{g} B}
		{C \xto{\la f,g \ra} A \sland B} \\ A \sland B \xto{\pi} A}
	{C \xto{\pi\la f,g \ra} A }
\end{aligned} \quad \vbox to .5em{\hbox{\textrm{equals } $C \xto{f} A$}}
\]
This notion of ``equivalence of proofs'' is essentially the same as that intro-
duced by logicians (Prawitz, 1971), as pointed out by Mann (1975).

There is still another connection of cartesian closed categories to logic.
This is via the language of {\em typed $\l$-calculus}. Although older than category
theory, $\l$-calculus may also be regarded as an equational theory of functions
(or functional processes) in which composition is mirrored by substitution.
As we shall see, some problems in cartesian closed categories are efficiently
handled using typed $\l$-calculus.

\begin{defn}
A {\em typed $\l$-calculus} is a formal theory as follows. It
consists of types, terms and equations (between terms of the same type).

\medskip
\noindent
(a) {\bf Types}:
\begin{enumerate}[label=(a\theenumi)]
\item $\one$ is a type.
\item If $A$ and $B$ are types so are $A \times B$ and $\fexpBA$
\end{enumerate}

\medskip
\noindent
(b) {\bf Terms}: (We write ``$t \in A''$ to say that $t$ is a term of type $A$.)
\begin{enumerate}[label=(b\theenumi)]
\item There are countably many variables of each type, say $x^{A}_{i} \in A$ if $i \in \nat$.
\item $\star \in \one$.
\item If $a \in A$, $b \in B$ and $c \in A \times B$, then $\la a,b \ra \in A \times B$, $\prAB(c) \in A$ and $\prpAB(c) \in B$.
\item If $f \in \fexpBA$ and $a \in A$ then $\evBA(f,a) \in B$.
\item If $x$ is a variable of type $A$ and $\phi(x) \in B$ then $\lxa{\varphi(x)} \in \fexpBA$.
\end{enumerate}
\noindent
We often abbreviate $\evBA(f,a)$ as $f \app a$ when the type subscripts are clear
from the context.%
\footnote{Editor's note: Lambek uses this squiggle $\app$ to denote a binary operation for
function application. It appears here and in his later book about this same subject. I
made a best guess about how to translate this into \LaTeX.}


\def\lxa{\l_{x\in A}}

\medskip
\noindent
(c) {\bf Equations}: All equations have the form $a \eqx a'$, where $a$ and $a'$ have
the same type and $X$ is a set of variables containing all variables occurring
freely in $a$ and $a'$.
\begin{enumerate}[label=(c\theenumi)]
\item $\eqx$ is reflexive, symmetric and transitive. Moreover, if $X \inc Y$ we have
\[
\inferrule{a \eqx b}{a \eqy b}
\]
(that is, from $a \eqx b$ we may infer $a \eqy b$).
\item We have the substitution rules:
\[
\inferrule{c \eqx c'}{\pf(c) \eqx \pf(c)}, \quad 
\inferrule{a \eqx a', \quad b \eqx b'}{\psi(a,b), \eqx \psi(a',b')}
\]
if $\pf(z) \equiv \pi(z)$ or $\pi'(z)$ and $\psi(x,y) = \la x,y \ra$ or $x \app y$ and also
\[
\inferrule{\pf(x) \eqxx \psi(x)}{\lxa\pf(x) \eqx \lxa\psi(x)}
\]
if $x \notin X$.
\item The following identities hold:
\begin{fleqn}
\[a \eqx \star, \hbox{ for all } a \in \one,\]

\[\pi(\la a,b \ra) \eqx a, \textrm{ for all } a \in A, b \in B,\]
\[\pi'(\la a,b \ra) \eqx b, \textrm{ for all } a \in A, b \in B,\]
\[\la \pi(c), \pi'(c) \ra \eqx c, \textrm{ for all } c \in A \times B \]
\[\lxa \pf(x)\app a \eqx \pf(a), \textrm{ for all } a \in A \hbox{ substitutable for } x,\]
\[\lxa (f \app x) \eqx f, \textrm{ for all } f \in \fexpBA \hbox{, provided } x \notin X,\]
\[\lxa \pf(x)\eqx \l_y \varphi(y)\footnotemark\]
\end{fleqn}
\end{enumerate}
\end{defn}
There may be types, terms and equations other than those following from
(a), (b) and (c) above.
\footnotetext{In their 1986 book on this subject Lambek and Scott write this equation like this: ``$\lxa \pf(x)\eqx \l_{x' \in A} \varphi(x')$ if $x'$ is substitutable for $x$ in $\pf(x)$ and x' is not free in $\pf(x)$''. And I think that's what Lambek means here too.}%
Some comments are in order. The intuitive meaning of the term forming
operations should be clear; for example, $\evBA$ means evaluation,
$\la a,b\ra$ is pairing, and $\lxa \pf(x)$ denotes the function $x \longmapsto \pf(x)$.
$\l$ acts like a quantifier, so the variable $x$ in $\lxa \pf(x)$ is {\em bound}, 
as in $\forall_x \pf(x)$ or $\int_a^b f(x) dx$.
We have the usual conventions for free and bound variables and when
a it is permitted to substitute a term for a variable.

The reader may wonder why we write the subscript $X$ on $\eqx$. The reason
is that there may be "empty" types, that is, there may not exist any closed
terms of certain types. This situation arises naturally when a $\l$-calculus
is the internal language of certain categories (see Section 2).

\begin{prop}
If $\pf(x) \eqx \psi(x)$ with $x$ of type $A$ and if $a$ is a
term of type $A$ such that $X$ contain sall free variables occurring 
in $a$ (but not $x$), then $\pf(a) \eqx \psi(x)$. In particular if $f$
and $g$ do not contain $x$, $f \eqxx g$ provided there is at least one term of type
$A$ with free variables in $X$.
\end{prop}
It follows from this result that, if there are closed terms of each type
in a typed $\l$-calculus, then the subscript $X$ on $\eqx$ is redundant.

The reader may feel a bit uneasy about the lack of examples so far. Let
us rectify this at once. We recall that a graph consists of two classes, and
two mappings between them:

\tikzcdset{arrow style=tikz, diagrams={>=latex}}
\begin{center}
\begin{tikzcd}[column sep=large]
\text{ arrows  } \arrow[thick, r, yshift=1ex,"\text{ source }"] \arrow[thick, r, yshift=-1ex,"","\text{ target }"',""]
& \text{  objects}
\end{tikzcd}
\end{center}

Graph theorists would call the arrows ``oriented edges'' and the objects
``vertices'' or ``nodes''. We write $f: A \to B$ for ``$\mathop\text{source}(f) = A$'' and
``$\mathop{\text{target(f)}} = B$''.

\begin{example}
Given a graph $\cal G$ the $\l$-calculus $\L(\cal G)$ {\em generated} by $\cal G$
is defined as follows. Its types are generated inductively by the type forming
operations $(-)\times(-)$ and $\fexp{(-)}{(-)}$ from the basic type $\one$
and the vertices of $\cal G$ (which now count as basic types).
Its terms are generated inductively
from the basic terms $x_i^A$ and $\star$ by the term forming operations
$\la -,-\ra$, $\pi(-)$, $\pi'(-)$, $\ev(-,-)$, and $\lxa(-)$,
together with the new term forming operations:
\[
\inferrule{a \in A}{f a \in B}
\]
for each arrow $f: A \to B$ of $\cal G$. Finally, its equations are precisely those
which follow from (c1) to (c3) and no others.

In this example there are plenty of ``empty'' types; for instance, all the
nodes of $\cal G$.
\end{example}
In the above example, as well as in the next section, we allow our
languages to be proper classes in the sense of G\"odel-Bernays. If necessary,
we work in a set theory with universes, in which ``classes'' are replaced by
``sets in a sufficiently large universe''.


\section{The equivalence between $\cart$ and $\lamC$}

In this section we shall establish an equivalence between cartesian closed
categories and typed $\l$-calculi. In order to state this properly, we define
two categories:

$\cart$ is the category whose objects are cartesian closed categories and
whose arrows are those functors that preserve the structure on the nose.

$\lamC$ is the category whose objects are $\l$-calculi and whose arrows are
{translations}. A {\em translation} $\trans: \LC \to \LC'$ does the following:

\begin{enumerate}
\renewcommand\labelenumi{(\theenumi)}
\item $\trans$ sends types of $\LC$ to types of $\LC'$.
\item $\trans$ sends terms of $\LC$, say of type $A$, to terms of $\LC'$ of type
$\trans(A)$, in particular, variables to variables.
\item $\trans$ preserves everything on the nose, for example: $\trans(\one) = \one$, $\trans(A \times B) = \trans(A) \times \trans(B)$, $\trans(\star) = \star$, $\trans(\la a,b \ra) = \la \trans(a), \trans(b) \ra$, and so on.
\item $\trans$ preserves equality: if $a \eqx b$ then $\trans(a) \eqtx \trans(b)$

\end{enumerate}

Our next aim is to obtain a pair of functors

\begin{center}
\begin{tikzcd}[column sep=large,arrow style=tikz, diagrams={>=latex}]
{\cart\text{  }} \arrow[thick, r, yshift=1ex,"L"]  
& \lamC
 \arrow[thick, l, yshift=-1ex,"","C",""]
\end{tikzcd}
\end{center}

In particular, we wish to show that each cartesian closed category $\C$ has an
``internal language'' $L(\C)$ which is a $\l$-calculus. But to describe this
language, we first need to understand ``variables''.

One can adjoin ``variables'' or ``indeterminates'' to cartesian closed
categories much as one does to any universal algebra. Given a cartesian closed
category $\C$ with objects $D$ and $A$, we adjoin an indeterminate arrow
$x: D \to A$ to form the polynomial category $\C[x]$ as follows:

Objects of $\C[x]$ are the same as objects of $\C$. Arrows of $\C[x]$ are
generated from those in $\C$ and the new basic arrow $x: D \to A$ using the arrow
forming operations: composition, $\la -,- \ra$, $(-)^*$. Equality $\eqdX$ in $\C[x]$ 
is the smallest congruence relation on hom-sets of $\C[x]$ which respects equality $\doteq$
$\C$ and assures that $\C[x]$ is a cartesian closed category.

The category $\C[x]$ satisfies the appropriate universal property in $\cart$.
For the committed categorist, $\C[x]$ may also be constructed directly as the
Kleisli category of a certain co-monad (co-triple) on $\C$. For our purposes, the
most interesting result concerns the normal forms of polynomials in $\C[x]$.

\begin{prop}
({\em functional completeness} of cartesian closed categories).
For every polynomial $\pf(x): B \to C$ in $\C[x]$ in an indeterminate arrow
$x: D \to A$ there is a unique arrow $f: \fexp{A}{D} \times B \to C$ in $\C$
such that
\[
f\la (x\pi'_{B,D})^*, \one_B\ra \eqdx \pf(x)
\]
\end{prop}

An interesting alternative interpretation of this result is to think of
$\C[x]$ as a deductive system with the indeterminat $x: D \to A$
considered as a {\em new assumption}. Then functional completeness is
simply a form of the deduction theorem in logic,
with something extra added at the end: to every proof
$\pf(x): B \to C$ under the assumption $x: D \to A$ there is a unique
proof $f: (D \impl A) \sland B \to C$  such that the proof
\[
% very annoying to get this tree right now that the formatting
% also works. easier to do it with placeholders first then fill in the
% actual things.
\inferrule
	{\inferrule*
    	{\inferrule*[leftskip=1.5em] 
    		{B \sland D \to D \\ D \sxto{x} A}
    		{B \sland D \to A}}
		{\inferrule {B \to (D \impl A) \\ B \to B} {B \to (D \impl A) \sland B}} \\ 
		(D \impl A) \sland B \sxto{f} C}
	{B \to C}
\]

equals $B \sxto{\pf(x)} C$.

\begin{cor}
If we adjoin an indeterminate arrow $x: \one \to A$ to a
cartesian closed category $\C$ and if $\pf(x) : \one \to B$ is a polynomial in $\C[x]$
there exists a unique arrow $f: A \to B$ in $\C$ such that $fx \eqdx\pf(x)$.
Equivalently, under the same hypothesis, there is a unique arrow $g: \one \to \fexpBA$ such
that $g\app x \eqdx \pf(x)$.
\end{cor}

We remark that one may also adjoin several indeterminates simultaneously
to a cartesian closed category, for example, one may adjoin $x :\one \to A$
and $y : \one \to B$ to obtain a cartesian closed category $\C[x,y]$.
It is not difficult to see that $\C[x,y]\iso \C[x][y]$
and also $\C[x,y]\iso \C[z]$ where $z: \one \to A \times B$.

We now introduce another example of a typed $\l$-calculus.

\begin{example}
The {\em internal language} $L(\C)$ of a cartesian closed
category $\C$ is defined as follows.
Its types are the objects of $\C$. Variables of type
$A$ are indeterminate arrows $\one \to A$ over $\C$
and terms of type $B$ with free
variables $x_1, \dots, x_n$ are polynomials $\one \to B$ in
$\C[x_1, \dots, x_n]$. It is not difficult to show that
$L(\C)$ is a typed $\l$-calculus. In particular, for any term $\pf(x)$
of type $B$, that is, an arrow $\pf(x): \one \to B$ in $\C[x]$,
$\lxa \pf(x) \in \fexpBA$ is the unique arrow $g: \one \to \fexpBA$ such that
$g \app x \eqdx \pf(x)$ according to Corollary 2.2.
\end{example}

The object function $L$ described in Example 2.3 may easily be extended
to a functor $L: \cart \to \lamC$. There is also a functor $C: \lamC \to \cart$ in
the opposite direction. Its action on objects will be described in the
following example of a cartesian closed category.

\begin{example}
The cartesian closed category $\C(\LC)$ generated by a
$\l$-calculus $\LC$ is defined as follows.
Its objects are types of $\LC$. The arrows $A \to B$ in $C(\LC)$ are
pairs $(x, \pf(x))$ where where x is a variable of type $A$ and $\pf(x)$ a term
of type $B$ with no free variables but $x$ (Think of this as the
function $x \mapsto \pf(X)$. We agree to identify $(x,\pf(x))$ with $(x', \psi(x'))$
if $\pf(x) \eqlx \psi(x)$ in $\LC$. The identity arrow $A \to A$ is of course $(x,x)$,
and composition of arrows is given by substitution of polynomials. It is easily
seen that $C(\LC)$ is a cartesian closed category. In particular, the rule
\[
\inferrule{C \times A \to B}{C \to \fexpBA}
\]
assigns to the upper arrow $(y,\psi(y))$ of type $C \times A$, and the lower arrow
$(z, \lxa \psi(z,x))$, $z$ of type $C$.
\end{example}

\begin{thm}
The functors $L$ and $C$ yield an equivalence of categories
between $\cart$ and $\lamC$, that is, $LC \iso id$ and $CL \iso id$.
\end{thm}

The proof of this theorem depends on the useful observation that
$C(\LC)[x] \iso C(\LC(x))$, where $\LC(x)$ is the $\l$-calculus
obtained from $\LC$ by adjoining a ``parameter'' $x$ of type $A$.
In other words, closed terms of
$\LC(x)$ are terms of $\LC$ with at most the free variable $x$.

The equivalence between $\cart$ and $\lamC$ may be put to good use. For
example, one easily constructs a functor $\L$ from the category
$\grph \equiv \Set^{\cdot\rightrightarrows}$
of graphs to $\lamC$, whose values on objects $\mathcal G$ of $\grph$
is given in Example 1.4, and $\L$ is left adjoint to the forgetful functor
$\lamC \to \grph$. Hence $C\L$ is left adjoint to the forgetful functor
$\cart \to \grph$ and $C\L(\mathcal G)$ is the {\em free} 
cartesian closed category generated by the graph $\mathcal G$.

Additional equational data may easily be added to a cartesian closed
category. For example, one may introduce finite co-products. More interesting
to us is a {\em weak natural numbers object}, namely a diagram 
$\one \xto{0} N \xto{S} N$ such that for every diagram
$\one \xto{a} A \xto{f} A$ there is an arrow $g \equiv J(a,f) : N \to A$ such that
the following diagram commutes:

%\tikzcdset{arrows={-Computer Modern Rightarrow}}
\begin{center}
\begin{tikzcd}
\one  \arrow[r, "0"] \arrow[thick,dash,d,xshift=-1pt]
 & N \arrow[r, "S"] \arrow[d, dotted, "g"] & N \arrow[d, dotted, "g"] \\
\one \arrow[thick, dash,u,xshift=1pt] \arrow[r, "a"] & A \arrow[r, "f"] & A
\end{tikzcd}
\end{center}

Cartesian closed categories with a weak natural numbers object were introduced
by M.F. Thibault (1977, 1982) under the name ``prerecursive categories''. If
one also insists on the uniqueness of $g$, one obtains a natural numbers object
in the sense of Lawvere; but it is not obvious that the uniqueness of $g$ can
be expressed equationally.

Linguistically, a weak natural numbers object amounts to introducing into
typed $\l$-calculus the following data: a type $N$, a term $0 \in N$ and two term
forming operations (successor and iterator):
\[
\inferrule{n \in N}{Sn \in N} \qquad 
\inferrule{a \in N\\ h \in \fexp{A}{A}\\ n\in N}{I(a, h, n) \in A}
\]
satisfying the ``recursion' equations:
\[
I(a,h,0) \eqx a, \quad I(a,h,Sn) = h \app I(a,h,n) .
\]

The equivalence in Theorem 2.5 extends to one between
$\cart_N$ and $\lamC_N$.
where the subscript $N$ refers to a weak natural numbers object.
Moreover, the above mentioned functor $\L$ also extends to a functor
$\grph \to \lamC_N$. Applying this to the empty graph $\emptyset$
we obtain an initial object $\L(\emptyset)$ in $\lamC_N$, the {\em pure}
typed $\l$-calculus with a weak natural numbers object.
Hence $C\L(\emptyset)$ is an initial object in $\cart_N$.

A question of interest to categorists is that of {\em coherence}: when do
certain diagrams commute? In particular, one wants to decide when two arrows
$A \rightrightarrows B$ in $C\L(\emptyset)$ are equal.
This is equivalent to the decision problem for
equality in $\L(\emptyset)$, which has a positive solution. This solution depends on a
Church-Rosser theorem, dear to combinatory logicians, and a normalizability
theorem following Tait (1967). In the presence of surjective pairing such a
theorem was first obtained by de Vrijer (1982) using methods of Troelstra
(1970). A coherence theorem for cartesian closed categories has also been
obtained by Szabo (1974, 1978).

As a final historical remark, let us point out that the pure $\l$-calculus
$\L(\emptyset)$ corresponds to G\"odel's primitive recursive functionals of finite type
(G\"odel, 1958; Tait, 1967; Troelstra, 1970). G\"odel used such a system to give
an elementary proof of the consistency of arithmetic, his so-called {\em Dialectica
interpretation}. In a sense, the present paper may be considered as a
categorical examination of principles implicit in G\"odel's Dialectica
interpretation (see also [S]).

\section{Untyped $\l$-calculus and C-monoids}

Suppose we have a cartesian closed category with only two non-isomorphic
objects $\one$ and $U$, that is to say, every object is isomorphic to $\one$ or $U$,
and that
\[
\fexp{U}{U} \iso U \iso U \times U
\]
so functions, individuals and pairs are all on the same level. This allows,
for example, functions to apply to themselves as arguments.

Such a category is then completely determined by the monoid $\MC \equiv \Hom(U,U)$.
The equations specifying the cartesian closed structure when specialized to
elements of $\MC$ reduce drastically: ignoring the terminal object, we simply
erase all subscripts on the equations of a cartesian closed category.

\begin{defn}
A {\em $C$-monoid} $\MC$ is a monoid with extra structure
$(\pi, \pi', \ev, (-)^*, \la -,- \ra)$ where $\pi$, $\pi'$, and $\ev$ are
elements of $\MC$ (i.e. nullary operations), $(-)^*$ a unary and $\la -,- \ra$ is
a binary operation satisfying the following identities:
\begin{enumerate}[label=C\theenumi.]
\item $\pi\la a,b\ra = a$
\item $\pi'\la a,b\ra = b$
\item $\la \pi c, \pi' c \ra = c$
\item $\ev \la h^*\pi, \pi' \ra = h$
\item $(\ev \la k\pi, \pi' \ra)^* = k$
\end{enumerate}
\end{defn}

$\C$-monoids are the objects of a category, whose arrows are monoid homo-
morphisms preserving the additional structure. We may apply the usual
techniques of universal algebra to the variety of $\C$-monoids. For example, the
{\em polynomial} $\C$-monoid $\MC[x]$ has as elements polynomials, that is, words in $x$
modulo the smallest congruence relation satisfying Cl to C5. Evidently,
$\MC[x]$ has the appropriate universal property.

$\C$-monoids, like cartesian closed categories, satisfy a version of
{\em functional completeness}.

\begin{thm}
If $\pf(x)$ is a polynomial in the indeterminate $x$ over a
$\C$-monoid $\MC$, there exists a unique constant $f\in \MC$ such that
\[
f\la (x\pi')^*, 1 \ra = \pf(x)
\]
in $\MC[x]$.
\end{thm}
We may carry over various definitions from cartesian closed categories
to $\C$-monoids. For example, we write
\[
g\app a \equiv \ev \la g(a \pi')^*,1\ra,
\]
\[
\lx \pf(x) \equiv f^*,
\]
where $f$ is the constant from Theorem 3.2.%
\footnote{In the paper this is mis-labeled as 4.2 because they didn't have \LaTeX}
It follows that
\[
\lx \pf(x) \app a = \pf(a).
\]
An amusing feature of the possibility of self-application is the
following fixed point theorem for $\C$-monoids, which is also behind Russell's
paradox.

\begin{prop}
For every polynomial $\pf(x)$ in $\MC[x]$ there exists an
element $a \in \MC$ such that $\pf(a) = a$.
\end{prop}

\begin{proof}
Put $b = \lx \pf(x \app x)$ and let $a \equiv b \app b$.
\end{proof}

To make the connection between $\C$-monoids and cartesian closed categories
precise, we recall the following.

\begin{defn}
The {\em Karoubi envelope} (or {\em idempotent splitting envelope})
$K(\mathcal A)$ of a category $\mathcal A$ is a category whose objects
are the idempotent arrows of $\mathcal A$ and whose arrows $f \to g$, where
$f^2 = f: A \to A$ and $g^2 = g: B \to B$, are triplets
$(f, \pf, g)$ such that $g\pf f = \pf$.
\end{defn}

The following is due to Dana Scott (1980).

\begin{thm}
Let $\MC$ be a C-monoid.
\begin{enumerate}[label=(\roman*)]
\item $K(\MC)$ is a cartesian closed category  with terminal object
$T \equiv (\pi')^*$.
\item If $\mathcal A$ is any cartesian closed category with an object $U$
such that $\fexp{U}{U} \iso U \iso U \times U$, then $\text{End}_{\mathcal A}(U)$
is a $\C$-monoid. In particular if ${\mathcal A} = K(\MC)$
and $U$ is the object of $\MC$
regarded as a one-object category, then $\text{End}_{\mathcal A} \iso \MC$.
\end{enumerate}
\end{thm}

We remark that, if $K_0(\MC)$ is the full subcategory of $K(\MC)$ consisting
of all objects isomorphic to $T$ or $U$, then $K_0(\MC)$ is a cartesian closed
category with (at most) two non-isomorphic objects.

Examples of $\C$-monoids or, equivalently, of cartesian closed categories
with an object $U$ such that $\fexp{U}{U} \iso U \iso U \times U$
have been constructed by Dana Scott (1972), using the category of continuous
lattices, to mention only one such example.

$\C$-monoids are also closely related to an extended version of the usual
untyped $\l$-calculus.

\begin{defn}
An (untyped) $\l$-calculus is a formal language consisting
of terms and equations as follows. Among the terms there are countably many
variables. Moreover, if $a$, $b$ and $c$ are terms, then so are
$\pi(c)$, $\pi'(c)$, $(a,b)$, and $b \app a$.
Finally, if $\pf(x)$ is a term, possibly with a free occurrence
of the variable $x$, then $\lx\pf(x)$ is also a term (in which all occurrences of
$x$ are bound). Equality is an equivalence relation between terms which
satisfies the usual rules allowing substitution of equals for equals, including
the rule
\[
\inferrule{\pf(x) = \psi(x)}{\lx \pf(x) = \lx \psi(x)},
\]
which furthermore satisfies the substitution rule
\[
\inferrule{\pf(x) = \psi(x)}{ \pf(a) = \psi(a)},
\]
where it is assumed that a is substitutable for x, and which finally
satisfies the following equations:
\begin{enumerate}[label=L\theenumi.]
\item $\lx \pf(x)\app x = \pf(x)$.
\item $\lx (f \app x) = f$, if $x$ is not free in $f$.
\item $\pi((a,b)) = a$.
\item $\pi'((a,b)) = b$.
\item $(\pi(c), \pi' (c)) = c$.
\end{enumerate}
\end{defn}

The usual untyped $\l$-calculus omits the term forming operations $\pi(-)$,
$\pi'(-)$, and $(-,-)$, together with the equations L3, L4 and L5. Unfortunately,
the presence of L5 (``surjective pairing'') adds an unexpected complication:
the Church-Rosser theorem then fails (Barendregt, 1981, Exercise 15.4.4).

The (untyped) $\l$-calculi are the objects of a category whose arrows are
translations. A {\em translation} is a mapping from terms to terms which sends
variables to variables and preserves the term forming operations.

\begin{thm}
The category of $\C$-monoids is isomorphic to the category of
(untyped) $\l$-calculi.
\end{thm}

\begin{proof}
(Sketch). Starting with a $\C$-monoid $\MC$, we form the $\l$-calculus
$L(\MC)$ whose terms in the variables $x_1, ... , x_n$ are elements of $\MC[x_1,...,x_n]$
with term forming operations defined as follows:
\begin{align*}
\pi(c) & \equiv \pi \app c,\\
\pi' (c) & \equiv \pi' \app c,\\
(a,b) & \equiv \la \lx a, \lx b\ra \app 1,\\
f \app a & \equiv \ev \la f(a \pi')^*,1 \ra,\\
\lx \pf(x) &\equiv f^* \,\, \text{by functional completeness.%
\footnotemark}
\end{align*}
\footnotetext{This is a guess based on the discussion after Theorem 3.2}

Conversely, starting with a $\l$-calculus $\LC$, we form the $\C$-monoid $M(\LC)$
whose elements are the closed terms of $\LC$ with operations defined as follows:
\begin{align*}
1 &\equiv \lx x,\\
gf &\equiv \lx (g\app (f\app x)),\\
\pi & \equiv \lx \pi(x),\\
\pi' & \equiv \lx \pi'(x),\\
\la f,g \ra &\equiv \lx (f\app x, g \app x),\\
\ev & \equiv \l_z (\pi(z) \app \pi'(z)),\\
h^* & \equiv \lx\ly(h \app (x,y)).
\end{align*}
It is easily checked that
\[
ML(\MC) = \MC, \,\, LM(\LC) = \LC.
\]
It can also be shown that $M$ and $L$ extend to functors inverse to one
another.
\end{proof}

\section{Toposes and intuitionistic type theory}


