\section{Universality and descent for pushouts}\label{chap:descent}

We begin this section with the idea that pushouts can be presented as higher inductive types. The general idea behind higher inductive types is that we can introduce new inductive types not only with constructors at the level of points, but also with constructors at the level of identifications. Pushouts form a basic class of examples that can be obtained as higher inductive types, because they come equipped with the structure of a cocone. The cocone $(i,j,H)$ in the commuting square
\begin{equation*}
  \begin{tikzcd}
    S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
    A \arrow[r,swap,"i"] & C
  \end{tikzcd}
\end{equation*}
equips the type $C$ with two \emph{point constructors}
\begin{align*}
  i & : A \to C \\
  j & : B \to C \\
  \intertext{and a \emph{path constructor}}
  H & : \prd{s:S}i(f(s)) = j(g(s))
\end{align*}
that provides an identification $H(s):i(f(s))=j(g(s))$ for every $s:S$. The induction principle then specifies how to construct sections of families over $C$. Naturally, it takes not only the point constructors $i$ and $j$, but also the path constructor $H$ into account. 

The induction principle is one of several equivalent characterizations of pushouts. We will prove a theorem providing five equivalent characterizations of homotopy pushouts. Two of those we have already seen in \cref{thm:pushout_up}: the universal property and the pullback property. The other three are
\begin{enumerate}
\item the \emph{dependent pullback property},
\item the \emph{dependent universal property},
\item the \emph{induction principle}.
\end{enumerate}

An implication that is particularly useful among our five characterizations of pushouts, is the fact that the pullback property implies the dependent pullback property. We use the dependent pullback property to derive the \emph{universality of pushouts} (not to be confused with the universal property of pushouts), showing that for any commuting cube
\begin{equation*}
  \begin{tikzcd}
    & S' \arrow[dl] \arrow[d] \arrow[dr] \\
    A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[d] \arrow[dl,crossing over] \\
    A \arrow[dr] & D' \arrow[from=ul,crossing over] \arrow[d] & B \arrow[dl] \\
    & D
  \end{tikzcd}
\end{equation*}
in which the back left and right squares are pullback squares, if the front left and right squares are also pullback squares, then so is the induced square
\begin{equation*}
  \begin{tikzcd}
    A'\sqcup^{\mathcal{S}'}B' \arrow[r,densely dotted] \arrow[d,densely dotted] & D' \arrow[d] \\
    A\sqcup^S B \arrow[r,densely dotted] & D
  \end{tikzcd}
\end{equation*}

We then observe that the univalence axiom can be used together with the universal property of pushouts to obtain such families over pushouts in the first place. We prove the descent theorem, which asserts that for any diagram of the form
\begin{equation*}
  \begin{tikzcd}
    & S' \arrow[dl] \arrow[d] \arrow[dr] \\
    A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[d] \\
    A \arrow[dr] & & B \arrow[dl] \\
    & C
  \end{tikzcd}
\end{equation*}
in which the bottom square is a pushout square and the back left and right squares are pullback squares, there is a unique way of extending this to a commuting cube
\begin{equation*}
  \begin{tikzcd}
    & S' \arrow[dl] \arrow[d] \arrow[dr] \\
    A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[d] \\
    A \arrow[dr] & C' \arrow[from=ul,crossing over,densely dotted] \arrow[from=ur,crossing over,densely dotted] \arrow[d,densely dotted] & B \arrow[dl] \\
    & C
  \end{tikzcd}
\end{equation*}
in which also the front left and right squares are pullback squares. Thus the converse of the universality theorem for pushouts also follows. The descent property used to show that pullbacks distribute over pushouts, and to compute the fibers of maps out of pushouts (the source of many exercises).

We note that the computation rules in our treatment for the induction principle of homotopy pushouts are weak. In other words, they are identifications. In this course we have no need for judgmental computation rules. Our focus is instead on universal properties. We refer the reader who is interested in the more `traditional' higher inductive types with judgmental computation rules to \cite{hottbook}.

\subsection{Five equivalent characterizations of homotopy pushouts}

Consider a commuting square
\begin{equation}\label{eq:descent-pushout-square}
  \begin{tikzcd}
    S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
    A \arrow[r,swap,"i"] & H
  \end{tikzcd}
\end{equation}
with $H:i\circ f \htpy j \circ g$, where we will sometimes write $\mathcal{S}$ for the span $A\leftarrow S\rightarrow B$. Our first goal is to formulate the induction
principle for pushouts, which specifies how to construct a section of an arbitrary type family $P$ over $X$. Like the induction principle for the circle, the induction principle of pushouts has to take both the point constructors and the path constructors of $X$ into account. In our case, the point constructors are the maps
\begin{align*}
  i & : A \to X \\
  j & : B \to X,
  \intertext{and the path constructor is the homotopy}
  H & : \prd{s:S}i(f(s))=j(g(s)).
\end{align*}
Therefore, we obtain for any section $h:\prd{x:X}P(x)$ a triple $(h_A,h_B,h_S)$ consisting of
\begin{align*}
  h_A & : \prd{a:A}P(i(a)) \\
  h_B & : \prd{b:B}P(j(b)) \\
  h_S & : \prd{s:S} \mathsf{tr}_P(H(s),h(i(f(s))))=h(j(g(s))).
\end{align*}
The dependent functions $h_A$ and $h_B$ are simply given by
\begin{align*}
  h_A & \defeq h\circ i \\
  h_B & \defeq h\circ j.
\end{align*}
The homotopy $h_S$ is defined by $h_S(s)\defeq\apd{h}{H(s)}$, using the dependent action on paths of $h$. We call such triples $(h_A,h_B,h_S)$ \define{dependent cocones} on $P$ over the cocone $(i,j,H)$, and will write $\mathsf{dep\usc{}cocone}_{(i,j,H)}(P)$ for this type of dependent cocones. Thus, we have a function
\begin{equation*}
  \mathsf{ev\usc{}pushout}(P):\Big(\prd{x:X}P(x)\Big)\to \mathsf{dep\usc{}cocone}_{(i,j,H)}(P).
\end{equation*}
We are now in position to define the induction principle and the dependent universal property of pushouts.

\begin{defn}
  We say that $X$ satisfies the \define{induction principle of the pushout of $\mathcal{S}$} if the function
  \begin{equation*}
  \mathsf{ev\usc{}pushout}(P):\Big(\prd{x:X}P(x)\Big)\to \mathsf{dep\usc{}cocone}_{(i,j,H)}(P).
  \end{equation*}
  has a section for every type family $P$ over $X$.
\end{defn}

\begin{defn}
  We say that $X$ satisfies the \define{dependent universal property of the pushout of $\mathcal{S}$} if the function
  \begin{equation*}
  \mathsf{ev\usc{}pushout}(P):\Big(\prd{x:X}P(x)\Big)\to \mathsf{dep\usc{}cocone}_{(i,j,H)}(P).
  \end{equation*}
  is an equivalence for every type family $P$ over $X$.
\end{defn}

\begin{rmk}\label{rmk:comp-pushout}
  For $(h_A,h_B,h_S)$ and $(h'_A,h'_B,h'_S)$ in $\mathsf{dep\usc{}cocone}_{(i,j,H)}(P)$, the type of identifications $(h_A,h_B,h_S)=(h'_A,h'_B,h'_S)$ is equivalent to the type of triples $(K_A,K_B,K_S)$ consisting of
  \begin{align*}
    K_A & : \prd{a:A}h_A(a)=h'_A(a) \\
    K_B & : \prd{b:B}h_B(b)=h'_B(b),
  \end{align*}
  and a homotopy $K_S$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=8em]
      \mathsf{tr}_P(H(s),h_A(f(s))) \arrow[r,equals,"\ap{\mathsf{tr}_P(H(s))}{K_A(f(s))}"] \arrow[d,equals,swap,"h_S(s)"] & \mathsf{tr}_P(H(s),{h'_A(f(s))}) \arrow[d,equals,"h'_S(s)"] \\
      h_B(g(s)) \arrow[r,equals,swap,"K_B(g(s))"] & h_B(g(s))
    \end{tikzcd}
  \end{equation*}
  commutes for every $s:S$.

  Therefore we see that the induction principle of the pushout of $\mathcal{S}$ provides us, for every dependent cocone $(h_A,h_B,h_S)$ of $P$ over $(i,j,H)$, with a dependent function $h:\prd{x:A}P(x)$ equipped with homotopies
  \begin{align*}
    K_A & : \prd{a:A}h(i(a))=h_A(a) \\
    K_B & : \prd{b:B}h(j(b))=h_B(b),
  \end{align*}
  and a homotopy $K_S$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=8em]
      \mathsf{tr}_P(H(s),h(i(f(s)))) \arrow[r,equals,"\ap{\mathsf{tr}_P(H(s))}{K_A(f(s))}"] \arrow[d,equals,swap,"\apd{h}{H(s)}"] & \mathsf{tr}_P(H(s),{h_A(f(s))}) \arrow[d,equals,"h_S(s)"] \\
      h(j(g(s))) \arrow[r,equals,swap,"K_B(g(s))"] & h_B(g(s))
    \end{tikzcd}
  \end{equation*}
  commutes for every $s:S$. These homotopies are the \define{computation rules} for pushouts\index{computation rules!for pushouts}. The dependent universal property is equivalent to the assertion that for every dependent cocone $(h_A,h_B,h_S)$, the type of quadruples $(h,K_A,K_B,K_S)$ is contractible.
\end{rmk}

\begin{thm}\label{thm:dependent-pullback-property-pushout}
  Consider a commuting square
  \begin{equation}\label{eq:dppp1}
    \begin{tikzcd}
      S \arrow[d,swap,"f"] \arrow[r,"g"] & B \arrow[d,"j"] \\
      A \arrow[r,swap,"i"] & C
    \end{tikzcd}
  \end{equation}
  with $H:(i\circ f) \htpy (j \circ g)$. Then the following are equivalent:
  \begin{enumerate}
  \item The square in \cref{eq:dppp1} is a pushout square.
  \item The square in \cref{eq:dppp1} satisfies the pullback property of pushouts.
  \item The square satisfies the \define{dependent pullback property} of pushouts: For every family $P$ over $C$, the square
    \begin{equation}\label{eq:dppp2}
      \begin{tikzcd}[column sep=large]
        \prd{z:C}P(z) \arrow[rr,"h\mapsto h\circ j"] \arrow[d,swap,"h\mapsto h\circ i"] & &[1em] \prd{y:B}P(j(y)) \arrow[d,"h\mapsto h\circ g"] \\
        \prd{x:A}P(i(x)) \arrow[r,swap,"{h\mapsto h \circ f}"] & \prd{s:S}P(i(f(s))) \arrow[r,swap,"{\lam{h}{s}\mathsf{tr}_P(H(s),h(s))}" yshift=-2ex] & \prd{s:S}P(j(g(s))),
      \end{tikzcd}
    \end{equation}
    which commutes by the homotopy
    \begin{equation*}
      \lam{h}\mathsf{eq\usc{}htpy}(\lam{s}\apd{h}{H(s)}),
    \end{equation*}
    is a pullback square.
  \item The type $C$ satisfies the \define{dependent universal property} of pushouts.
  \item The type $C$ satisfies the \define{induction principle} of pushouts.
  \end{enumerate}
\end{thm}

\begin{proof}
  We have already seen in \cref{thm:pushout_up} that (i) and (ii) are equivalent.

  To see that (ii) implies (iii), note that we have a commuting cube
  \begin{equation*}
    \begin{tikzcd}[column sep=tiny]
      &  \sm{h:C\to C}\prd{c:C}P(h(c)) \arrow[dl] \arrow[d] \arrow[dr] \\
      \sm{h:A\to C}\prd{a:A}P(h(a)) \arrow[d] & \big(\sm{c:C}P(c)\big)^C \arrow[dl] \arrow[dr] & \sm{h:B\to C}\prd{b:B}P(h(b)) \arrow[d] \arrow[dl,crossing over] \\
      \big(\sm{c:C}P(c)\big)^A \arrow[dr] & \sm{h:S\to C}\prd{s:S}P(h(s)) \arrow[d] \arrow[from=ul,crossing over] & \big(\sm{c:C}P(c)\big)^B \arrow[dl] \\
      & \big(\sm{c:C}P(c)\big)^S
    \end{tikzcd}
  \end{equation*}
  in which the vertical maps are equivalences. Moreover, the bottom square is a pullback square by the pullback property of pushouts, so we conclude that the top square is a pullback square. Since this is a square of total spaces over a pullback square, we invoke \cref{lem:fiberwise-pullback} to conclude that for each $h:C \to C$, the square
  \begin{equation*}
    \begin{tikzcd}
      \prd{c:C}P(h(c)) \arrow[rr] \arrow[d] & &[2em] \prd{b:B} P(h(j(b))) \arrow[d] \\
      \prd{a:A}P(h(i(a))) \arrow[r] & \prd{s:S}P(h(i(f(s)))) \arrow[r,swap,"\mathsf{tr}_{((k:S\to C)\mapsto \prd{s:S}P(k(s)))}(\mathsf{eq\usc{}htpy}(h\cdot H))" yshift=-2ex] & \prd{s:S}P(h(j(g(s))))
    \end{tikzcd}
  \end{equation*}
  is a pullback square. Note that the transport with respect to the family $k\mapsto \prd{s:S}(Pk(s))$ along the identification $\mathsf{eq\usc{}htpy}(h\cdot H)$ is homotopic to the map
  \begin{equation*}
    \lam{h}{s}\mathsf{tr}_{P\circ h}(H(s),h(s)):\prd{s:S}P(h(i(f(s)))) \to \prd{s:S}P(h(j(g(s)))).
  \end{equation*}
  Therefore we conclude that the square
  \begin{equation*}
    \begin{tikzcd}
      \prd{c:C}P(h(c)) \arrow[rr] \arrow[d] & &[2em] \prd{b:B} P(h(j(b))) \arrow[d] \\
      \prd{a:A}P(h(i(a))) \arrow[r] & \prd{s:S}P(h(i(f(s)))) \arrow[r,swap,"{\lam{h}{s}\mathsf{tr}_{P\circ h}(H(s),h(s))}" yshift=-2ex] & \prd{s:S}P(h(j(g(s))))
    \end{tikzcd}
  \end{equation*}
  is a pullback square for each $h:C\to C$. Using the case $h\jdeq\idfunc : C \to C$ we conclude that the cocone $(i,j,H)$ satisfies the dependent pullback property.

  To see that (iii) implies (ii) we recall that transport with respect to a trivial family is homotopic to the identity function. Thus we obtain the pullback property from the dependent pullback property using the trivial family $\lam{c}T$ over $C$.

  To see that (iii) implies (iv) we note that $\mathsf{ev\usc{}pushout}(P)$ is an equivalence if and only if the gap map of the square in \cref{eq:dppp2} is an equivalence.

  It is clear that (iv) implies (v), so it remains to show that (v) implies (iv). If $X$ satisfies the induction principle of pushouts, then the map
  \begin{equation*}
    \mathsf{ev\usc{}pushout}:\Big(\prd{x:X}P(x)\Big)\to\mathsf{dep\usc{}cocone}_{(i,j,H)}(P)
  \end{equation*}
  has a section, i.e., it comes equipped with
  \begin{align*}
    \mathsf{ind\usc{}pushout} & :\mathsf{dep\usc{}cocone}_{(i,j,H)}(P)\to\Big(\prd{x:X}P(x)\Big) \\
    \mathsf{comp\usc{}pushout} & : \mathsf{ev\usc{}pushout}\circ\mathsf{ind\usc{}pushout} \htpy\idfunc.
  \end{align*}
  To see that $\mathsf{ev\usc{}pushout}$ is an equivalence it therefore suffices to construct a homotopy
  \begin{equation*}
    \mathsf{ind\usc{}pushout}(\mathsf{ev\usc{}pushout}(h))\htpy h
  \end{equation*}
  for any $h:\prd{x:X}P(x)$. From the fact that $\mathsf{ind\usc{}pushout}$ is a section of $\mathsf{ev\usc{}pushout}$ we obtain an identification
  \begin{equation*}
    \mathsf{ev\usc{}pushout}(\mathsf{ind\usc{}pushout}(\mathsf{ev\usc{}pushout}(h)))= \mathsf{ev\usc{}pushout}(h).
  \end{equation*}
  Therefore we observe that it suffices to construct a homotopy $h\htpy h'$ for any two functions $h,h':\prd{x:X}P(x)$ that come equipped with an identification
  \begin{equation*}
    \mathsf{ev\usc{}pushout}(h)=\mathsf{ev\usc{}pushout}(h').
  \end{equation*}
  Now we recall from \cref{rmk:comp-pushout} that this type of identifications is equivalent to the type of triples $(K_A,K_B,K_S)$ consisting of
  \begin{align*}
    K_A & : \prd{a:A}h(i(a))=h'(i(a)) \\
    K_B & : \prd{b:B}h(j(b))=h'(j(b))
  \end{align*}
  and a homotopy $K_S$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=8em]
      \mathsf{tr}_P(H(s),h(i(f(s)))) \arrow[r,equals,"\ap{\mathsf{tr}_P(H(s))}{K_A(f(s))}"] \arrow[d,equals,swap,"\apd{h}{H(s)}"] & \mathsf{tr}_P(H(s),{h'(i(f(s)))}) \arrow[d,equals,"\apd{h'}{H(s)}"] \\
      h(j(g(s))) \arrow[r,equals,swap,"K_B(g(s))"] & h'(j(g(s)))
    \end{tikzcd}
  \end{equation*}
  commutes for every $s:S$. Note that from such an identification $K_S(s)$ we also obtain an identification
  \begin{equation*}
    \mathsf{K'_S(s)} : \mathsf{tr}_{x\mapsto h(x)=h'(x)}(H(s),K_A(f(s)))=K_B(g(s)).
  \end{equation*}
  Indeed, by path inducgtion on $p:x=x'$ we obtain an identification $\mathsf{tr}_{x\mapsto h(x)=h'(x)}(p,q)=q'$, for any $p:x=x'$, any $q:h(x)=h'(x)$ and any $q':h(x')=h'(x')$ for which the square
  \begin{equation*}
    \begin{tikzcd}[column sep=huge]
      \mathsf{tr}_P(p,h(x)) \arrow[r,equals,"\ap{\mathsf{tr}_P(p)}{q}"] \arrow[d,equals,swap,"\apd{h}{p}"] & \mathsf{tr}_P(p,h'(x)) \arrow[d,equals,"\apd{h'}{p}"] \\
      h(x') \arrow[r,equals,swap,"{q'}"] & h'(x')
    \end{tikzcd}
  \end{equation*}
  Now we see that the triple $(K_A,K_B,K'_S)$ forms a dependent cocone on the family $x\mapsto h(x)=h'(x)$. Therefore we obtain a homotopy $h\htpy h'$ as an application of the induction principle for pushouts at the family $x\mapsto h(x)=h'(x)$.
\end{proof}

\subsection{Type families over pushouts}

Given a pushout square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X.
\end{tikzcd}
\end{equation*}
with $H:i\circ f\htpy j\circ g$, and a family $P:X\to\UU$, we obtain
\begin{align*}
P\circ i & : A \to \UU \\
P\circ j & : B \to \UU \\
\lam{x}\mathsf{tr}_P(H(x)) & : \prd{x:S} \eqv{P(i(f(x)))}{P(j(g(x)))}.
\end{align*}
Our goal in the current section is to show that the triple $(P_A,P_B,P_S)$ consisting of $P_A\defeq P\circ i$, $P_B\defeq P\circ j$, and $P_S\defeq \lam{x}\mathsf{tr}_P(H(x))$ characterizes the family $P$ over $X$.

\begin{defn}
Consider a commuting square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X.
\end{tikzcd}
\end{equation*}
with $H:i\circ f\htpy j\circ g$, where all types involved are in $\UU$. The type $\mathsf{Desc}(\mathcal{S})$\index{Desc@{$\mathsf{Desc}(\mathcal{S})$}} of \define{descent data}\index{descent data} for $X$, is defined defined to be the type of triples $(P_A,P_B,P_S)$ consisting of
\begin{align*}
P_A & : A \to \UU \\
P_B & : B \to \UU \\
P_S & : \prd{x:S} \eqv{P_A(f(x))}{P_B(g(x))}.
\end{align*}
\end{defn}

\begin{defn}
Given a commuting square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X.
\end{tikzcd}
\end{equation*}
with $H:i\circ f\htpy j\circ g$, we define the map\index{desc_fam@{$\mathsf{desc\usc{}fam}_{\mathcal{S}}$}}
\begin{equation*}
\mathsf{desc\usc{}fam}_{\mathcal{S}}(i,j,H) : (X\to \UU)\to \mathsf{Desc}(\mathcal{S})
\end{equation*}
by $P\mapsto (P\circ i,P\circ j,\lam{x}\mathsf{tr}_P(H(x)))$.
\end{defn}

\begin{thm}\label{thm:desc_fam}
Consider a pushout square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X.
\end{tikzcd}
\end{equation*}
with $H:i\circ f\htpy j\circ g$, where all types involved are in $\UU$, and suppose we have
\begin{align*}
P_A & : A \to \UU \\
P_B & : B \to \UU \\
P_S & : \prd{x:S} \eqv{P_A(f(x))}{P_B(g(x))}.
\end{align*}
Then the function\index{desc_fam@{$\mathsf{desc\usc{}fam}_{\mathcal{S}}$}!is an equivalence}
\begin{equation*}
\mathsf{desc\usc{}fam}_{\mathcal{S}}(i,j,H) : (X\to \UU)\to \mathsf{Desc}(\mathcal{S})
\end{equation*}
is an equivalence.
\end{thm}

\begin{proof}
By the 3-for-2 property of equivalences it suffices to construct an equivalence $\varphi:\mathsf{cocone}_{\mathcal{S}}(\UU)\to\mathsf{Desc}(\mathcal{S})$ such that the triangle
\begin{equation*}
\begin{tikzcd}[column sep=tiny]
& \UU^X \arrow[dl,swap,"{\mathsf{cocone\usc{}map}_{\mathcal{S}}(i,j,H)}"] \arrow[dr,"{\mathsf{desc\usc{}fam}_{\mathcal{S}}(i,j,H)}"] & \phantom{\mathsf{cocone}_{\mathcal{S}}(\UU)} \\
\mathsf{cocone}_{\mathcal{S}}(\UU) \arrow[rr,densely dotted,"\eqvsym","\varphi"'] & & \mathsf{Desc}(\mathcal{S})
\end{tikzcd}
\end{equation*}
commutes.

Since we have equivalences
\begin{equation*}
\mathsf{equiv\usc{}eq}:\eqv{\Big(P_A(f(x))=P_B(g(x))\Big)}{\Big(\eqv{P_A(f(x))}{P_B(g(x))}\Big)}
\end{equation*}
for all $x:S$, we obtain by \cref{ex:equiv_pi} an equivalence on the dependent products
\begin{equation*}
{\Big(\prd{x:S}P_A(f(x))=P_B(g(x))\Big)}\to{\Big(\prd{x:S}\eqv{P_A(f(x))}{P_B(g(x))}\Big)}.
\end{equation*}
We define $\varphi$ to be the induced map on total spaces. Explicitly, we have
\begin{equation*}
\varphi\defeq \lam{(P_A,P_B,K)}(P_A,P_B,\lam{x}\mathsf{equiv\usc{}eq}(K(x))).
\end{equation*}
Then $\varphi$ is an equivalence by \cref{thm:fib_equiv}, and the triangle commutes by \cref{ex:tr_ap}.
\end{proof}

\begin{cor}\label{cor:desc_fam}
Consider descent data $(P_A,P_B,P_S)$ for a pushout square as in \cref{thm:desc_fam}.
Then the type of quadruples $(P,e_A,e_B,e_S)$ consisting of a family $P:X\to\UU$ equipped with two families of equivalences
\begin{samepage}
\begin{align*}
e_A & : \prd{a:A}\eqv{P_A(a)}{P(i(a))} \\
e_B & : \prd{b:B}\eqv{P_B(a)}{P(j(b))}
\end{align*}
\end{samepage}%
and a homotopy $e_S$ witnessing that the square
\begin{equation*}
\begin{tikzcd}[column sep=huge]
P_A(f(x)) \arrow[r,"e_A(f(x))"] \arrow[d,swap,"P_S(x)"] & P(i(f(x))) \arrow[d,"\mathsf{tr}_P(H(x))"] \\
P_B(g(x)) \arrow[r,swap,"e_B(g(x))"] & P(j(g(x)))
\end{tikzcd}
\end{equation*}
commutes, is contractible.
\end{cor}

\begin{proof}
The fiber of this map at $(P_A,P_B,P_S)$ is equivalent to the type of quadruples $(P,e_A,e_B,e_S)$ as described in the theorem, which are contractible by \cref{thm:contr_equiv}.
\end{proof}

\subsection{The flattening lemma for pushouts}

In this section we consider a pushout square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X.
\end{tikzcd}
\end{equation*}
with $H:i\circ f\htpy j\circ g$, descent data
\begin{align*}
P_A & : A \to \UU \\
P_B & : B \to \UU \\
P_S & : \prd{x:S} \eqv{P_A(f(x))}{P_B(g(x))},
\end{align*}
and a family $P:X\to\UU$ equipped with 
\begin{align*}
e_A & : \prd{a:A}\eqv{P_A(a)}{P(i(a))} \\
e_B & : \prd{b:B}\eqv{P_B(a)}{P(j(b))}
\end{align*}
and a homotopy $e_S$ witnessing that the square
\begin{equation*}
\begin{tikzcd}[column sep=huge]
P_A(f(x)) \arrow[r,"e_A(f(x))"] \arrow[d,swap,"P_S(x)"] & P(i(f(x))) \arrow[d,"\mathsf{tr}_P(H(x))"] \\
P_B(g(x)) \arrow[r,swap,"e_B(g(x))"] & P(j(g(x)))
\end{tikzcd}
\end{equation*}
commutes.

\begin{defn}
We define a commuting square
\begin{equation*}
\begin{tikzcd}
\sm{x:S}P_A(f(x)) \arrow[d,swap,"{f'}"] \arrow[r,"{g'}"] & \sm{b:B}P_B(b) \arrow[d,"{j'}"] \\
\sm{a:A}P_A(a) \arrow[r,swap,"{i'}"] & \sm{x:X}P(x)
\end{tikzcd}
\end{equation*}
with a homotopy $H':i'\circ f'\htpy j'\circ g'$. We will write $\mathcal{S'}$ for the span
\begin{equation*}
\begin{tikzcd}
\sm{a:A}P_A(a) & \sm{x:S}P_A(f(x)) \arrow[l,swap,"{f'}"] \arrow[r,"{g'}"] & \sm{b:B}P_B(b).
\end{tikzcd}
\end{equation*}
\end{defn}

\begin{constr}
We define
\begin{align*}
f' & \defeq \tot[f]{\lam{x}\idfunc[P_A(f(x))]} \\
g' & \defeq \tot[g]{e_S} \\
i' & \defeq \tot[i]{e_A} \\
j' & \defeq \tot[j]{e_B}.
\end{align*}
Then it remains to construct a homotopy $H':i'\circ f'\htpy j'\circ g'$. In order to construct this homotopy, we have to construct an identification
\begin{equation*}
(i(f(x)),e_A(y))=(j(g(x)),e_B(e_S(y)))
\end{equation*}
for any $x:S$ and $y:P_A(f(x))$. Note that have the identification
\begin{equation*}
\mathsf{eq\usc{}pair}(H(x),e_S(x,y)^{-1})
\end{equation*}
of this type.
\end{constr}

\begin{lem}[The flattening lemma]\label{lem:flattening}
The commuting square\index{flattening lemma!for pushouts}
\begin{equation*}
\begin{tikzcd}
\sm{x:S}P_A(f(x)) \arrow[d,swap,"{f'}"] \arrow[r,"{g'}"] & \sm{b:B}P_B(b) \arrow[d,"{j'}"] \\
\sm{a:A}P_A(a) \arrow[r,swap,"{i'}"] & \sm{x:X}P(x)
\end{tikzcd}
\end{equation*}
is a pushout square.
\end{lem}

\begin{proof}
  To show that the square of total spaces satisfies the pullback property of pullbacks, note that we have a commuting cube
  \begin{equation*}
    \begin{tikzcd}
      & T^{\sm{x:X}P(x)} \arrow[dl] \arrow[d] \arrow[dr] \\
      T^{\sm{a:A}P_A(a)} \arrow[d] & \prd{x:X}T^{P(x)} \arrow[dl] \arrow[dr] & T^{\sm{b:B}P_B(b)} \arrow[dl,crossing over] \arrow[d] \\
      \prd{a:A}T^{P_A(a)} \arrow[dr] & T^{\sm{x:S}P_A(f(x))} \arrow[from=ul,crossing over] \arrow[d] & \prd{b:B}T^{P_B(b)} \arrow[dl] \\
      & \prd{x:S}T^{P_A(f(x))}
    \end{tikzcd}
  \end{equation*}
  for any type $T$. In this cube, the vertical maps are all equivalences, and the bottom square is a pullback square by the dependent pullback property of pushouts. Therefore it follows that the top square is a pullback square.
\end{proof}

\subsection{The universality theorem}
\begin{thm}\label{thm:descent}
  Consider two pushout squares
  \begin{equation*}
    \begin{tikzcd}
      S' \arrow[r] \arrow[d] & B' \arrow[d] & S \arrow[r] \arrow[d] & B \arrow[d] \\
      A' \arrow[r] & C' & A \arrow[r] & C
    \end{tikzcd}
  \end{equation*}
  and a commuting cube
  \begin{equation*}
    \begin{tikzcd}
      & S' \arrow[dl] \arrow[d] \arrow[dr] \\
      A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[d] \arrow[dl,crossing over] \\
      A \arrow[dr] & D' \arrow[from=ul,crossing over] \arrow[d] & B \arrow[dl] \\
      & D
    \end{tikzcd}
  \end{equation*}
  in which the back left and right squares are pullback squares. The following are equivalent:
  \begin{enumerate}
  \item The front left and right squares are pullback squares.
  \item The induced commuting square
    \begin{equation*}
      \begin{tikzcd}
        C' \arrow[r,densely dotted] \arrow[d,densely dotted] & D' \arrow[d] \\
        C \arrow[r,densely dotted] & D
      \end{tikzcd}
    \end{equation*}
    is a pullback square.
  \end{enumerate}
\end{thm}


\subsection{The descent property for pushouts}

In the previous section there was a significant role for families of equivalences, and we know by \cref{thm:pb_fibequiv,cor:pb_fibequiv}: families of equivalences indicate the presence of pullbacks. In this section we reformulate the results of the previous section using pullbacks where we used families of equivalences before, to obtain new and useful results. We begin by considering the type of descent data from the perspective of pullback squares.

\begin{defn}
Consider a span $\mathcal{S}$ from $A$ to $B$, and a span $\mathcal{S}'$ from $A'$ to $B'$. A \define{cartesian transformation} of spans\index{cartesian transformation!of spans} from $\mathcal{S}'$ to $\mathcal{S}$ is a diagram of the form
\begin{equation*}
\begin{tikzcd}
A' \arrow[d,swap,"h_A"]  & S' \arrow[l,swap,"{f'}"] \arrow[r,"{g'}"] \arrow[d,swap,"h_S"] & B' \arrow[d,"h_B"] \\
A & S \arrow[l,"f"] \arrow[r,swap,"g"] & B
\end{tikzcd}
\end{equation*}
with $F:f\circ h_S\htpy h_A\circ f'$ and $G:g\circ h_S\htpy h_B\circ g'$, where both squares are pullback squares. 

The type $\mathsf{cart}(\mathcal{S}',\mathcal{S})$\index{cart(S,S')@{$\mathsf{cart}(\mathcal{S},\mathcal{S}')$}} of cartesian transformation is the type of tuples
\begin{equation*}
(h_A,h_S,h_B,F,G,p_f,p_g)
\end{equation*}
where $p_f:\mathsf{is\usc{}pullback}(h_S,h_A,F)$ and $p_g:\mathsf{is\usc{}pullback}(h_S,h_B,G)$, and we write
\begin{equation*}
\mathsf{Cart}(\mathcal{S}) \defeq \sm{A',B':\UU}{\mathcal{S}':\mathsf{span}(A',B')}\mathsf{cart}(\mathcal{S}',\mathcal{S}).
\end{equation*}
\end{defn}

\begin{lem}\label{lem:cart_desc}
There is an equivalence\index{cart_desc@{$\mathsf{cart\usc{}desc}_{\mathcal{S}}$}}
\begin{equation*}
\mathsf{cart\usc{}desc}_{\mathcal{S}}:\mathsf{Desc}(\mathcal{S})\to \mathsf{Cart}(\mathcal{S}).
\end{equation*}
\end{lem}

\begin{proof}
Note that by \cref{thm:pb_fibequiv_complete} it follows that the types of triples $(f',F,p_f)$ and $(g',G,p_g)$ are equivalent to the types of families of equivalences
\begin{align*}
& \prd{x:S}\eqv{\fib{h_S}{x}}{\fib{h_A}{f(x)}} \\
& \prd{x:S}\eqv{\fib{h_S}{x}}{\fib{h_B}{g(x)}}
\end{align*} 
respectively. Furthermore, by \cref{thm:fam_proj} the types of pairs $(S',h_S)$, $(A',h_A)$, and $(B',h_B)$ are equivalent to the types $S\to \UU$, $A\to \UU$, and $B\to \UU$, respectively. Therefore it follows that the type $\mathsf{Cart}(\mathcal{S})$ is equivalent to the type of tuples $(Q,P_A,\varphi,P_B,P_S)$ consisting of
\begin{align*}
Q & : S\to \UU \\
P_A & : A \to \UU \\
P_B & : B \to \UU \\
\varphi & : \prd{x:S}\eqv{Q(x)}{P_A(f(x))} \\
P_S & : \prd{x:S}\eqv{Q(x)}{P_B(g(x))}.
\end{align*}
However, the type of $\varphi$ is equivalent to the type $P_A\circ f=Q$. Thus we see that the type of pairs $(Q,\varphi)$ is contractible, so our claim follows.
\end{proof}

\begin{defn}
We define an operation\index{cart map!{$\mathsf{cart\usc{}map}_{\mathcal{S}}$}}
\begin{equation*}
\mathsf{cart\usc{}map}_{\mathcal{S}}:{\Big(\sm{X':\UU}X'\to X\Big)}\to \mathsf{Cart}(\mathcal{S}).
\end{equation*}
\end{defn}

\begin{constr}
Let $X':\UU$ and $h_X:X'\to X$. Then we define the types
\begin{align*}
A' & \defeq A\times_X X' \\
B' & \defeq B\times_X X'.
\end{align*}
Next, we define a span $\mathcal{S'}\defeq(S',f',g')$ from $A'$ to $B'$. We take
\begin{align*}
S' & \defeq S\times_A A' \\
f' & \defeq \pi_2.
\end{align*}
To define $g'$, let $s:S$, let $(a,x',p):A\times_X X'$, and let $q:f(s)=a$. Our goal is to construct a term of type $B\times_X X'$. We have $g(s):B$ and $x':X'$, so it remains to show that $j(g(s))=h_X(x')$. We construct such an identification as a concatenation
\begin{equation*}
\begin{tikzcd}
j(g(s)) \arrow[r,equals,"H(s)^{-1}"] &[1ex] i(f(s)) \arrow[r,equals,"\ap{i}{q}"] &[1ex] i(a) \arrow[r,equals,"p"] & h_X(x').
\end{tikzcd}
\end{equation*}
To summarize, the map $g'$ is defined as
\begin{equation*}
g' \defeq \lam{(s,(a,x',p),q)}(g(s),x',\ct{H(s)^{-1}}{(\ct{\ap{i}{q}}{p})}).
\end{equation*}
Then we have commuting squares
\begin{equation*}
\begin{tikzcd}
A\times_X X' \arrow[d] & S\times_A A' \arrow[d] \arrow[l] \arrow[r] & B\times_X X' \arrow[d] \\
A & S \arrow[l] \arrow[r] & B.
\end{tikzcd}
\end{equation*}
Moreover, these squares are pullback squares by \cref{thm:pb_pasting}.
\end{constr}

The following theorem is analogous to \cref{thm:desc_fam}.

\begin{thm}[The descent theorem for pushouts]\label{thm:cart_map}\index{descent theorem!for pushouts}
The operation $\mathsf{cart\usc{}map}_{\mathcal{S}}$\index{cart map!{$\mathsf{cart\usc{}map}_{\mathcal{S}}$}!is an equivalence} is an equivalence
\begin{equation*}
\eqv{\Big(\sm{X':\UU}X'\to X\Big)}{\mathsf{Cart}(\mathcal{S})}
\end{equation*}
\end{thm}

\begin{proof}
It suffices to show that the square
\begin{equation*}
\begin{tikzcd}[column sep=huge]
X\to \UU \arrow[r,"{\mathsf{desc\usc{}fam}_{\mathcal{S}}(i,j,H)}"] \arrow[d,swap,"\mathsf{map\usc{}fam}_X"] & \mathsf{Desc}(\mathcal{S}) \arrow[d,"\mathsf{cart\usc{}desc}_{\mathcal{S}}"] \\
\sm{X':\UU}X'\to X \arrow[r,swap,"\mathsf{cart\usc{}map}_{\mathcal{S}}"] & \mathsf{Cart}(\mathcal{S})
\end{tikzcd}
\end{equation*}
commutes. To see that this suffices, note that the operation $\mathsf{map\usc{}fam}_X$ is an equivalence by \cref{thm:fam_proj}, the operation $\mathsf{desc\usc{}fam}_{\mathcal{S}}(i,j,H)$ is an equivalence by \cref{thm:desc_fam}, and the operation $\mathsf{cart\usc{}desc}_{\mathcal{S}}$ is an equivalence by \cref{lem:cart_desc}.

To see that the square commutes, note that the composite
\begin{equation*}
\mathsf{cart\usc{}map}_{\mathcal{S}}\circ \mathsf{map\usc{}fam}_X
\end{equation*}
takes a family $P:X\to \UU$ to the cartesian transformation of spans
\begin{equation*}
\begin{tikzcd}
A\times_X\tilde{P} \arrow[d,swap,"\pi_1"] & S\times_A\Big(A\times_X\tilde{P}\Big) \arrow[l] \arrow[r] \arrow[d,swap,"\pi_1"] & B\times_X\tilde{P} \arrow[d,"\pi_1"] \\
A & S \arrow[l] \arrow[r] & B,
\end{tikzcd}
\end{equation*}
where $\tilde{P}\defeq\sm{x:X}P(x)$.

The composite 
\begin{equation*}
\mathsf{cart\usc{}desc}_{\mathcal{S}}\circ \mathsf{desc\usc{}fam}_X
\end{equation*}
takes a family $P:X\to \UU$ to the cartesian transformation of spans
\begin{equation*}
\begin{tikzcd}
\sm{a:A}P(i(a)) \arrow[d] & \sm{s:S}P(i(f(s))) \arrow[l] \arrow[r] \arrow[d] & \sm{b:B}P(j(b)) \arrow[d] \\
A & S \arrow[l] \arrow[r] & B
\end{tikzcd}
\end{equation*}
These cartesian natural transformations are equal by \cref{lem:pb_subst}
\end{proof}

Since $\mathsf{cart\usc{}map}_{\mathcal{S}}$ is an equivalence it follows that its fibers are contractible. This is essentially the content of the following corollary.

\begin{cor}
Consider a diagram of the form 
\begin{equation*}
\begin{tikzcd}
& S' \arrow[d,swap,"h_S"] \arrow[dl,swap,"{f'}"] \arrow[dr,"{g'}"] \\
A' \arrow[d,swap,"h_A"] & S \arrow[dl,swap,"f"] \arrow[dr,"g"] & B' \arrow[d,"{h_B}"] \\
A \arrow[dr,swap,"i"] & & B \arrow[dl,"j"] \\
& X
\end{tikzcd}
\end{equation*}
with homotopies
\begin{align*}
F & : f\circ h_S \htpy h_A\circ f' \\
G & : g\circ h_S \htpy h_B\circ g' \\
H & : i\circ f \htpy j\circ g,
\end{align*}
and suppose that the bottom square is a pushout square, and the top squares are pullback squares.
Then the type of tuples $((X',h_X),(i',I,p),(j',J,q),(H',C))$ consisting of
\begin{enumerate}
\item A type $X':\UU$ together with a morphism
\begin{equation*}
h_X : X'\to X,
\end{equation*}
\item A map $i':A'\to X'$, a homotopy $I:i\circ h_A\htpy h_X\circ i'$, and a term $p$ witnessing that the square
\begin{equation*}
\begin{tikzcd}
A' \arrow[d,swap,"h_A"] \arrow[r,"{i'}"] & X' \arrow[d,"h_X"] \\
A \arrow[r,swap,"i"] & X
\end{tikzcd}
\end{equation*}
is a pullback square.
\item A map $j':B'\to X'$, a homotopy $J:j\circ h_B\htpy h_X\circ j'$, and a term $q$ witnessing that the square
\begin{equation*}
\begin{tikzcd}
B' \arrow[d,swap,"h_B"] \arrow[r,"{j'}"] & X' \arrow[d,"h_X"] \\
B \arrow[r,swap,"j"] & X
\end{tikzcd}
\end{equation*}
is a pullback square,
\item A homotopy $H':i'\circ f'\htpy j'\circ g'$, and a homotopy
\begin{equation*}
C : \ct{(i\cdot F)}{(\ct{(I\cdot f')}{(h_X\cdot H')})} \htpy \ct{(H\cdot h_S)}{(\ct{(j\cdot G)}{(J\cdot g')})}
\end{equation*}
witnessing that the cube
\begin{equation*}
\begin{tikzcd}
& S' \arrow[dl] \arrow[dr] \arrow[d] \\
A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[dl,crossing over] \arrow[d] \\
A \arrow[dr] & X' \arrow[d] \arrow[from=ul,crossing over] & B \arrow[dl] \\
& X,
\end{tikzcd}
\end{equation*}
commutes,
\end{enumerate}
is contractible.
\end{cor}

The following theorem should be compared to the flattening lemma, \cref{lem:flattening}.\index{flattening lemma!for pushouts}

\begin{thm}
Consider a commuting cube
\begin{equation*}
\begin{tikzcd}
& S' \arrow[dl,swap,"{f'}"] \arrow[dr,"{g'}"] \arrow[d,"h_S"] \\
A' \arrow[d,swap,"h_A"] & S \arrow[dl,swap,"f" near start] \arrow[dr,"g" near start] & B' \arrow[dl,crossing over,"{j'}" near end] \arrow[d,"h_B"] \\
A \arrow[dr,swap,"i"] & X' \arrow[d,"h_X" near start] \arrow[from=ul,crossing over,"{i'}"' near end] & B \arrow[dl,"j"] \\
& X.
\end{tikzcd}
\end{equation*}
If each of the vertical squares is a pullback, and the bottom square  is a pushout, then the top square is a pushout.
\end{thm}

\begin{proof}
By \cref{cor:pb_fibequiv} we have families of equivalences
\begin{align*}
F & : \prd{x:S}\eqv{\fib{h_S}{x}}{\fib{h_A}{f(x)}} \\
G & : \prd{x:S}\eqv{\fib{h_S}{x}}{\fib{h_B}{g(x)}} \\
I & : \prd{a:A}\eqv{\fib{h_A}{a}}{\fib{h_X}{i(a)}} \\
J & : \prd{b:B}\eqv{\fib{h_B}{b}}{\fib{h_X}{j(b)}}. 
\end{align*}
Moreover, since the cube commutes we obtain a family of homotopies
\begin{equation*}
K : \prd{x:S} I(f(x))\circ F(x) \htpy J(g(x))\circ G(x).
\end{equation*}
We define the descent data $(P_A,P_B,P_S)$ consisting of $P_A:A\to\UU$, $P_B:B\to\UU$, and $P_S:\prd{x:S}\eqv{P_A(f(x))}{P_B(g(x))}$ by
\begin{align*}
P_A(a) & \defeq \fib{h_A}{a} \\
P_B(b) & \defeq \fib{h_B}{b} \\
P_S(x) & \defeq G(x)\circ F(x)^{-1}.
\end{align*}
We have
\begin{align*}
P & \defeq \fibf{h_X} \\
e_A & \defeq I \\
e_B & \defeq J \\
e_S & \defeq K.
\end{align*}
Now consider the diagram
\begin{equation*}
\begin{tikzcd}
\sm{s:S}\fib{h_S}{s} \arrow[r] \arrow[d] & \sm{s:S}\fib{h_A}{f(s)} \arrow[r] \arrow[d] & \sm{b:B}\fib{h_B}{b} \arrow[d] \\
\sm{a:A}\fib{h_A}{a} \arrow[r] & \sm{a:A}\fib{h_A}{a} \arrow[r] & \sm{x:X}\fib{h_X}{x}
\end{tikzcd}
\end{equation*}
Since the top and bottom map in the left square are equivalences, we obtain from \cref{ex:pushout_equiv} that the left square is a pushout square. Moreover, the right square is a pushout by \cref{lem:flattening}. Therefore it follows by \cref{thm:pushout_pasting} that the outer rectangle is a pushout square.

Now consider the commuting cube
\begin{equation*}
\begin{tikzcd}
& \sm{s:S}\fib{h_S}{s} \arrow[dl] \arrow[dr] \arrow[d] \\
\sm{a:A}\fib{h_A}{a} \arrow[d] & S' \arrow[dl] \arrow[dr] & \sm{b:B}\fib{h_B}{b} \arrow[dl,crossing over] \arrow[d] \\
A' \arrow[dr,swap] & \sm{x:X}\fib{h_X}{x} \arrow[d] \arrow[from=ul,crossing over] & B' \arrow[dl] \\
& X'.
\end{tikzcd}
\end{equation*}
We have seen that the top square is a pushout. The vertical maps are all equivalences, so the vertical squares are all pushout squares. Thus it follows from one more application of \cref{thm:pushout_pasting} that the bottom square is a pushout.
\end{proof}

%\begin{cor}
%For any map $f:A\sqcup^S B\to X$, and any $x:X$, the square
%\begin{equation*}
%\begin{tikzcd}
%\fib{f_S}{x} \arrow[r] \arrow[d] & \fib{f_B}{x} \arrow[d] \\
%\fib{f_A}{x} \arrow[r] & \fib{f}{x}
%\end{tikzcd}
%\end{equation*}
%is a pushout square.
%\end{cor}

\begin{thm}\label{thm:effectiveness-pullback}
Consider a commuting cube of types 
\begin{equation*}\label{eq:cube}
\begin{tikzcd}
& S' \arrow[dl] \arrow[dr] \arrow[d] \\
A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[dl,crossing over] \arrow[d] \\
A \arrow[dr] & X' \arrow[d] \arrow[from=ul,crossing over] & B \arrow[dl] \\
& X,
\end{tikzcd}
\end{equation*}
and suppose the vertical squares are pullback squares. Then the commuting square
\begin{equation*}
\begin{tikzcd}
A' \sqcup^{S'} B' \arrow[r] \arrow[d] & X' \arrow[d] \\
A\sqcup^{S} B \arrow[r] & X
\end{tikzcd}
\end{equation*}
is a pullback square.
\end{thm}

\begin{proof}
It suffices to show that the pullback 
\begin{equation*}
(A\sqcup^{S} B)\times_{X}X'
\end{equation*}
has the universal property of the pushout. This follows by the descent theorem, since the vertical squares in the cube
\begin{equation*}
\begin{tikzcd}
& S' \arrow[dl] \arrow[dr] \arrow[d] \\
A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[dl,crossing over] \arrow[d] \\
A \arrow[dr] & (A\sqcup^{S} B)\times_{X}X' \arrow[d] \arrow[from=ul,crossing over] & B \arrow[dl] \\
& A\sqcup^{S} B
\end{tikzcd}
\end{equation*}
are pullback squares by \cref{thm:pb_pasting}.
\end{proof}

\subsection{Applications of the descent theorem}

\begin{thm}
  Consider a commuting cube
  \begin{equation*}
    \begin{tikzcd}
      & S' \arrow[dl] \arrow[dr] \arrow[d] \\
      A' \arrow[d] & S \arrow[dl] \arrow[dr] & B' \arrow[dl,crossing over] \arrow[d] \\
      A \arrow[dr] & C' \arrow[from=ul,crossing over] \arrow[d] & B \arrow[dl] \\
      & C
    \end{tikzcd}
  \end{equation*}
  in which the bottom square is a pushout square. If the vertical sides are pullback squares, then for each $c:C$ the square of fibers
  \begin{equation*}
    \begin{tikzcd}
      \fib{i\circ f\circ h_S}{c} \arrow[d] \arrow[r] & \fib{j\circ g\circ h_S}{c} \arrow[r] & \fib{j\circ h_B}{c} \arrow[d] \\
      \fib{i\circ h_A}{c} \arrow[rr] & & \fib{h_C}{c}
    \end{tikzcd}
  \end{equation*}
  is a pushout square.
\end{thm}

\begin{exercises}
\exercise Use the characterization of the circle\index{circle} as a pushout given in \cref{eg:circle_pushout} to show that the square
\begin{equation*}
\begin{tikzcd}[column sep=large]
\sphere{1}+\sphere{1} \arrow[r,"{[\idfunc,\idfunc]}"] \arrow[d,swap,"{[\idfunc,\idfunc]}"] & \sphere{1} \arrow[d,"{\lam{t}(t,\base)}"] \\
\sphere{1} \arrow[r,swap,"{\lam{t}(t,\base)}"] & \sphere{1}\times\sphere{1}
\end{tikzcd}
\end{equation*}
is a pushout square.
\exercise Let $f:A\to B$ be a map. The \define{codiagonal}\index{codiagonal}\index{nabla@{$\nabla_f$}} $\nabla_f$ of $f$ is the map obtained from the universal property of the pushout, as indicated in the diagram
\begin{equation*}
\begin{tikzcd}
A \arrow[d,swap,"f"] \arrow[r,"f"] \arrow[dr, phantom, "\ulcorner", very near end] & B \arrow[d,"\inr"] \arrow[ddr,bend left=15,"{\idfunc[B]}"] \\
A \arrow[r,"\inl"] \arrow[drr,bend right=15,swap,"{\idfunc[B]}"] & B\sqcup^{A} B \arrow[dr,densely dotted,near start,swap,"\nabla_f"] \\
& & B
\end{tikzcd}
\end{equation*}
Show that $\fib{\nabla_f}{b}\eqvsym \susp(\fib{f}{b})$ for any $b:B$.
\exercise \label{ex:fib_join}Consider two maps $f:A\to X$ and $g:B\to X$. The \define{fiberwise join}\index{fiberwise join} $\join{f}{g}$ is defined by the universal property of the pushout as the unique map rendering the diagram
\begin{equation*}
\begin{tikzcd}
A\times_X B \arrow[d,"\pi_1"] \arrow[r,"\pi_2"] \arrow[dr, phantom, "\ulcorner", very near end] & B \arrow[d,"\inr"] \arrow[ddr,bend left=15,"g"] \\
A \arrow[r,"\inl"] \arrow[drr,bend right=15,swap,"f"] & \join[X]{A}{B} \arrow[dr,densely dotted,near start,swap,"\join{f}{g}"] \\
& & X
\end{tikzcd}
\end{equation*}
commutative, where $\join[X]{A}{B}$ is defined as a pushout, as indicated.
Construct an equivalence
\begin{equation*}
\eqv{\fib{\join{f}{g}}{x}}{\join{\fib{f}{x}}{\fib{g}{x}}}
\end{equation*}
for any $x:X$. 
\exercise Consider two maps $f:A\to B$ and $g:C\to D$.
The \define{pushout-product}\index{pushout-product}
\begin{equation*}
f\square g : (A\times D)\sqcup^{A\times C} (B\times C)\to B\times D
\end{equation*}
of $f$ and $g$ is defined by the universal property of the pushout as the unique map rendering the diagram
\begin{equation*}
\begin{tikzcd}
A\times C \arrow[r,"{f\times \idfunc[C]}"] \arrow[d,swap,"{\idfunc[A]\times g}"] & B\times C \arrow[d,"\inr"] \arrow[ddr,bend left=15,"{\idfunc[B]\times g}"] \\
A\times D \arrow[r,"\inl"] \arrow[drr,bend right=15,swap,"{f\times\idfunc[D]}"] & (A\times D)\sqcup^{A\times C} (B\times C) \arrow[dr,densely dotted,swap,near start,"f\square g"] \\
& & B\times D
\end{tikzcd}
\end{equation*}
commutative. Construct an equivalence
\begin{equation*}
\eqv{\fib{f\square g}{b,d}}{\join{\fib{f}{b}}{\fib{g}{d}}}
\end{equation*}
for all $b:B$ and $d:D$.
\exercise Let $A$ and $B$ be pointed types with base points $a_0:A$ and $b_0:B$. The \define{wedge inclusion}\index{wedge inclusion} is defined as follows by the universal property of the wedge:
\begin{equation*}
\begin{tikzcd}[column sep=huge]
\unit \arrow[r] \arrow[d] & B \arrow[d,"\inr"] \arrow[ddr,bend left=15,"{\lam{b}(a_0,b)}"] \\
A \arrow[r,"\inl"] \arrow[drr,bend right=15,swap,"{\lam{a}(a,b_0)}"] & A\vee B \arrow[dr,densely dotted,swap,"{\mathsf{wedge\usc{}in}_{A,B}}"{near start,xshift=1ex}] \\
& & A\times B
\end{tikzcd}
\end{equation*}
Show that the fiber of the wedge inclusion $A\vee B\to A\times B$ is equivalent to $\join{\loopspace{B}}{\loopspace{A}}$.
\exercise Let $f:X\vee X\to X$ be the map defined by the universal property of the wedge as indicated in the diagram
\begin{equation*}
\begin{tikzcd}
\unit \arrow[d,swap,"x_0"] \arrow[r,"x_0"] \arrow[dr, phantom, "\ulcorner", very near end] & X \arrow[d,"\inr"] \arrow[ddr,bend left=15,"{\idfunc[X]}"] \\
X \arrow[r,"\inl"] \arrow[drr,bend right=15,swap,"{\idfunc[X]}"] & X\vee X \arrow[dr,densely dotted,near start,swap,"f"] \\
& & X.
\end{tikzcd}
\end{equation*}
\begin{subexenum}
\item Show that $\eqv{\fib{f}{x_0}}{\susp\loopspace{X}}$. 
\item Show that $\eqv{\mathsf{cof}_f}{\susp X}$.
\end{subexenum}
\exercise Consider a pushout square
\begin{equation*}
\begin{tikzcd}
S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
A \arrow[r,swap,"i"] & X,
\end{tikzcd}
\end{equation*}
and suppose that $f$ is an embedding. Show that $j$ is an embedding, and that the square is also a pullback square.
  \exercise Consider a pushout square
  \begin{equation*}
    \begin{tikzcd}
      S \arrow[d,swap,"f"] \arrow[r,"g"] & B \arrow[d,"j"] \\
      A \arrow[r,swap,"i"] & X.
    \end{tikzcd}
  \end{equation*}
  \begin{subexenum}
  \item Show that if $f$ is surjective, then so is $j$.
  \item Show that the two small squares in the diagram 
    \begin{equation*}
      \begin{tikzcd}
        S \arrow[r,"g"] \arrow[d,swap,"q_f"] & B \arrow[d,"q_j"] \\
        \im(f) \arrow[r,densely dotted] \arrow[d,swap,"i_f"] & \im(j) \arrow[d,"i_j"] \\
        A \arrow[r,swap,"i"] & X
      \end{tikzcd}
    \end{equation*}
    are both pushout squares, and that the bottom square is also a pullback square.
  \end{subexenum}
\end{exercises}
