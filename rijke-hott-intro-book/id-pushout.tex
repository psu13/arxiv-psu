\section{The identity types of pushouts}

\subsection{Characterizing families of maps over pushouts}
  
\begin{defn}
    Consider a span $\mathcal{S}$
  \begin{equation*}
    \begin{tikzcd}
      A & S \arrow[l,swap,"f"] \arrow[r,"g"] & B,
    \end{tikzcd}
  \end{equation*}
  and consider $P,Q:\mathsf{Fam\usc{}pushout}(\mathcal{S})$.
  A morphism of descent data from $P$ to $Q$ over $\mathcal{S}$ is defined to be a triple $(h_A,h_B,h_S)$ consisting of
  \begin{align*}
    h_A & : \prd{x:A} P_A(x)\to Q_A(x) \\
    h_B & : \prd{y:B} P_B(y)\to Q_B(y)
  \end{align*}
  equipped with a homotopy $h_S$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=huge]
      P_A(f(s)) \arrow[r,"h_A(f(s))"] \arrow[d,swap,"P_S(s)"] & Q_A(f(s)) \arrow[d,"Q_S(s)"] \\
      P_B(g(s)) \arrow[r,swap,"h_B(g(s))"] & Q_B(g(s))
    \end{tikzcd}
  \end{equation*}
  commutes for every $s:S$. We write $\mathsf{hom}_{\mathcal{S}}(P,Q)$ for the type of morphisms of descent data over $\mathcal{S}$.

  An equivalence of descent data from $P$ to $Q$ is a morphism $h$ such that $h_A$ and $h_B$ are families of equivalences.
\end{defn}

\begin{rmk}\label{rmk:id-hom-Fam-pushout}
  The identity type $h=h'$ of $\mathsf{hom}_{\mathcal{S}}(P,Q)$ is characterized as the type of triples $(H_A,H_B,H_S)$ consisting of
  \begin{align*}
    H_A & : \prd{a:A} h_A(a)\htpy h'_A(a) \\
    H_B & : \prd{b:B} h_B(b)\htpy h'_B(b)
  \end{align*}
  and a homotopy $K_S(s)$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}
      h_B(g(s))\circ P_S(s) \arrow[d] \arrow[r] & Q_S(s)\circ h_A(f(s)) \arrow[d] \\
      h'_B(g(s))\circ P_S(s) \arrow[r] & Q_S(s)\circ h'_A(g(s))
    \end{tikzcd}
  \end{equation*}
  of homotopies commutes for every $s:S$.
\end{rmk}

\begin{defn}\label{defn:hom-Fam-pushout-map}
  Consider a commuting square
  \begin{equation*}
    \begin{tikzcd}
      S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
      A \arrow[r,swap,"i"] & X
    \end{tikzcd}
  \end{equation*}
  with $H:i\circ f \htpy j \circ f$, and let $P$ and $Q$ be type families over $X$. We define a map
  \begin{equation*}
    \Big(\prd{x:X}P(x)\to Q(x)\Big) \to \mathsf{hom}_{\mathcal{S}}(\mathsf{desc\usc{}fam}(P),\mathsf{desc\usc{}fam}(Q)).
  \end{equation*}
\end{defn}

\begin{constr}
  Let $h:\prd{x:X}P(x)\to Q(x)$. Then we define
  \begin{align*}
    h_A & : \prd{a:A}P(i(a))\to Q(i(a)) \\
    h_B & : \prd{b:B}P(j(b))\to Q(j(b))
  \end{align*}
  by $h_A(a,p)\defeq h(i(a),p)$ and $h_B(b,q)\defeq h(j(b),q)$. Then it remains to define for every $s:S$ a homotopy $h_S(s)$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=huge]
      P(i(f(s))) \arrow[r,"h_A(f(s))"] \arrow[d,swap,"\mathsf{tr}_P(H(s))"] & Q(i(f(s))) \arrow[d,"\mathsf{tr}_Q(H(s))"] \\
      P(j(g(s))) \arrow[r,swap,"h_B(g(s))"] & Q(j(g(s)))
    \end{tikzcd}
  \end{equation*}
  commutes. Note that every family of maps $h:\prd{x:X}P(x)\to Q(x)$ is natural in the sense that for any path $p:x=x'$ in $X$, there is a homotopy $\psi(p,h)$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}
      P(x) \arrow[r,"h(x)"] \arrow[d,swap,"\mathsf{tr}_P(p)"] & Q(x) \arrow[d,"\mathsf{tr}_Q(p)"] \\
      P(x') \arrow[r,swap,"{h(x')}"] & Q(x')
    \end{tikzcd}
  \end{equation*}
  commutes. Therefore we define $h_S(s)\defeq\psi(H(s),h)$.
\end{constr}

\begin{thm}\label{thm:hom-Fam-pushout}
  The map defined in \cref{defn:hom-Fam-pushout-map} is an equivalence.
\end{thm}

\begin{proof}
  We will first construct a commuting triangle
  \begin{equation*}
    \begin{tikzcd}[column sep=-3em]
      \phantom{\mathsf{hom}_{\mathcal{S}}(\mathsf{desc\usc{}fam}(P),\mathsf{desc\usc{}fam}(Q))} & \prd{x:X}P(x)\to Q(x) \arrow[dl] \arrow[dr] & \phantom{\mathsf{dep\usc{}cocone}_{(i,j,H)}(x\mapsto P(x)\to Q(x))} \\
      \mathsf{dep\usc{}cocone}_{(i,j,H)}(x\mapsto P(x)\to Q(x)) \arrow[rr,densely dotted] & &
      \mathsf{hom}_{\mathcal{S}}(\mathsf{desc\usc{}fam}(P),\mathsf{desc\usc{}fam}(Q))
    \end{tikzcd}
  \end{equation*}
  Recall from \cref{thm:dependent-pullback-property-pushout} that $X$ satisfies the dependent universal property, so the map on the left is an equivalence. Therefore we will prove the claim by showing that the bottom map is an equivalence.

  In order to construct the bottom map, we first note that for any two maps $\alpha:P(x)\to Q(x)$ and $\alpha':P(x')\to Q(x')$ and any path $p:x=x'$, there is an equivalence
  \begin{equation*}
    \varphi(p,f,f'):\Big(\mathsf{tr}_{x\mapsto P(x)\to Q(x)}(p,f)=f'\Big) \simeq \Big(\prd{y:B(x)} f'(\mathsf{tr}_B(p,y))=\mathsf{tr}_C(p,f(y))\Big).
  \end{equation*}
  The equivalence $\varphi$ is defined by path induction on $p$, where we take
  \begin{equation*}
    \varphi(\refl{},f,f')\defeq \mathsf{htpy\usc{}eq}\circ\mathsf{inv}.
  \end{equation*}
  Now we define the bottom map in the asserted triangle to be the map
  \begin{equation*}
    (h_A,h_B,h_S)\mapsto (h_A,h_B,\lam{s}\varphi(H(s),h_A(f(s)),h_B(g(s)),h_S(s))).
  \end{equation*}
  Note that this map is an equivalence, since it is the induced map on total spaces of an equivalence.

  It remains to show that the triangle commutes. By \cref{rmk:id-hom-Fam-pushout} it suffices to construct families of homotopies
  \begin{align*}
    K_A : \prd{a:A} h_{i(a)}\htpy h_{i(a)} \\
    K_B : \prd{b:B} h_{j(b)}\htpy h_{j(b)}
  \end{align*}
  and for each $s:S$ a homotopy $K_S(s)$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=13em]
      h_{j(g(s))} \circ \mathsf{tr}_P(H(s)) \arrow[d] \arrow[r,"{\psi(H(s),h)}"] & \mathsf{tr}_Q(H(s)) \circ h_{i(f(s))} \arrow[d] \\
      h_{j(g(s))} \circ \mathsf{tr}_P(H(s)) \arrow[r,swap,"{\varphi(H(s),h_{i(f(s))},h_{j(g(s))},\apd{h}{H(s)})}"] & \mathsf{tr}_Q(H(s))\circ h_{i(f(s))}
    \end{tikzcd}
  \end{equation*}
  commutes. Of course, we take $K_A(a)\defeq\mathsf{htpy\usc{}refl}$ and $K_B(b)\defeq\mathsf{htpy\usc{}refl}$, so it suffices to show that
  \begin{equation*}
    \psi(H(s),h)\htpy \varphi(H(s),h_{i(f(s))},h_{j(g(s))},\apd{h}{H(s)}).
  \end{equation*}
  Now we would like to proceed by homotopy induction on $H:i\circ f \htpy j\circ g$. However, we can only do so after we generalize the problem sufficiently to a situation where $H$ has free endpoints. It is indeed possible by homotopy induction to construct for every $f,g:S\to X$ equipped with a homotopy $H:f\htpy g$, every family of maps $h:\prd{x:X}P(x)\to Q(x)$ and every $s:S$, a homotopy
  \begin{equation*}
    \psi(H(s),h)\htpy \varphi(H(s),h_{f(s)},h_{g(s)},\apd{h}{H(s)}).\qedhere
  \end{equation*}
\end{proof}

\subsection{Characterizing the identity types of pushouts}

\begin{defn}
  Consider a span $\mathcal{S}$ equipped with $a:A$, and consider
  $P:\mathsf{Fam\usc{}pushout}(\mathcal{S})$ equipped with $p:P_A(a)$. We say that $P$ is \define{universal} if for every $Q:\mathsf{Fam\usc{}pushout}(\mathcal{S})$ the evaluation map
  \begin{equation*}
    \mathsf{hom}_{\mathcal{S}}(P,Q)\to Q_A(a)
  \end{equation*}
  given by $h\mapsto h_A(a,p)$ is an equivalence.
\end{defn}

\begin{lem}
  Consider a pushout square
  \begin{equation*}
    \begin{tikzcd}
      S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
      A \arrow[r,swap,"i"] & X
    \end{tikzcd}
  \end{equation*}
  with $H:i\circ f \htpy j\circ g$, and let $a:A$. Furthermore, let $P$ be the descent data for the type family $x\mapsto i(a)=x$ over $X$. Then $P$ is universal.
\end{lem}

\begin{proof}
  Since $\mathsf{desc\usc{}fam}$ is an equivalence, it suffices to show that for every type family $Q$ over $X$, the map
  \begin{equation*}
    \mathsf{hom}_{\mathcal{S}}(\mathsf{desc\usc{}fam}(\mathsf{Id}(i(a))),\mathsf{desc\usc{}fam}(Q))\to Q(i(a))
  \end{equation*}
  given by $h\mapsto h_A(a,\refl{i(a)})$ is an equivalence. 
  Note that we have a commuting triangle
  \begin{equation*}
    \begin{tikzcd}
      \prd{x:X}(i(a)=x)\to Q(x) \arrow[r] \arrow[dr,swap,"\mathsf{ev\usc{}refl}"] &
      \mathsf{hom}_{\mathcal{S}}(\mathsf{desc\usc{}fam}(\mathsf{Id}(i(a))),\mathsf{desc\usc{}fam}(Q)) \arrow[d,"{h\mapsto h_A(\refl{i(a)})}"] \\
      & Q(i(a))
    \end{tikzcd}
  \end{equation*}
  The map $\mathsf{ev\usc{}refl}$ is an equivalence by \cref{thm:yoneda}, and the top map is an equivalence by \cref{thm:hom-Fam-pushout}. Therefore it follows that the remaining map is an equivalence.
\end{proof}

\begin{thm}
  Consider a pushout square
  \begin{equation*}
    \begin{tikzcd}
      S \arrow[r,"g"] \arrow[d,swap,"f"] & B \arrow[d,"j"] \\
      A \arrow[r,swap,"i"] & X
    \end{tikzcd}
  \end{equation*}
  with $H:i\circ f \htpy j\circ g$, and let $a:A$. Furthermore consider a pair $(P,p_0)$ consisting of $P:\mathsf{Fam\usc{}pushout}(\mathcal{S})$ and $p:P_A(a)$. If $P$ is universal, then we have two families of equivalences
  \begin{align*}
    e_A & : \prd{x:A}P_A(x)\simeq (i(a)=i(x)) \\
    e_B & : \prd{y:B} P_B(y)\simeq (i(a)=j(b)) 
  \end{align*}
  equipped with a homotopy $e_S$ witnessing that the square
  \begin{equation*}
    \begin{tikzcd}[column sep=huge]
      P_A(f(s)) \arrow[r,"e(s)"] \arrow[d,swap,"e_A(f(s))"] & P_B(g(s)) \arrow[d,"e_B(g(s))"] \\
      (i(a)=i(f(s))) \arrow[r,swap,"\lam{p}\ct{p}{H(s)}"] & (i(a)=g(s))
    \end{tikzcd}
  \end{equation*}
  commutes for each $s:S$, and an identification $e_A(a,r)=\refl{i(a)}$
\end{thm}

\begin{thm}
  Let $X$ be a pointed type with base point $x_0:X$. Then the loop space of $\susp{X}$ is the initial type $Y$ equipped with a base point $y_0:Y$, and a pointed map
  \begin{equation*}
    X \to_\ast (Y\simeq Y).
  \end{equation*}
\end{thm}

\begin{proof}
  The type of pairs $(Y,\mu)$ consisting of a pointed type $Y$ and a pointed map $\mu:X\to_\ast (Y \simeq Y)$ is equivalent to the type of triples $(Y,Z,\mu)$ consisting of a pointed type $Y$, a type $Z$, and a map $\mu:X\to (Y\simeq Z)$.  
\end{proof}

\begin{cor}
  The loop space of $\sphere{2}$ is the initial type $X$ equipped with a point $x_0:X$ and a homotopy $H:\idfunc\htpy\idfunc$.
\end{cor}

\begin{exercises}
\exercise Consider the suspension
  \begin{equation*}
    \begin{tikzcd}
      P \arrow[r] \arrow[d] & \unit \arrow[d,"\south"] \\
      \unit \arrow[r,swap,"\north"] & \susp{P}
    \end{tikzcd}
  \end{equation*}
  of a proposition $P$. Show that $(\north=\south)\simeq P$. 
\exercise Show that if $X$ has decidable equality, then $\susp{X}$ is a $1$-type.
\exercise Consider a pushout square
  \begin{equation*}
    \begin{tikzcd}
      A \arrow[r] \arrow[d,swap,"f"] & \unit \arrow[d,"j"] \\
      B \arrow[r,swap,"i"] & X
    \end{tikzcd}
  \end{equation*}
  where $f:A\to B$ is an embedding.
  \begin{subexenum}
  \item Show that there are equivalences
  \begin{align*}
    (i(b)=i(y)) & \simeq (b=y)\ast \fib{f}{b} \\
    (i(b)=j(\ttt)) & \simeq \fib{f}{b}
  \end{align*}
  for any $b,y:B$.
  \item Use \cref{ex:trunc-join-with-prop} to show that if $B$ is a $k$-type, then so is $X$, for any $k\geq 0$.
  \end{subexenum}
\exercise Consider the join
  \begin{equation*}
    \begin{tikzcd}
      P \times X \arrow[r,"\proj 2"] \arrow[d,swap,"\proj 1"] & X \arrow[d,"\inr"] \\
      P \arrow[r,swap,"\inl"] & \join{P}{X}
    \end{tikzcd}
  \end{equation*}
  of a proposition $P$ and an arbitrary type $X$.
  \begin{subexenum}
  \item Show that for any $x,y:X$ there is an equivalence
    $e:(\inr(x)=\inr(y))\simeq \join{P}{(x=y)}$ for which the triangle
  \begin{equation*}
    \begin{tikzcd}[column sep=tiny]
      \phantom{\join{P}{(x=y)}} & (x=y) \arrow[dl,swap,"\apfunc{\inr}"] \arrow[dr,"\inr"] & \phantom{(\inr(x)=\inr(y))} \\
      (\inr(x)=\inr(y)) \arrow[rr,swap,"e"] & & \join{P}{(x=y)}
    \end{tikzcd}
  \end{equation*}
  commutes.
\exercise \label{ex:trunc-join-with-prop}Show that if $X$ is a $k$-type, then so is $\join{P}{X}$.
  \end{subexenum}
\end{exercises}
