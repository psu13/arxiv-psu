\usepackage{amssymb,amsmath,stmaryrd,mathrsfs,amsthm}
\usepackage[all,2cell]{xy}
\usepackage[neveradjust]{paralist}
\usepackage{hyperref}
%\usepackage{graphics,color,epsfig}
%\usepackage{fullpage}
%\usepackage{eucal}
%\usepackage{txfonts}
%\usepackage{wasysym}

% Defining commands that are always in math mode.
\def\mdef#1#2{\expandafter\expandafter\expandafter\gdef\expandafter\expandafter\noexpand#1\expandafter{\expandafter\ensuremath\expandafter{#2}}}

% Script letters
\newcommand{\sA}{\ensuremath{\mathscr{A}}}
\newcommand{\sB}{\ensuremath{\mathscr{B}}}
\newcommand{\sC}{\ensuremath{\mathscr{C}}}
\newcommand{\sD}{\ensuremath{\mathscr{D}}}
\newcommand{\sE}{\ensuremath{\mathscr{E}}}
\newcommand{\sF}{\ensuremath{\mathscr{F}}}
\newcommand{\sG}{\ensuremath{\mathscr{G}}}
\newcommand{\sH}{\ensuremath{\mathscr{H}}}
\newcommand{\sI}{\ensuremath{\mathscr{I}}}
\newcommand{\sJ}{\ensuremath{\mathscr{J}}}
\newcommand{\sK}{\ensuremath{\mathscr{K}}}
\newcommand{\sL}{\ensuremath{\mathscr{L}}}
\newcommand{\sM}{\ensuremath{\mathscr{M}}}
\newcommand{\sN}{\ensuremath{\mathscr{N}}}
\newcommand{\sO}{\ensuremath{\mathscr{O}}}
\newcommand{\sP}{\ensuremath{\mathscr{P}}}
\newcommand{\sQ}{\ensuremath{\mathscr{Q}}}
\newcommand{\sR}{\ensuremath{\mathscr{R}}}
\newcommand{\sS}{\ensuremath{\mathscr{S}}}
\newcommand{\sT}{\ensuremath{\mathscr{T}}}
\newcommand{\sU}{\ensuremath{\mathscr{U}}}
\newcommand{\sV}{\ensuremath{\mathscr{V}}}
\newcommand{\sW}{\ensuremath{\mathscr{W}}}
\newcommand{\sX}{\ensuremath{\mathscr{X}}}
\newcommand{\sY}{\ensuremath{\mathscr{Y}}}
\newcommand{\sZ}{\ensuremath{\mathscr{Z}}}

% Calligraphic letters
\newcommand{\cA}{\ensuremath{\mathcal{A}}}
\newcommand{\cB}{\ensuremath{\mathcal{B}}}
\newcommand{\cC}{\ensuremath{\mathcal{C}}}
\newcommand{\cD}{\ensuremath{\mathcal{D}}}
\newcommand{\cE}{\ensuremath{\mathcal{E}}}
\newcommand{\cF}{\ensuremath{\mathcal{F}}}
\newcommand{\cG}{\ensuremath{\mathcal{G}}}
\newcommand{\cH}{\ensuremath{\mathcal{H}}}
\newcommand{\cI}{\ensuremath{\mathcal{I}}}
\newcommand{\cJ}{\ensuremath{\mathcal{J}}}
\newcommand{\cK}{\ensuremath{\mathcal{K}}}
\newcommand{\cL}{\ensuremath{\mathcal{L}}}
\newcommand{\cM}{\ensuremath{\mathcal{M}}}
\newcommand{\cN}{\ensuremath{\mathcal{N}}}
\newcommand{\cO}{\ensuremath{\mathcal{O}}}
\newcommand{\cP}{\ensuremath{\mathcal{P}}}
\newcommand{\cQ}{\ensuremath{\mathcal{Q}}}
\newcommand{\cR}{\ensuremath{\mathcal{R}}}
\newcommand{\cS}{\ensuremath{\mathcal{S}}}
\newcommand{\cT}{\ensuremath{\mathcal{T}}}
\newcommand{\cU}{\ensuremath{\mathcal{U}}}
\newcommand{\cV}{\ensuremath{\mathcal{V}}}
\newcommand{\cW}{\ensuremath{\mathcal{W}}}
\newcommand{\cX}{\ensuremath{\mathcal{X}}}
\newcommand{\cY}{\ensuremath{\mathcal{Y}}}
\newcommand{\cZ}{\ensuremath{\mathcal{Z}}}

% blackboard bold letters
\newcommand{\bbA}{\ensuremath{\mathbb{A}}}
\newcommand{\bbB}{\ensuremath{\mathbb{B}}}
\newcommand{\bbC}{\ensuremath{\mathbb{C}}}
\newcommand{\bbD}{\ensuremath{\mathbb{D}}}
\newcommand{\bbE}{\ensuremath{\mathbb{E}}}
\newcommand{\bbF}{\ensuremath{\mathbb{F}}}
\newcommand{\bbG}{\ensuremath{\mathbb{G}}}
\newcommand{\bbH}{\ensuremath{\mathbb{H}}}
\newcommand{\bbI}{\ensuremath{\mathbb{I}}}
\newcommand{\bbJ}{\ensuremath{\mathbb{J}}}
\newcommand{\bbK}{\ensuremath{\mathbb{K}}}
\newcommand{\bbL}{\ensuremath{\mathbb{L}}}
\newcommand{\bbM}{\ensuremath{\mathbb{M}}}
\newcommand{\bbN}{\ensuremath{\mathbb{N}}}
\newcommand{\bbO}{\ensuremath{\mathbb{O}}}
\newcommand{\bbP}{\ensuremath{\mathbb{P}}}
\newcommand{\bbQ}{\ensuremath{\mathbb{Q}}}
\newcommand{\bbR}{\ensuremath{\mathbb{R}}}
\newcommand{\bbS}{\ensuremath{\mathbb{S}}}
\newcommand{\bbT}{\ensuremath{\mathbb{T}}}
\newcommand{\bbU}{\ensuremath{\mathbb{U}}}
\newcommand{\bbV}{\ensuremath{\mathbb{V}}}
\newcommand{\bbW}{\ensuremath{\mathbb{W}}}
\newcommand{\bbX}{\ensuremath{\mathbb{X}}}
\newcommand{\bbY}{\ensuremath{\mathbb{Y}}}
\newcommand{\bbZ}{\ensuremath{\mathbb{Z}}}

%% the package `mathbbol' gives us blackboard bold greek and numbers,
%% but it does it by redefining \mathbb to use a different font, so
%% that all the other \mathbb letters look different too.  Here we
%% import the font with bb Delta but assign it a different name, to
%% avoid this problem.
\DeclareSymbolFont{bbold}{U}{bbold}{m}{n}
\DeclareSymbolFontAlphabet{\mathbbb}{bbold}
\newcommand{\bbDelta}{\ensuremath{\mathbbb{\Delta}}}
\newcommand{\bbone}{\ensuremath{\mathbbb{1}}}
\newcommand{\bbtwo}{\ensuremath{\mathbbb{2}}}
\newcommand{\bbthree}{\ensuremath{\mathbbb{3}}}

\newcommand{\bbk}{\ensuremath{\mathbbb{k}}}

% bold letters
\newcommand{\bA}{\ensuremath{\mathbf{A}}}
\newcommand{\bB}{\ensuremath{\mathbf{B}}}
\newcommand{\bC}{\ensuremath{\mathbf{C}}}
\newcommand{\bD}{\ensuremath{\mathbf{D}}}
\newcommand{\bE}{\ensuremath{\mathbf{E}}}
\newcommand{\bF}{\ensuremath{\mathbf{F}}}
\newcommand{\bG}{\ensuremath{\mathbf{G}}}
\newcommand{\bH}{\ensuremath{\mathbf{H}}}
\newcommand{\bI}{\ensuremath{\mathbf{I}}}
\newcommand{\bJ}{\ensuremath{\mathbf{J}}}
\newcommand{\bK}{\ensuremath{\mathbf{K}}}
\newcommand{\bL}{\ensuremath{\mathbf{L}}}
\newcommand{\bM}{\ensuremath{\mathbf{M}}}
\newcommand{\bN}{\ensuremath{\mathbf{N}}}
\newcommand{\bO}{\ensuremath{\mathbf{O}}}
\newcommand{\bP}{\ensuremath{\mathbf{P}}}
\newcommand{\bQ}{\ensuremath{\mathbf{Q}}}
\newcommand{\bR}{\ensuremath{\mathbf{R}}}
\newcommand{\bS}{\ensuremath{\mathbf{S}}}
\newcommand{\bT}{\ensuremath{\mathbf{T}}}
\newcommand{\bU}{\ensuremath{\mathbf{U}}}
\newcommand{\bV}{\ensuremath{\mathbf{V}}}
\newcommand{\bW}{\ensuremath{\mathbf{W}}}
\newcommand{\bX}{\ensuremath{\mathbf{X}}}
\newcommand{\bY}{\ensuremath{\mathbf{Y}}}
\newcommand{\bZ}{\ensuremath{\mathbf{Z}}}

% underline letters
\newcommand{\uA}{\ensuremath{\underline{A}}}
\newcommand{\uB}{\ensuremath{\underline{B}}}
\newcommand{\uC}{\ensuremath{\underline{C}}}
\newcommand{\uD}{\ensuremath{\underline{D}}}
\newcommand{\uE}{\ensuremath{\underline{E}}}
\newcommand{\uF}{\ensuremath{\underline{F}}}
\newcommand{\uG}{\ensuremath{\underline{G}}}
\newcommand{\uH}{\ensuremath{\underline{H}}}
\newcommand{\uI}{\ensuremath{\underline{I}}}
\newcommand{\uJ}{\ensuremath{\underline{J}}}
\newcommand{\uK}{\ensuremath{\underline{K}}}
\newcommand{\uL}{\ensuremath{\underline{L}}}
\newcommand{\uM}{\ensuremath{\underline{M}}}
\newcommand{\uN}{\ensuremath{\underline{N}}}
\newcommand{\uO}{\ensuremath{\underline{O}}}
\newcommand{\uP}{\ensuremath{\underline{P}}}
\newcommand{\uQ}{\ensuremath{\underline{Q}}}
\newcommand{\uR}{\ensuremath{\underline{R}}}
\newcommand{\uS}{\ensuremath{\underline{S}}}
\newcommand{\uT}{\ensuremath{\underline{T}}}
\newcommand{\uU}{\ensuremath{\underline{U}}}
\newcommand{\uV}{\ensuremath{\underline{V}}}
\newcommand{\uW}{\ensuremath{\underline{W}}}
\newcommand{\uX}{\ensuremath{\underline{X}}}
\newcommand{\uY}{\ensuremath{\underline{Y}}}
\newcommand{\uZ}{\ensuremath{\underline{Z}}}

% fraktur letters
% fraktur letters
\newcommand{\fa}{\ensuremath{\mathfrak{a}}}
\newcommand{\fb}{\ensuremath{\mathfrak{b}}}
\newcommand{\fc}{\ensuremath{\mathfrak{c}}}
\newcommand{\fd}{\ensuremath{\mathfrak{d}}}
\newcommand{\fe}{\ensuremath{\mathfrak{e}}}
\newcommand{\ff}{\ensuremath{\mathfrak{f}}}
\newcommand{\fg}{\ensuremath{\mathfrak{g}}}
\newcommand{\fh}{\ensuremath{\mathfrak{h}}}
%\newcommand{\fi}{\ensuremath{\mathfrak{i}}}
\newcommand{\fj}{\ensuremath{\mathfrak{j}}}
\newcommand{\fk}{\ensuremath{\mathfrak{k}}}
\newcommand{\fl}{\ensuremath{\mathfrak{l}}}
\newcommand{\fm}{\ensuremath{\mathfrak{m}}}
\newcommand{\fn}{\ensuremath{\mathfrak{n}}}
\newcommand{\fo}{\ensuremath{\mathfrak{o}}}
\newcommand{\fp}{\ensuremath{\mathfrak{p}}}
\newcommand{\fq}{\ensuremath{\mathfrak{q}}}
\newcommand{\fr}{\ensuremath{\mathfrak{r}}}
\newcommand{\fs}{\ensuremath{\mathfrak{s}}}
\newcommand{\ft}{\ensuremath{\mathfrak{t}}}
\newcommand{\fu}{\ensuremath{\mathfrak{u}}}
\newcommand{\fv}{\ensuremath{\mathfrak{v}}}
\newcommand{\fw}{\ensuremath{\mathfrak{w}}}
\newcommand{\fx}{\ensuremath{\mathfrak{x}}}
\newcommand{\fy}{\ensuremath{\mathfrak{y}}}
\newcommand{\fz}{\ensuremath{\mathfrak{z}}}
\newcommand{\fS}{\ensuremath{\mathfrak{S}}}
\newcommand{\fU}{\ensuremath{\mathfrak{U}}}

% bars
\newcommand{\Abar}{\ensuremath{\overline{A}}}
\newcommand{\Bbar}{\ensuremath{\overline{B}}}
\newcommand{\Cbar}{\ensuremath{\overline{C}}}
\newcommand{\Dbar}{\ensuremath{\overline{D}}}
\newcommand{\Ebar}{\ensuremath{\overline{E}}}
\newcommand{\Fbar}{\ensuremath{\overline{F}}}
\newcommand{\Gbar}{\ensuremath{\overline{G}}}
\newcommand{\Hbar}{\ensuremath{\overline{H}}}
\newcommand{\Ibar}{\ensuremath{\overline{I}}}
\newcommand{\Jbar}{\ensuremath{\overline{J}}}
\newcommand{\Kbar}{\ensuremath{\overline{K}}}
\newcommand{\Lbar}{\ensuremath{\overline{L}}}
\newcommand{\Mbar}{\ensuremath{\overline{M}}}
\newcommand{\Nbar}{\ensuremath{\overline{N}}}
\newcommand{\Obar}{\ensuremath{\overline{O}}}
\newcommand{\Pbar}{\ensuremath{\overline{P}}}
\newcommand{\Qbar}{\ensuremath{\overline{Q}}}
\newcommand{\Rbar}{\ensuremath{\overline{R}}}
\newcommand{\Sbar}{\ensuremath{\overline{S}}}
\newcommand{\Tbar}{\ensuremath{\overline{T}}}
\newcommand{\Ubar}{\ensuremath{\overline{U}}}
\newcommand{\Vbar}{\ensuremath{\overline{V}}}
\newcommand{\Wbar}{\ensuremath{\overline{W}}}
\newcommand{\Xbar}{\ensuremath{\overline{X}}}
\newcommand{\Ybar}{\ensuremath{\overline{Y}}}
\newcommand{\Zbar}{\ensuremath{\overline{Z}}}
\newcommand{\abar}{\ensuremath{\overline{a}}}
\newcommand{\bbar}{\ensuremath{\overline{b}}}
\newcommand{\cbar}{\ensuremath{\overline{c}}}
\newcommand{\dbar}{\ensuremath{\overline{d}}}
\newcommand{\ebar}{\ensuremath{\overline{e}}}
\newcommand{\fbar}{\ensuremath{\overline{f}}}
\newcommand{\gbar}{\ensuremath{\overline{g}}}
%\newcommand{\hbar}{\ensuremath{\overline{h}}} % whoops, \hbar means something else!
\newcommand{\ibar}{\ensuremath{\overline{i}}}
\newcommand{\jbar}{\ensuremath{\overline{j}}}
\newcommand{\kbar}{\ensuremath{\overline{k}}}
\newcommand{\lbar}{\ensuremath{\overline{l}}}
\newcommand{\mbar}{\ensuremath{\overline{m}}}
\newcommand{\nbar}{\ensuremath{\overline{n}}}
%\newcommand{\obar}{\ensuremath{\overline{o}}}
\newcommand{\pbar}{\ensuremath{\overline{p}}}
\newcommand{\qbar}{\ensuremath{\overline{q}}}
\newcommand{\rbar}{\ensuremath{\overline{r}}}
\newcommand{\sbar}{\ensuremath{\overline{s}}}
\newcommand{\tbar}{\ensuremath{\overline{t}}}
\newcommand{\ubar}{\ensuremath{\overline{u}}}
\newcommand{\vbar}{\ensuremath{\overline{v}}}
\newcommand{\wbar}{\ensuremath{\overline{w}}}
\newcommand{\xbar}{\ensuremath{\overline{x}}}
\newcommand{\ybar}{\ensuremath{\overline{y}}}
\newcommand{\zbar}{\ensuremath{\overline{z}}}

% greek with bars
\newcommand{\albar}{\ensuremath{\overline{\alpha}}}
\newcommand{\bebar}{\ensuremath{\overline{\beta}}}
\newcommand{\gmbar}{\ensuremath{\overline{\gamma}}}
\newcommand{\debar}{\ensuremath{\overline{\delta}}}
\newcommand{\phibar}{\ensuremath{\overline{\varphi}}}
\newcommand{\psibar}{\ensuremath{\overline{\psi}}}
\newcommand{\xibar}{\ensuremath{\overline{\xi}}}
\newcommand{\ombar}{\ensuremath{\overline{\omega}}}

% tildes
\newcommand{\Atil}{\ensuremath{\widetilde{A}}}
\newcommand{\Btil}{\ensuremath{\widetilde{B}}}
\newcommand{\Ctil}{\ensuremath{\widetilde{C}}}
\newcommand{\Dtil}{\ensuremath{\widetilde{D}}}
\newcommand{\Etil}{\ensuremath{\widetilde{E}}}
\newcommand{\Ftil}{\ensuremath{\widetilde{F}}}
\newcommand{\Gtil}{\ensuremath{\widetilde{G}}}
\newcommand{\Htil}{\ensuremath{\widetilde{H}}}
\newcommand{\Itil}{\ensuremath{\widetilde{I}}}
\newcommand{\Jtil}{\ensuremath{\widetilde{J}}}
\newcommand{\Ktil}{\ensuremath{\widetilde{K}}}
\newcommand{\Ltil}{\ensuremath{\widetilde{L}}}
\newcommand{\Mtil}{\ensuremath{\widetilde{M}}}
\newcommand{\Ntil}{\ensuremath{\widetilde{N}}}
\newcommand{\Otil}{\ensuremath{\widetilde{O}}}
\newcommand{\Ptil}{\ensuremath{\widetilde{P}}}
\newcommand{\Qtil}{\ensuremath{\widetilde{Q}}}
\newcommand{\Rtil}{\ensuremath{\widetilde{R}}}
\newcommand{\Stil}{\ensuremath{\widetilde{S}}}
\newcommand{\Ttil}{\ensuremath{\widetilde{T}}}
\newcommand{\Util}{\ensuremath{\widetilde{U}}}
\newcommand{\Vtil}{\ensuremath{\widetilde{V}}}
\newcommand{\Wtil}{\ensuremath{\widetilde{W}}}
\newcommand{\Xtil}{\ensuremath{\widetilde{X}}}
\newcommand{\Ytil}{\ensuremath{\widetilde{Y}}}
\newcommand{\Ztil}{\ensuremath{\widetilde{Z}}}
\newcommand{\atil}{\ensuremath{\widetilde{a}}}
\newcommand{\btil}{\ensuremath{\widetilde{b}}}
\newcommand{\ctil}{\ensuremath{\widetilde{c}}}
\newcommand{\dtil}{\ensuremath{\widetilde{d}}}
\newcommand{\etil}{\ensuremath{\widetilde{e}}}
\newcommand{\ftil}{\ensuremath{\widetilde{f}}}
\newcommand{\gtil}{\ensuremath{\widetilde{g}}}
\newcommand{\htil}{\ensuremath{\widetilde{h}}}
\newcommand{\itil}{\ensuremath{\widetilde{i}}}
\newcommand{\jtil}{\ensuremath{\widetilde{j}}}
\newcommand{\ktil}{\ensuremath{\widetilde{k}}}
\newcommand{\ltil}{\ensuremath{\widetilde{l}}}
\newcommand{\mtil}{\ensuremath{\widetilde{m}}}
\newcommand{\ntil}{\ensuremath{\widetilde{n}}}
\newcommand{\otil}{\ensuremath{\widetilde{o}}}
\newcommand{\ptil}{\ensuremath{\widetilde{p}}}
\newcommand{\qtil}{\ensuremath{\widetilde{q}}}
\newcommand{\rtil}{\ensuremath{\widetilde{r}}}
\newcommand{\stil}{\ensuremath{\widetilde{s}}}
\newcommand{\ttil}{\ensuremath{\widetilde{t}}}
\newcommand{\util}{\ensuremath{\widetilde{u}}}
\newcommand{\vtil}{\ensuremath{\widetilde{v}}}
\newcommand{\wtil}{\ensuremath{\widetilde{w}}}
\newcommand{\xtil}{\ensuremath{\widetilde{x}}}
\newcommand{\ytil}{\ensuremath{\widetilde{y}}}
\newcommand{\ztil}{\ensuremath{\widetilde{z}}}

% greek with tildes
\newcommand{\altil}{\ensuremath{\widetilde{\alpha}}}
\newcommand{\betil}{\ensuremath{\widetilde{\beta}}}
\newcommand{\gmtil}{\ensuremath{\widetilde{\gamma}}}
\newcommand{\phitil}{\ensuremath{\widetilde{\varphi}}}
\newcommand{\psitil}{\ensuremath{\widetilde{\psi}}}
\newcommand{\xitil}{\ensuremath{\widetilde{\xi}}}
\newcommand{\omtil}{\ensuremath{\widetilde{\omega}}}

% hats
\newcommand{\Ahat}{\ensuremath{\widehat{A}}}
\newcommand{\Bhat}{\ensuremath{\widehat{B}}}
\newcommand{\Chat}{\ensuremath{\widehat{C}}}
\newcommand{\Dhat}{\ensuremath{\widehat{D}}}
\newcommand{\Ehat}{\ensuremath{\widehat{E}}}
\newcommand{\Fhat}{\ensuremath{\widehat{F}}}
\newcommand{\Ghat}{\ensuremath{\widehat{G}}}
\newcommand{\Hhat}{\ensuremath{\widehat{H}}}
\newcommand{\Ihat}{\ensuremath{\widehat{I}}}
\newcommand{\Jhat}{\ensuremath{\widehat{J}}}
\newcommand{\Khat}{\ensuremath{\widehat{K}}}
\newcommand{\Lhat}{\ensuremath{\widehat{L}}}
\newcommand{\Mhat}{\ensuremath{\widehat{M}}}
\newcommand{\Nhat}{\ensuremath{\widehat{N}}}
\newcommand{\Ohat}{\ensuremath{\widehat{O}}}
\newcommand{\Phat}{\ensuremath{\widehat{P}}}
\newcommand{\Qhat}{\ensuremath{\widehat{Q}}}
\newcommand{\Rhat}{\ensuremath{\widehat{R}}}
\newcommand{\Shat}{\ensuremath{\widehat{S}}}
\newcommand{\That}{\ensuremath{\widehat{T}}}
\newcommand{\Uhat}{\ensuremath{\widehat{U}}}
\newcommand{\Vhat}{\ensuremath{\widehat{V}}}
\newcommand{\What}{\ensuremath{\widehat{W}}}
\newcommand{\Xhat}{\ensuremath{\widehat{X}}}
\newcommand{\Yhat}{\ensuremath{\widehat{Y}}}
\newcommand{\Zhat}{\ensuremath{\widehat{Z}}}
\newcommand{\ahat}{\ensuremath{\widehat{a}}}
\newcommand{\bhat}{\ensuremath{\widehat{b}}}
\newcommand{\chat}{\ensuremath{\widehat{c}}}
\newcommand{\dhat}{\ensuremath{\widehat{d}}}
\newcommand{\ehat}{\ensuremath{\widehat{e}}}
\newcommand{\fhat}{\ensuremath{\widehat{f}}}
\newcommand{\ghat}{\ensuremath{\widehat{g}}}
\newcommand{\hhat}{\ensuremath{\widehat{h}}}
\newcommand{\ihat}{\ensuremath{\widehat{i}}}
\newcommand{\jhat}{\ensuremath{\widehat{j}}}
\newcommand{\khat}{\ensuremath{\widehat{k}}}
\newcommand{\lhat}{\ensuremath{\widehat{l}}}
\newcommand{\mhat}{\ensuremath{\widehat{m}}}
\newcommand{\nhat}{\ensuremath{\widehat{n}}}
\newcommand{\ohat}{\ensuremath{\widehat{o}}}
\newcommand{\phat}{\ensuremath{\widehat{p}}}
\newcommand{\qhat}{\ensuremath{\widehat{q}}}
\newcommand{\rhat}{\ensuremath{\widehat{r}}}
\newcommand{\shat}{\ensuremath{\widehat{s}}}
\newcommand{\that}{\ensuremath{\widehat{t}}}
\newcommand{\uhat}{\ensuremath{\widehat{u}}}
\newcommand{\vhat}{\ensuremath{\widehat{v}}}
\newcommand{\what}{\ensuremath{\widehat{w}}}
\newcommand{\xhat}{\ensuremath{\widehat{x}}}
\newcommand{\yhat}{\ensuremath{\widehat{y}}}
\newcommand{\zhat}{\ensuremath{\widehat{z}}}

% miscellaneous symbols
\newcommand{\del}{\ensuremath{\partial}}
\newcommand{\delbar}{{\ensuremath{\overline{\partial}}}}
\newcommand{\sm}{\wedge}
\newcommand{\dd}[1]{\ensuremath{\frac{\partial}{\partial {#1}}}}
\newcommand{\ten}{\ensuremath{\otimes}}
\newcommand{\bigten}{\bigotimes}
\newcommand{\inv}{^{-1}}
\newcommand{\dual}{^{\vee}}
\newcommand{\hf}{\textstyle\frac{1}{2}}
\newcommand{\thrd}{\textstyle\frac{1}{3}}
\newcommand{\qtr}{\textstyle\frac{1}{4}}
\newcommand{\meet}{\wedge}
\newcommand{\join}{\vee}

% some operators
\newcommand{\Id}{\ensuremath{\operatorname{Id}}}
\newcommand{\id}{\ensuremath{\operatorname{id}}}
\newcommand{\im}{\ensuremath{\operatorname{im}}}
\newcommand{\Hom}{\ensuremath{\operatorname{Hom}}}
\newcommand{\Spec}{\ensuremath{\operatorname{Spec}}}
\newcommand{\Ho}{\ensuremath{\operatorname{Ho}}}
\newcommand{\lan}{\ensuremath{\operatorname{Lan}}}
\newcommand{\ran}{\ensuremath{\operatorname{Ran}}}
\newcommand{\colim}{\ensuremath{\operatorname{colim}}}
\newcommand{\Aut}{\ensuremath{\operatorname{Aut}}}
\newcommand{\AUT}{\ensuremath{\operatorname{AUT}}}
\newcommand{\End}{\ensuremath{\operatorname{End}}}
\newcommand{\Map}{\ensuremath{\operatorname{Map}}}
\newcommand{\Tot}{\ensuremath{\operatorname{Tot}}}
\newcommand{\cosk}{\ensuremath{\operatorname{cosk}}}
\newcommand{\sk}{\ensuremath{\operatorname{sk}}}
\newcommand{\coeq}{\ensuremath{\operatorname{coeq}}}
\newcommand{\eq}{\ensuremath{\operatorname{eq}}}


% arrows and categorical symbols
\newcommand{\dn}{\downarrow}
\newcommand{\op}{\ensuremath{^{\mathit{op}}}}
\newcommand{\co}{\ensuremath{^{\mathit{co}}}}
\newcommand{\coop}{\ensuremath{^{\mathit{coop}}}}
\newcommand{\adj}{\dashv}
\newcommand{\Adj}{\;\dashv\;}
\newdir{ >}{{}*!/-10pt/@{>}}
\newcommand{\iso}{\cong}
\newcommand{\eqv}{\simeq}
\newcommand{\cng}{\equiv}
% \to already exists
\newcommand{\too}[1][]{\ensuremath{\overset{#1}{\longrightarrow}}}
\newcommand{\oot}[1][]{\ensuremath{\overset{#1}{\longleftarrow}}}
\newcommand{\ot}{\ensuremath{\leftarrow}}
\newcommand{\toot}{\ensuremath{\rightleftarrows}}
\newcommand{\otto}{\ensuremath{\leftrightarrows}}
\newcommand{\Impl}{\ensuremath{\Rightarrow}}
\newcommand{\toto}{\ensuremath{\rightrightarrows}}
\newcommand{\into}{\ensuremath{\hookrightarrow}}
\newcommand{\we}{\ensuremath{\overset{\sim}{\longrightarrow}}}
\newcommand{\leftwe}{\ensuremath{\overset{\sim}{\longleftarrow}}}
\newcommand{\cof}[1][]{\ensuremath{\overset{#1}{\rightarrowtail}}}
\newcommand{\leftcof}[1][]{\ensuremath{\overset{#1}{\leftarrowtail}}}
\newcommand{\mono}{\rightarrowtail}
\newcommand{\epi}[1][]{\ensuremath{\overset{#1}{\twoheadrightarrow}}}
\newcommand{\cohto}{\rightsquigarrow}
\newcommand{\maps}{\colon}
\newcommand{\spam}{\,:\!}

\let\xto\xrightarrow
\let\xot\xleftarrow
\newlength{\htolgth}
\newcommand{\xhto}[1]{\settowidth{\htolgth}{$\xrightarrow{#1}$}%
  \makebox[0pt][l]{\hspace{.5\htolgth}$\shortmid$}\ensuremath{\xrightarrow{#1}}}
\newcommand{\hto}{\makebox[0pt][l]{\hspace{2.3mm}$\shortmid$}\ensuremath{\to}}
\newcommand{\htoo}{\makebox[0pt][l]{\hspace{3.3mm}$\shortmid$}\ensuremath{\longrightarrow}}

% Shadows
\newcommand{\sh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\langle$}\makebox[0mm]{$\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\rangle$}\makebox[0mm]{$\rangle$}}}}
\newcommand{\scriptsh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\scriptstyle\langle$}\makebox[0mm]{$\scriptstyle\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\scriptstyle\rangle$}\makebox[0mm]{$\scriptstyle\rangle$}}}}\newcommand{\bigsh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\big\langle$}\makebox[0mm]{$\big\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\big\rangle$}\makebox[0mm]{$\big\rangle$}}}}
\newcommand{\Bigsh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\Big\langle$}\makebox[0mm]{$\Big\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\Big\rangle$}\makebox[0mm]{$\Big\rangle$}}}}
\newcommand{\biggsh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\bigg\langle$}\makebox[0mm]{$\bigg\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\bigg\rangle$}\makebox[0mm]{$\bigg\rangle$}}}}
\newcommand{\Biggsh}[1]{{\ensuremath{\hspace{1mm}\makebox[-1mm]{$\Bigg\langle$}\makebox[0mm]{$\Bigg\langle$}\hspace{1mm}{#1}\makebox[1mm]{$\Bigg\rangle$}\makebox[0mm]{$\Bigg\rangle$}}}}

% theorem-type environments
\newtheorem{thm}{Theorem}[section]
  \newcommand{\thmautorefname}{Theorem}
\newtheorem{cor}{Corollary}
  \makeatletter\let\c@cor\c@thm\makeatother
  \numberwithin{cor}{section}
  \newcommand{\corautorefname}{Corollary}
\newtheorem{prop}{Proposition}
  \makeatletter\let\c@prop\c@thm\makeatother
  \numberwithin{prop}{section}
  \newcommand{\propautorefname}{Proposition}
\newtheorem{lem}{Lemma}
  \makeatletter\let\c@lem\c@thm\makeatother
  \numberwithin{lem}{section}
  \newcommand{\lemautorefname}{Lemma}
\newtheorem{sch}{Scholium}
  \makeatletter\let\c@sch\c@thm\makeatother
  \numberwithin{sch}{section}
  \newcommand{\schautorefname}{Scholium}
\newtheorem{assume}{Assumption}
  \makeatletter\let\c@assume\c@thm\makeatother
  \numberwithin{assume}{section}
  \newcommand{\assumeautorefname}{Assumption}
\newtheorem{claim}{Claim}
  \makeatletter\let\c@claim\c@thm\makeatother
  \numberwithin{claim}{section}
  \newcommand{\claimautorefname}{Claim}
\newtheorem{conj}{Conjecture}
  \makeatletter\let\c@conj\c@thm\makeatother
  \numberwithin{conj}{section}
  \newcommand{\conjautorefname}{Conjecture}
\newtheorem{hyp}{Hypothesis}
  \makeatletter\let\c@hyp\c@thm\makeatother
  \numberwithin{hyp}{section}
  \newcommand{\hypautorefname}{Hypothesis}
\newtheorem{fact}{Fact}
  \makeatletter\let\c@fact\c@thm\makeatother
  \numberwithin{fact}{section}
  \newcommand{\factautorefname}{Fact}
\theoremstyle{definition}
\newtheorem{defn}{Definition}
  \makeatletter\let\c@defn\c@thm\makeatother
  \numberwithin{defn}{section}
  \newcommand{\defnautorefname}{Definition}
\newtheorem{notn}{Notation}
  \makeatletter\let\c@notn\c@thm\makeatother
  \numberwithin{notn}{section}
  \newcommand{\notnautorefname}{Notation}
\theoremstyle{remark}
\newtheorem{rmk}{Remark}
  \makeatletter\let\c@rmk\c@thm\makeatother
  \numberwithin{rmk}{section}
  \newcommand{\rmkautorefname}{Remark}
\newtheorem{eg}{Example}
  \makeatletter\let\c@eg\c@thm\makeatother
  \numberwithin{eg}{section}
  \newcommand{\egautorefname}{Example}
\newtheorem{egs}{Examples}
  \makeatletter\let\c@egs\c@thm\makeatother
  \numberwithin{egs}{section}
  \newcommand{\egsnautorefname}{Examples}
\newtheorem{ex}{Exercise}
  \makeatletter\let\c@ex\c@thm\makeatother
  \numberwithin{ex}{section}
  \newcommand{\exautorefname}{Exercise}
\newtheorem{ceg}{Counterexample}
  \makeatletter\let\c@ceg\c@thm\makeatother
  \numberwithin{ceg}{section}
  \newcommand{\cegautorefname}{Counterexample}

% Number numbered lists as (i), (ii), ...
\renewcommand{\theenumi}{(\roman{enumi})}
\renewcommand{\labelenumi}{\theenumi}

% Labeling that keeps track of theorem-type names (superseded by hyperref)
% \makeatletter
% \ifx\SK@label\undefined\let\SK@label\label\fi
% \let\your@thm\@thm
% \def\@thm#1#2#3{\gdef\currthmtype{#3}\your@thm{#1}{#2}{#3}}
% \def\xlabel#1{{\let\your@currentlabel\@currentlabel\def\@currentlabel
% {\currthmtype~\your@currentlabel}
% \SK@label{#1@}}\label{#1}}
% \def\xref#1{\ref{#1@}}

% Number formulas with the theorem counter
%\makeatletter
%\let\c@equation\c@thm
%\makeatother
%\numberwithin{equation}{section}

% Greek letters outside $$
\makeatletter
\def\alwaysmath#1{\expandafter\expandafter\expandafter\global\expandafter\expandafter\expandafter\let\expandafter\expandafter\csname your@#1\endcsname\csname #1\endcsname
  \expandafter\def\csname #1\endcsname{\ensuremath{\csname your@#1\endcsname}}}
\alwaysmath{alpha}
\alwaysmath{beta}
\alwaysmath{gamma}
\alwaysmath{Gamma}
\alwaysmath{delta}
\alwaysmath{Delta}
\alwaysmath{epsilon}
\newcommand{\ep}{\ensuremath{\varepsilon}}
\alwaysmath{zeta}
\alwaysmath{eta}
\alwaysmath{theta}
\alwaysmath{Theta}
\alwaysmath{iota}
\alwaysmath{kappa}
\alwaysmath{lambda}
\alwaysmath{Lambda}
\alwaysmath{mu}
\alwaysmath{nu}
\alwaysmath{xi}
\alwaysmath{pi}
\alwaysmath{rho}
\alwaysmath{sigma}
\alwaysmath{Sigma}
\alwaysmath{tau}
\alwaysmath{upsilon}
\alwaysmath{Upsilon}
\alwaysmath{phi}
\alwaysmath{Phi}
\newcommand{\ph}{\ensuremath{\varphi}}
\alwaysmath{chi}
\alwaysmath{psi}
\alwaysmath{Psi}
\alwaysmath{omega}
\alwaysmath{Omega}
\alwaysmath{ell}
\alwaysmath{infty}
\makeatother

\let\al\alpha
\let\be\beta
\let\gm\gamma
\let\Gm\Gamma
\let\de\delta
\let\De\Delta
\let\si\sigma
\let\Si\Sigma
\let\om\omega
\let\ka\kappa
\let\la\lambda
\let\La\Lambda
\let\ze\zeta
\let\th\theta
\let\Th\Theta

%% Include or exclude solutions
% This code is basically copied from version.sty, except that when the
% solutions are included, we put them in a `proof' environment as
% well.  To include solutions, say \includesolutions; to exclude them
% say \excludesolutions.
% \begingroup
% \makeatletter
% \catcode`{=12\relax\catcode`}=12\relax%
% \catcode`(=1\relax \catcode`)=2\relax%
% \gdef\includesolutions(\newenvironment(soln)(\begin(proof)[Solution])(\end(proof)))%
% \gdef\excludesolutions(%
%   \gdef\soln(\@bsphack\catcode`{=12\relax\catcode`}=12\relax\soln@NOTE)%
%   \long\gdef\soln@NOTE##1\end{soln}(\solnEND@NOTE)%
%   \gdef\solnEND@NOTE(\@esphack\end(soln))%
% )%
% \endgroup
