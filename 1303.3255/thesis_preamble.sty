\usepackage{etoolbox}

\usepackage{varwidth}

\usepackage{amsmath,mathrsfs,amsthm}
\usepackage{amssymb,latexsym}
% \usepackage{eulervm}
\usepackage[all,pdf]{xy}
\usepackage{import}

%\usepackage{multirow}% http://ctan.org/pkg/multirow

\hypersetup{ unicode = true }
\input{THESIS_shortcuts}

\title{Sheaves, Cosheaves and Applications}
\author{Justin Michael Curry}
\adviser{Robert W. Ghrist}
\advisertitle{Andrea Mitchell University Professor \\ Professor of Mathematics \\ Professor of Electrical and Systems Engineering}
\university{The University of Pennsylvania}
% \acknowledgements{\input{acknowledgements.tex}}
% \dedication{Something here}
\department{Mathematics}
\colophon{}
\gradchair{David Harbater}
\gradchairtitle{Christopher H. Browne Distinguished Professor \\
Professor of Mathematics}
\committee{Robert Ghrist, Andrea Mitchell University Professor of Mathematics \\
Robert MacPherson, Hermann Weyl Professor of Mathematics\\
Tony Pantev, Professor of Mathematics}

\abstract{This thesis develops the theory of sheaves and cosheaves with an eye towards applications in science and engineering. To provide a theory that is computable, we focus on a combinatorial version of sheaves and cosheaves called \textbf{cellular sheaves and cosheaves}, which are finite families of vector spaces and maps parametrized by a cell complex. We develop cellular (co)sheaves as a new tool for topological data analysis, network coding and sensor networks. We utilize the barcode descriptor from persistent homology to interpret cellular cosheaf homology in terms of Borel-Moore homology of the barcode. We associate barcodes to network coding sheaves and prove a duality theorem there. A new approach to multi-modal sensing is introduced, where sheaves and cosheaves model detection and evasion sets. A foundation for multi-dimensional level-set persistent homology is laid via constructible cosheaves, which are equivalent to representations of MacPherson's entrance path category. By proving a van Kampen theorem, we give a direct proof of this equivalence. A cosheaf version of the $i^\mathrm{th}$ derived pushforward of the constant sheaf along a definable map is constructed directly as a representation of this category. We go on to clarify the relationship of cellular sheaves to cosheaves by providing a \emph{formula} that takes a cellular sheaf and produces a complex of cellular cosheaves. This formula lifts to a derived equivalence, which in turn recovers Verdier duality. Compactly-supported sheaf cohomology is expressed as the coend with the image of the constant sheaf through this equivalence. The equivalence is further used to establish relations between sheaf cohomology and a herein newly introduced theory of \emph{cellular sheaf homology}. Inspired to provide fast algorithms for persistence, we prove that the derived category of cellular sheaves over a 1D cell complex is equivalent to a category of graded sheaves. Finally, we introduce the interleaving distance as an extended metric on the category of sheaves. We prove that global sections partition the space of sheaves into connected components. We conclude with an investigation into the geometry of the space of constructible sheaves over the real line, which we relate to the bottleneck distance in persistence.}

\dedication{Dedicated to Michael Loyd Curry}

\preface{The motivation behind this thesis is that sheaves are useful for science and engineering applications. In their most impressionistic form, sheaves are nothing more than a way of tethering data to a space. Passing messages over a network, gathering intelligence in temporal or spatial domains, and characterizing the shape of data as a function of parameter value are all applications where the theory of sheaves and cosheaves are well-adapted. There are hopefully many other, yet to be discovered, applications of sheaves that are waiting for the right person to come along and flesh them out. However, the author is of the opinion that applied sheaf theory must confront three issues:
\vspace{0.75\baselineskip}
\begin{description}
\item[Foundations] for technology transfer and communication: The standard formulations of sheaves and derived functors are difficult to communicate to researchers outside of ``pure'' mathematics. Simpler, alternative descriptions of the sheaves and cosheaves must be presented in an easily accessed format.
\item[Computations] in practice, on a computer, and theoretically: Any application of sheaf theory must be programmable on a computer in an efficient manner.
\item[Perturbations] by noise and approximation: Any technique for modeling the world must be able to account for noise. Being able to test or reject hypotheses formed in a model is essential for interfacing with data from experiments.
\end{description}
In addition to making a first pass at applications of sheaf theory to topological data analysis (TDA) in Chapter~\ref{sec:barcodes}, network coding in Chapter~\ref{sec:nc_coding} and sensor networks in Chapter~\ref{sec:sensors}, this thesis addresses the above three issues.

A great deal of hard work has already been done to address the first two issues. Combinatorial descriptions of sheaves have been discovered independently by Masaki Kashiwara~\cite{kash-rh}, Robert MacPherson and Christopher Zeeman~\cite{dihom_1}. The notion of a cellular sheaf, developed by Allen Shepard~\cite{shepard} under MacPherson's direction, requires only linear algebra to understand: given a cell complex, a cellular sheaf consists of a choice of vector space for each cell and a choice of linear map from each cell to each of its cofaces, compatible with composition. This notion of a sheaf is easily programmable on a computer, as is its cohomology, which can be further simplified via discrete Morse theory~\cite{DMT_sheaves}. Unfortunately, Shepard's thesis was never published and the other contributions of Kashiwara and Zeeman overshadowed these modest-looking discoveries; they were developed no further. 

In this thesis we attempt to revive the theory of cellular sheaves by developing them for applications and embedding them into a larger mathematical context as well. Although Shepard never explained this, cellular sheaves are actual sheaves when viewed through the Alexandrov topology, as we explain in Chapter~\ref{sec:cell_sheaves}. This perspective emphasizes the view that cellular sheaves are functors from the face-relation poset. The relationship between functors modeled on posets to sheaves has been explored in many works~\cite{baclawski1975whitney,yuzvinsky1981linear,yanagawa2001sheaves,brun2007cohomology,sl-dereq} as well as many others. Cellular sheaves can also be viewed as a special instance of constructible sheaves, which are equivalent to representations of MacPherson's exit path category~\cite{treumann-stacks}, which we develop in its cosheaf version in Chapter~\ref{subsec:strat} for the first time. To connect these perspectives to a more standard presentation of sheaves, we explain the general theory of sheaves familiar to most mathematicians in Chapter~\ref{sec:abstract_sheaves}. The length of the thesis is in part due to the fact that it attempts to speak in multiple languages to multiple specialists and non-specialists alike.

The use of cosheaves is initially motivated for one simple reason: homology. The applied topology community has made headway into convincing scientists that homology is a useful bit of linear algebra. One can visualize circles in data~\cite{carlsson2009topology} or holes in sensor networks~\cite{de2006coordinate} and nod when the theory agrees, however cohomology is the theory best suited to sheaves and it is not easily visualized in the absence of Poincar\'e duality. To continue to use homology when speaking to researchers in other fields, one must work with \emph{cosheaves} instead. However, cosheaves have gained prominence in current research mathematics as well. Costello and Gwilliam's work on factorization algebras in quantum field theory~\cite{costellofactorization}; Lurie and Salvatore's work on nonabelian Poincar\'e duality; Ayala, Francis and Tanaka's work on factorization homology and manifold calculus~\cite{ayala-ssm}; have all made use of variations on cosheaves. Consequently, setting down a general theory for cosheaves seemed to be well-timed. This thesis provides a proof of the existence of cosheafification for $\Vect$-valued pre-cosheaves, which is non-obvious since cofiltered limits and finite limits do not commute in $
\Vect$; one cannot simply dualize a pre-cosheaf into a pre-sheaf and use Grothendieck's sheafification procedure in the opposite category. Fortunately, cellular cosheaves never need to be cosheafified because of their strong finiteness properties. To clarify their relationship with Shepard's theory, we prove that cellular sheaves and cosheaves are derived equivalent in Chapter~\ref{sec:duality}. There is another deeper reason why cosheaves should be studied, which is explained in Chapter~\ref{sec:valuations}. Just as tensors take in vectors and spit out numbers, cosheaves act on sheaves and produce vector spaces.

Theoretical computability is one of sheaf theory's greatest strengths. The gluing axiom provides a form of algorithmic compression: if one wants to query the data lying over a large space, it suffices to pass to a cover, compute each piece separately and then glue together the results via a limit (kernel of a matrix). Indeed, the classic Mayer-Vietoris long exact sequence can be viewed as a special case of cellular sheaf cohomology, as Section~\ref{subsec:local-to-global} explains. Unfortunately, for higher-order stitching together of data, a spectral sequence is required, where Leray differentials frustrate the compression of data offered by sheaves and cohomology. In Chapter~\ref{sec:graded} we prove in a precise sense that these differentials can be ignored when working over graphs.

The thesis concludes with a first attack on developing a perturbation theory for sheaves. By borrowing the idea of interleavings~\cite{chazal2009proximity}, in Chapter~\ref{sec:metric} we introduce an extended metric on the category of sheaves over a metric space. Using this metric we can prove that the assignment from maps $f:Y\to X$ to sheaves $f_*k_Y$ is 1-Lipschitz in these metrics. The broader problem of developing a theory of statistics for sheaves is wide open.
}
\prefacename{Preface}

\acknowledgements{
At the current moment in time, a PhD is the highest academic degree awarded in the United States. As such, this thesis reflects over two decades of formal education and schooling across multiple institutions. It also reflects the author's life experience to date, which is formed in many informal and non-academic ways. Accounting for all of these influences and giving credit where credit is due is an impossible task; however, I would like to take some time to thank the many hands which helped this thesis come to be. Given the public nature of this document, I will not always name names, but I will make clear the contributions of my colleagues and teachers.

First and foremost I must thank my parents for bringing me into the world. While my father was in the Navy, my mother had the strongest influence on my education. Instilling a love of reading is, besides giving me life itself, the greatest gift she has given to me. I remember distinctly being told that, given our socio-economic status, receiving a scholarship was the only way I would make it to a university one day, and that reading would take me there. My sense of reverence for reading, among other things, is entirely due to my mother. In contrast, my father engaged me in philosophical dialog at a young age, which is how I gained my first experience with critical thinking. He was never much of a reader; he preferred to sort things out for himself. My entire family --- aunts, uncles, cousins and grandparents included --- have supported me every step of the way and they know I owe them a great deal.

If anyone thinks that obtaining a PhD comes after an endless stream of successes, they are mistaken. I failed many times, and fortunately I was given many second chances. The educators in the Virginia Beach public school system gave me my first second chance by letting me retake a placement exam for the gifted and talented program. Mr. Ausberry, at Thomas Harrison Middle School, requested that I be accelerated a year in mathematics. Mr. Frutuozo made being a scientist seem fashionable, by being a rock star himself. At Harrisonburg High School, I had many excellent instructors, but I felt the strongest direction and guidance from Henry Buhl, Myron Blosser, Andrew Jackson, Patrick Lintner and David Loughran. Without these hardworking and underpaid teachers, I don't think I would have gotten to go to MIT.

Attending MIT as an undergrad was one of the most formative experiences of my life. It certainly tested and broke the mental toughness that I thought I had. Sitting as a freshman in Denis Auroux's 18.100B and getting my first taste of point-set topology was like stepping in to another dimension. It was too much, too fast, and for a moment I thought that the gate of mathematics was closed to me. Gerald Sussman helped steer me back towards mathematics by preaching the value of the MIT quadrivium: logic/programming, analysis, algebra, geometry, topology, relativity and quantum mechanics. Haynes Miller gave me my second second chance by overlooking my shabby mathematical preparation and letting me study for the Part 1B tripos at Churchill College, as part of the Cambridge-MIT exchange program. Cambridge exposed me to one of the greatest mathematical cultures to ever exist. The integrated nature of the classes and the year-long preparation for the tripos helped me gain independence and synthesize my lessons into a unified whole. It was in the Churchill buttery, where Part II and III students waxed poetic about Riemann surfaces and topoi before I even knew what a ring was, that I decided I had to pursue mathematics for graduate school. Returning to MIT, Haynes exposed me to even more advanced mathematics through summer projects and an IAP project with Aliaa Barakat on integrable systems. Working with Aliaa and, later, Victor Guillemin gave me lots of practice with writing mathematics. All of this has served me well for graduate school.

The University of Pennsylvania appealed to my theory-building nature, but it was having to retake the preliminary exams that helped me become a better problem-solver. While drudging through the \emph{Berkeley Problems in Mathematics}~\cite{de2004berkeley} book, my classes gave me something to look forward to. Tony Pantev made the first-year algebra sequence geometric for me, by introducing us to the Serre-Swan correspondence, categories, simplicial sets, spectra and sheaves. Jonathan Block balanced the algebraic and the geometric in Penn's lengthy topology sequence and introduced us to ``Brave New Algebra.'' The graduate student body at Penn helped contextualize my mathematical lessons, while my roommate, Elaine So, gave me lessons in how to be a better human.

My advisor, Robert Ghrist, believed in me when I did not believe in myself. He taught me to have good taste in mathematics and introduced me to Morse theory, Euler calculus, integral geometry and much more. When I first became his student, the idea that no mathematical object is too abstract to be incarnate resonated deeply with me then, as it does today. Rob outlined a beautiful vision for applied mathematics and worked very hard to realize his ambitious plan. By bringing Yasu Hiraoka, Sanjeevi Krishnan, David Lipsky, Michael Robinson and Radmila Sazdanovic together, Rob augmented my graduate training in profound ways. Given this investment, Rob was extremely generous to let me wander geographically and intellectually. Because of him and Penn's Exchange Scholar program, I was able to live in Princeton for the last few years of my graduate career.

At Princeton, I approached Bob MacPherson in person, who luckily was thinking about applied sheaf theory because of my advisor and Amit Patel, and he agreed to organize a seminar at the Institute for Advanced Study. Listening and watching Bob lecture was like getting to peer through a telescope into the far reaches of the mathematical kingdom. The attendees of this seminar were a motley crew of thinkers and Bob was our shepherd. Bob never said more than was necessary, never wanted his own perspective or understanding to crowd out a newly forming one, and did his best to cultivate each individual's diverse set of mental connections, life experiences and accompanying insights.

Many people helped me directly and indirectly while finishing my thesis. Mark Goresky taught me the subtleties of stratification theory, set a high standard for mathematical precision and was enthusiastic and supportive of all my efforts. David Treumann and Jon Woolf both clarified details concerning this work via email. Greg Henselman, Sefi Ladkani, Michael Lesnick, and Jim McClure all provided editorial comments on early drafts of this thesis. Vin de Silva, Matthew Kahle, Dmitriy Morozov, Vidit Nanda, Primoz Skraba and Mikael Vejdemo-Johansson all provided moral support. Ryan and Cate Hodgen kept me sane during my frequent trips to Virginia, where I helped my Dad through the painful process of fighting, and losing to, bladder cancer. My fianc\'ee, Sasha Rahlin, encouraged me to pursue a math major when we first started dating as sophomores, made my junior year abroad doubly wonderful, navigated the stressful two-body aspect of picking a graduate school as a senior, helped me through all of the ups and downs of graduate school along with losing my father, and continues to dazzle me with her focus, drive, beauty and brains. You and Simone are the best.
}

\makeindex
