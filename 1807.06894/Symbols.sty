% Мои символы и значки

%%%%%%%%%%%%% D:\Books\Tex\Primed style.pdf %%%%%
%% оригинальный код Taco Haekwater'a:
%\newdimen\savedrulethickness% фиктивный \overline, чтобы понизить индекс
%\def\docramped#1#2{\savedrulethickness=\fontdimen8\textfont3
%	\hbox{$\m@th\fontdimen8\textfont3=0pt#1\overline{#2}$}
%	\fontdimen8\textfont3\savedrulethickness}
%% Баг, если \cramp попадает в \scriptscriptstyle... Черта над символом
%% Заменить здесь \overline -> \radical0 и черта исчезнет
%\def\cramp{\mathpalette\docramped}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\RequirePackage{graphicx,relsize}
\def\RSsmallest{4pt} % равномерное уменьшение при 10/11/12pt:
\providecommand{\Larger}[2][1]{\hbox{\larger[#1]$#2$}}% relsize Ok
% \cramp заставляет располагаться штрихи и верхние индексы ниже
% Скобки не трогать! Остроумное решение!!
\def\cramp#1{\kern-\nulldelimiterspace\radical0{#1}{}}
\def\@ifprime#1{\@ifnextchar'{\@firstoftwo{#1}}}
%
\def\wp{\@ifprime\wp@i\wp@}
\def\wp@{\mathchar"17D}
\def\wp@i{\@ifprime{\cramp{\mathchar"17D'\mkern-2mu'}}%
	{\cramp{\mathchar"17D'}}}

\def\omega{\@ifprime\omega@i\omega@}
\def\omega@{\mathchar"121}
\def\omega@i{\@ifprime{\cramp{\mathchar"121'\mkern-2mu'}}%
	{\cramp{\mathchar"121'}}}

\def\eta{\@ifprime\eta@i\eta@}
\def\eta@{\mathchar"111}
\def\eta@i{\@ifprime{\cramp{\mathchar"111'\mkern-2mu'}}%
	{\cramp{\mathchar"111'}}}

\def\e{\@ifprime\e@i\e@}
\def\e@{e}
\def\e@i{\@ifprime{\cramp{e'\mkern-2mu'}}{\cramp{e'}}}

\def\@ifhat#1{\@ifnextchar^{\@firstoftwo{#1}}}
% 1.27ex, 0.38 найдено подбором на 10,11,12pt
\def\g#1{g_{\vbox to1.27ex{}#1}\@ifhat{\hspace{-0.38em}^}{}}

% Создать аналогичную конструкцию для \scr P... т.е. со сдвигом влево
% нижнего индекса, если он есть и "ничего не делать", если его нет.
% Это нужно для символов типа \scr M, \scr P, \scr A и т.д.

%\def\ep  {\cramp{e'}}
%\def\epp {\cramp{e'\mkern-2mu'}}
%\def\etap{\cramp{\eta'}}
%\def\etapp{\cramp{\eta'\mkern-2mu'}}

\def\I{{\textbf{\textsc{I}}}}
\def\II{{\textbf{\textsc{I\kern -0.15em I}}}}
\def\IV{{\textbf{\textsc{I\kern -0.2em V}}}}
\def\III{{\textbf{\textsc{I\kern -0.17em I\kern -0.17em I}}}}
\def\IIIab{\III\!\raise0.2ex\hbox{$\smallmatrix
\alpha\\[-0.1ex]\varrho\endsmallmatrix$}\kern-0.1em}

\newcommand{\Dtheta   }[1][1]{{\displaystyle\theta{\vbox to1.2ex{}}'
\nobreak{}_{\mkern-7.5mu#1}}\mkern-1.5mu{\vbox to1.2ex{}}\relax}
\newcommand{\Dvartheta}[1][1]{{\displaystyle\vartheta{\vbox to1.2ex{}}'
\nobreak{}_{\mkern-7.5mu#1}}\mkern-1.5mu{\vbox to1.2ex{}}\relax}

% Улучшенные пределы у знака суммы:
% верхний - не слишком высоко, нижний - не низко
\def\Sum#1#2{\sum_{\raise0.2ex\hbox{\smash[t]{$\scriptstyle#1$}}}^
{\raise-0.2ex\hbox{\smash[b]{$\scriptstyle#2$}}}}

% Характеристики для theta-функций: 10,11,12pt Computer Modern
% ! настроено при \usepackage{amsmath} независимо от ams|art|sty
\newcommand{\AB}[2]{\nobreak\mkern-1mu
\raise0.12ex\hbox{\relscale{0.8}\renewcommand{\arraystretch}{0.42}%
\raise0.16ex\hbox{$\big[$}%
$\m@th\array{@{}c@{}}\scriptstyle#1\\\scriptstyle#2\endarray$%
\raise0.16ex\hbox{$\big]$}}\mkern-1mu\relax}

\def\Int{% Знак интеграла в прямом начертании. Работает с пределами
\mathop{\mathchoice% переделать далее через savebox
{\makebox[0.2\width]{\rotatebox[origin=cc]{16}{$\displaystyle\int$}}}
{\mathop{\vcenter{\Larger{\makebox[0.2\width]% не слишком маленький в тексте
	{\rotatebox[origin=cc]{16}{$\textstyle\int$}}}}}}
{\makebox[0.2\width]{\rotatebox[origin=cc]{16}{$\scriptstyle\int$}}}
{\makebox[0.2\width]{\rotatebox[origin=cc]{16}{$\scriptscriptstyle\int$}}}
}}

% Хорошие настройки 10,11,12pt. Так как как символы подняты, чтобы не
% выглядеть слишком высокими, нужен вертикальный \scale.
% В будущем: расширить с учетом \mathchoice{D}{T}{S}{SS}
% \vpsi, \vphi прекрасно обрабатываются \skew4\dot, \ddot, \dddot ..
% ширина \vpsi = \psi (точно!); но ширина \vphi > \varphi из-за нижней черты

% а также: сделать \raise на величину \Depth.
% Ее предварительно вычислить.
\def\ssb@#1#2{\lower0.#1ex\hbox{$\scriptscriptstyle\bo-$}\kern#2em}

\def\vphi@{\raise0.453ex\hbox{\scalebox{1}[0.9]{$\varphi$}}}
\def\vpsi@{\raise0.427ex\hbox{\scalebox{1}[0.9]{$\psi$}}}
\def\vphi@@#1#2{\smash[b]{\ssb@{#1}{#2}\vphi@}}
\def\vpsi@@#1#2{\smash[b]{\hbox{\vpsi@\llap{\ssb@{#1}{#2}}}}}

\ifnum     \@ptsize=0\def\vphi{\vphi@@{242}{-0.502}}
										 \def\vpsi{\vpsi@@{242}{ 0.125}}
\else\ifnum\@ptsize=1\def\vphi{\vphi@@{221}{-0.478}}
										 \def\vpsi{\vpsi@@{221}{ 0.153}}
\else\ifnum\@ptsize=2\def\vphi{\vphi@@{202}{-0.453}}
										 \def\vpsi{\vpsi@@{202}{ 0.177}}
\fi\fi\fi

% простое решение проблемы \widehat{\boldsymbol{\mathfrak{...

% \mathaccent"0362{буква} широкая шляпка

% используемый ниже \mathop не запрашивает amsmath
\def\tg{\mathop{\operator@font tg}\nolimits}
\def\ctg{\mathop{\operator@font ctg}\nolimits}
\def\ch{\mathop{\operator@font ch}\nolimits}
\def\sh{\mathop{\operator@font sh}\nolimits}
\def\th{\mathop{\operator@font th}\nolimits}
% уменьшить пробел справа от \th ..., ? но скобка справа наоборот дальше
%\def\hh{\mathop{\operator@font th}\nolimits\mathbin{\![2]}}
\def\cth{\mathop{\operator@font cth}\nolimits}
\def\Arccos{\mathop{\operator@font Arc\,\,cos}\nolimits}
\def\Arcsin{\mathop{\operator@font Arc\,\,sin}\nolimits}
\def\Arctg{\mathop{\operator@font Arc\,\,tg}\nolimits}
\def\Arcctg{\mathop{\operator@font Arc\,\,ctg}\nolimits}
\def\Arsh{\mathop{\operator@font Arsh}\nolimits}
\def\Arch{\mathop{\operator@font Arch}\nolimits}
\def\Arth{\mathop{\operator@font Arth}\nolimits}
\def\Arcth{\mathop{\operator@font Arcth}\nolimits}
\def\Arg{\mathop{\operator@font Arg}\nolimits}
\def\Ln{\mathop{\operator@font Ln}\nolimits}
\def\Spur{\mathop{\operator@font Spur}\nolimits}
