%!TEX root = IntroArithGrps.tex

\mychapter{\texorpdfstring{$\rational$}{Q}-Rank} \label{QrankChap}

\prereqs{Real rank and minimal parabolic subgroups (\cref{RrankChap}), and groups defined over~$\rational$ (\cref{DefdQDefn}).}

Algebraically, the definition of real rank extends in a straightforward way to a notion of rank over any field: if $G$ is defined over~$F$, then we can talk about $\rank_F G$. In the study of arithmetic groups, we assume $G$ is defined over~$\rational$, and the corresponding $\rational$-rank is an important invariant of the associated arithmetic group $\Gamma = G_\integer$.

\begingroup \smaller \renewcommand{\baselinestretch}{0.95}
\begin{disclaimer}
The reading of this \lcnamecref{QrankChap} may be postponed without severe consequences (and can even be skipped entirely), because the material here will not arise elsewhere in this book (except marginally) other than in \cref{ReductionChap}, where a coarse fundamental domain for~$\Gamma$ will be constructed. Furthermore, unlike the other chapters in this part of the book, the topic is of importance only for arithmetic groups and closely related subjects, not a broad range of areas of mathematics.
\end{disclaimer}
\par \endgroup

\section{\texorpdfstring{$\rational$}{Q}-rank}

\begin{defn} %[(cf.\ definition of $\real$-split torus in \pref{RsplitDefn})]
Assume $G$ is defined over~$\rational$.
 A closed, connected subgroup~$T$ of~$G$ is a 
 \index{torus!$\rational$-split}%
 \defit[Q-@$\rational$-!split]{$\rational$-split torus} if
 \noprelistbreak
 \begin{itemize}
 \item $T$ is defined over~$\rational$, and
 \item $T$ is diagonalizable over~$\rational$. (That is,
there exists $g \in \GL(\ell,\rational)$, such that $g
T g^{-1}$ consists entirely of diagonal matrices.)
 \end{itemize}
 \end{defn}

\begin{eg} \ 
\noprelistbreak
 \begin{enumerate}
 \item $\SO(1,1)^\circ$ is a $\rational$-split torus, because $g \SO(1,1) g^{-1}$ consists of diagonal matrices if $g =  \begin{Smallbmatrix}
 1 & 1 \\
 1 & -1 
 \end{Smallbmatrix}
 $.
 
\item Although it is obvious that every $\rational$-split torus is an $\real$-split torus, the converse is not true (even if the torus is defined over~$\rational$). For example, let $T = \SO(x^2 - 2y^2; \real)^\circ$. Then $T$ is defined over~$\rational$, and it is $\real$-split (because it is conjugate to $\SO(1,1)^\circ$). However, it is \textbf{not} $\rational$-split. To see this, note that 
 $ \begin{Smallbmatrix}
 3 & 4 \\
 2 & 3 
 \end{Smallbmatrix}
 \in T_{\rational}
 $,
 but the eigenvalues of this matrix are irrational (namely,
$3 \pm 2\sqrt{2}$), so this rational matrix is not
diagonalizable over~$\rational$. 

 \end{enumerate}
\end{eg}

%\begin{prop} \label{TQsplit<>}
% Let $T$ be a torus in $\SL(\ell,\real)$, and assume that
%$T$ is defined over~$\rational$. The following are
%equivalent:
% \begin{enumerate}
% \item \label{TQsplit<>-Qsplit}
% $T$ is $\rational$-split.
% \item \label{TQsplit<>-basisR}
% There is a basis $v_1,\ldots,v_\ell$ of~$\rational^\ell$,
%such that, for every $t \in T$ and every $i \in
%\{1,\ldots,\ell\}$, the vector $v_i$ is an eigenvector
%of~$t$.
% \item \label{TQsplit<>-basisQ}
% There is a basis $v_1,\ldots,v_\ell$ of~$\rational^\ell$,
%such that, for every $t \in T_{\rational}$ and every $i \in
%\{1,\ldots,\ell\}$, the vector $v_i$ is an eigenvector
%of~$t$.
% \item \label{TQsplit<>-eigenval}
% Every eigenvalue of every element of~$T_{\rational}$ is
%rational.
% \end{enumerate}
% \end{prop}
%
%\begin{proof}
% (\ref{TQsplit<>-Qsplit} $\Leftrightarrow$
%\ref{TQsplit<>-basisR}) Diagonalizing a matrix is equivalent
%to finding a basis consisting of eigenvectors.
% 
% (\ref{TQsplit<>-basisR} $\Leftrightarrow$
%\ref{TQsplit<>-basisQ}) One direction is obvious. The other
%follows from the fact that $T_{\rational}$ is dense in~$T$
%\see{QptsDense}.
%
% (\ref{TQsplit<>-Qsplit} $\Rightarrow$
%\ref{TQsplit<>-eigenval}) We may assume $T$ consists of
%diagonal matrices. Then the eigenvalues of any $t \in T$ are
%simply the matrix entries of~$t$. If $t \in T_{\rational}$,
%these matrix entries are rational.
%
% (\ref{TQsplit<>-eigenval} $\Rightarrow$
%\ref{TQsplit<>-basisQ}) If $t \in T_{\rational}$, then, for
%each eigenvalue~$\lambda$ of~$t$, the equation $t x =
%\lambda x$ is a linear equation with rational coefficients,
%so the solution space is spanned by rational vectors. Therefore,
%each eigenspace of~$t$ is spanned by rational vectors.
%Therefore, $t$~is diagonalizable over~$\rational$. Since
%this is true for each $t \in T_{\rational}$, and any set of
%commuting diagonalizable linear transformations can be
%simultaneously diagonalized, we conclude that
%$T_{\rational}$ is diagonalizable over~$\rational$.
% \end{proof}



The following key fact implies that the maximal $\rational$-split tori of~$G$ all have the same dimension (which is called the ``$\rational$-rank''):

\begin{thm}
Assume $G$ is defined over~$\rational$.
If $S_1$ and~$S_2$ are maximal\/ $\rational$-split tori in~$G$, then $S_1 = g S_2 g^{-1}$ for some $g \in G_\rational$.
\end{thm}

\begin{defn}[(for arithmetic lattices)] \label{Qrank-arithmetic}
 Assume
 \noprelistbreak
 	\begin{itemize}
	\item $G$ is defined over~$\rational$, 
	and 
	\item $\Gamma$ is commensurable to $G_{\integer}$. 
	\end{itemize}
Then \defit[Q-@$\rational$-!rank]{$\Qrank \Gamma $}%
	\index{rank!Q-@$\rational$-|indsee{$\rational$-rank}}%
	\nindex{$\Qrank \Gamma $ = $\rational$-rank of~$\Gamma$}
 is the dimension of any maximal $\rational$-split torus in~$G$. 
%(Because all
%maximal $\rational$-split tori are conjugate under
%$G_{\rational}$, this definition is independent of the
%particular torus chosen.)

(More generally, if $\phi \colon G/K \stackrel{\iso}{\to} G'/K'$, where $K$
and~$K'$ are compact, and $\phi(\overline{\Gamma})$ is
commensurable to $\overline{G'_{\integer}}$
\csee{ArithDefn}, then $\Qrank \Gamma$ is the
dimension of any maximal $\rational$-split torus in~$G'$.)
 \end{defn}
 
\begin{egs} \ \label{QrankEg} 
 \noprelistbreak
	 \begin{enumerate}
	 
	 \item \label{QrankEg-SL}
	 $\Qrank \bigl( \SL(n,\integer) \bigr) = n-1$. (Let $S$ be the identity component of the group of all diagonal matrices in $\SL(n,\real)$.)
	
	 \item \label{QrankEg-SOQ}
	 Let $G = \SO(Q; \real)$, where $Q(x_1,\ldots,x_\ell)$
	is some quadratic form on~$\real^\ell$, such that $Q$~is
	defined over~$\rational$. (That is, all of the coefficients
	of~$Q$ are rational.) Then $G$ is defined over~$\rational$,
	and the discussion of \cref{RrankEgs}, with $\rational$
	in place of~$\real$, shows that $\Qrank G_{\integer} $ is
	the maximum dimension of a totally isotropic
	$\rational$-subspace of~$\rational^\ell$. 
	
		\begin{enumerate} \itemsep=\smallskipamount

		\item For example, 
		 \ $\Qrank  \SO(m,n)_{\integer} = \min\{m,n\} $. \ 
		 Similarly,
		 $$ \Qrank  \SU(m,n)_{\integer} 
		 = \Qrank  \Sp(m,n)_{\integer}  = \min\{m,n\} .$$
		 So $\Qrank G_\integer = \Rrank G$ for these groups.
		 
		 \item \label{QrankEg-SOQ-anis}
		 Let $G = \SO(x_1^2 + x_2^2 + x_3^2 - 7 x_4^2; \real)$.
		Then, because the congruence $a^2 + b^2 + c^2 + d^2 \equiv 0
		\pmod{8}$ implies that all the variables are even, it is not difficult
		to see that this quadratic form has no nonzero isotropic vectors in~$\rational^4$ \csee{NoSolQ}. This means $\Qrank G_{\integer}  = 0$.
		
		
		Note, however, that $G$ is isomorphic to $\SO(3,1)$, so its real rank is~$1$. Therefore, $\Qrank G_\integer \neq \Rrank G$.
%			 Since there are quadratic forms that have nontrivial isotropic subspaces over~$\real$, but not over~$\rational$, we may have $\Rrank \SO(Q; \real) \neq \Qrank \SO(Q; \integer)$ 
%
%		 $$ \begin{bmatrix}
%		 \sqrt{7} & 0 & 0 \\
%		 0 & 1 & 0 & 0 \\
%		 0 & 0 & 1 & 0 \\
%		 0 & 0 & 0 & 1
%		 \end{bmatrix}
%		 .$$
%		 We see from \cref{Qrank0<>} below that $G_{\integer}
%		\backslash G$ is compact; therefore, $G_{\integer} \backslash
%		\hyperbolic^3$ is a \emph{compact} hyperbolic 3-manifold,
%		whereas $\SO(1,3)_{\integer} \backslash \hyperbolic^3$ is
%		not compact. Therefore, the Mostow Rigidity Theorem
%		\pref{MostowIrred} implies that $G_{\integer}$ is not
%		isomorphic to $\SO(1,3)_{\integer}$; this is an illustration
%		of the fact that a different embedding of~$G$ in
%		$\SL(\ell,\real)$ can yield very different integer points.
%		(Technical remark: Actually, $G_{\integer} \backslash
%		\hyperbolic^3$ is an \emph{orbifold}. To obtain a (compact)
%		\emph{manifold,} replace $G_{\integer}$ with a torsion-free
%		subgroup of finite index \see{torsionfree}.)
		\end{enumerate}
	
	\item \label{QrankEg-0}
	$\Qrank \Gamma = 0$ if and only if $G/\Gamma$ is compact \csee{Qrank0Ex}.

	\item \label{QrankEg-SUD}
	$\Qrank \SU(B, \tau; \ints_D)$ is the dimension (over~$D$) of a maximal totally isotropic subspace of~$D^n$, if $B$ is a $\tau$-Hermitian form on~$D^n$, and $D$~is a division algebra over~$F$.
	
	 \end{enumerate}
 \end{egs}

\begin{warn} \label{SL2ZinGamma}
 In analogy with \cref{Rrank0<>SL2R} and
\fullcref{GZCocpctIff}{SL2Q}, one might suppose that
$\Qrank \Gamma \neq 0$ if and only if $\Gamma$
contains a subgroup that is isomorphic to
$\SL(2,\integer)$ (modulo finite groups). However, this
is \textbf{false}: \emph{every} lattice in~$G$ contains a
subgroup that is abstractly commensurable to
$\SL(2,\integer)$ (unless $G$ is compact). Namely, the Tits Alternative tells us that $\Gamma$ contains a nonabelian free subgroup \csee{FreeInGamma},
and it is well known that $\SL(2,\integer)$ has a
finite-index subgroup that is free \csee{SanovIsFree}.
 \end{warn}


\begin{rems} \label{QrankRems} \ 
\noprelistbreak
	\begin{enumerate}

	\item The definition of $\Qrank \Gamma$ is somewhat indirect,
because the $\rational$-split tori of~$G$ are not subgroups
of~$\Gamma$. Therefore, it would be more correct to say that
we have defined $\Qrank G_{\rational} $. 

	\item Although different embeddings
of~$G$ in $\SL(\ell,\real)$ can yield maximal $\rational$-split tori of different dimensions, the theory of algebraic groups shows
that the $\rational$-rank is the same for all of the embeddings in
which $\Gamma$ is commensurable to~$G_{\integer}$
\csee{Qrank(isog)=}; therefore, $\Qrank \Gamma$ is well defined
as a function of~$\Gamma$.

	\item We have $0 \le \Qrank \Gamma \le \Rrank G$, since every $\rational$-split torus is $\real$-split. It can be shown that:
		\begin{enumerate}
	
		\item The extreme values are always realized: there exist lattices $\Gamma_0$ and~$\Gamma_r$ in~$G$, such that $\Qrank \Gamma_0 = 0$ and $\Qrank \Gamma_r = \Rrank G$ \csee{GHasCpctLatt,Qrank=Rrank}.
		
		\item \label{QrankRems-gap} 
		In some cases, there are intermediate values 
			%between $0$ and $\Rrank G$ 
		that are not realized. For example, the $\rational$-rank of every lattice in $\SO(2,5)$ is either $0$ or~$2$ \csee{QrankGap}.
		\end{enumerate}
	
	\item Suppose $\Gamma$ is defined by restriction of scalars \pref{ResScal->Latt}, so $\Gamma$ is commensurable to $G'_{\ints}$, where $G'$~is defined over a finite extension~$F$ of~$\rational$, and $\ints$ is the ring of integers of~$F$. Then $\Qrank \Gamma$ is equal to the ``\index{rank!over a field F@over a field~$F$}$F$-rank'' of~$G'$, or, in other words, the maximal dimension (over~$F_\infty$) of a subgroup of~$G'$ that is diagonalizable over~$F$. For example, the $\rational$-rank of  $\SO(B; \ints)$ is the dimension of a maximal totally isotropic $F$-subspace of~$F^n$.

	\end{enumerate}
 \end{rems}


%Similarly, if $G$ is defined over an algebraic number
%field~$F$, then one can define
%$\operatorname{\mbox{\upshape$F$-rank}}(G)$. The following
%result shows that this can be used to calculate the $\rational$-rank
%of a lattice obtained by Restriction of Scalars.
%
%\begin{lem}
% Suppose 
% \begin{itemize}
% \item $F$ is an algebraic number field, 
% \item $\ints$ is the ring of integers of~$F$,
% \item $G$ is
%defined over~$F$ \textup(as an algebraic group
%over~$F_\infty$\textup), and
% \item $\Delta \colon G_F \to \prod_{\sigma \in S^\infty}
%G^\sigma$ is defined by $\Delta(g) = \bigl( \sigma(g)
%\bigr)_{\sigma \in S^\infty}$, as in
%\cref{ResScal->Latt}.
% \end{itemize}
% Then $\Qrank \bigl( \Delta(G_{\ints}) \bigr) =
%\operatorname{\mbox{\upshape$F$-rank}}(G)$.
% \end{lem}
%
%\begin{proof}
% If $T$ is a torus in~$G$, and $T$~is defined over~$F$, then
%$\prod_{\sigma \in S^\infty} T^\sigma$ is a $\rational$-torus
%in $\prod_{\sigma \in S^\infty} G^\sigma$. Conversely, it is
%not difficult to see that any $\rational$-torus of
%$\prod_{\sigma \in S^\infty} G^\sigma$ is contained in a
%torus of the form $\prod_{\sigma \in S^\infty} T^\sigma$.
%Therefore, the desired conclusion follows from the fact, which
%will be proved in \S\ref{DirichletUnitSect}, that
% $$ \Qrank \left( \prod_{\sigma \in S^\infty} T^\sigma
%\right)
% = \operatorname{\mbox{\upshape$F$-rank}}(T) $$
% \see{Qrank(ROS)=Frank(T)}.
% \end{proof}

\Cref{Qrank-arithmetic} applies only to arithmetic lattices, but the Margulis Arithmeticity Theorem \pref{MargulisArith} allows the definition to be extended to all lattices:

\begin{defn}[\csee{QrankWellDefd}] \label{QrankDefn}
 Up to isogeny, and modulo the maximal compact factor of~$G$,
we may write $G = G_1 \times \cdots \times G_s$, so that
$\Gamma_i = \Gamma \cap G_i$ is an irreducible lattice
in~$G_i$ for $i = 1,\ldots,r$ \csee{prodirredlatt}. We let\term[Q-@$\rational$-!rank]{}
 $$ \Qrank(\Gamma) = \Qrank(\Gamma_1) +
\cdots + \Qrank(\Gamma_s) ,$$
 where:
	 \begin{enumerate}
	 \item If $G/\Gamma_i$ is compact, then $\Qrank \Gamma_i  = 0$.
	 \item If $G/\Gamma_i$ is not compact, and $\Rrank G = 1$, then $\Qrank \Gamma_i = 1$.
	 \item If $G/\Gamma_i$ is not compact, and $\Rrank G \ge 2$, then the Margulis Arithmeticity Theorem \pref{MargulisArith} implies that $\Gamma_i$ is
	arithmetic, so \cref{Qrank-arithmetic} applies.
	 \end{enumerate}
 \end{defn}



\begin{exercises}

\item Show that if $T$ is a $\rational$-split torus, then
$T_{\integer}$ is finite.

\item Give an example of a torus~$T$ (that is defined over~$\rational$), such that
$T_{\integer}$ is infinite.

\item Verify the claim in \fullcref{QrankEg}{SOQ} that $\Qrank \SO(Q ; \integer)$ is the dimension of a maximal totally isotropic subspace of~$\rational^\ell$.

\item \label{NoSolQ}
Verify the claim in \fullcref{QrankEg}{SOQ-anis} that $(0,0,0,0)$ is the only solution in~$\rational^4$ of the equation $x_1^2 + x_2^2 + x_3^2 - 7x_4^2 = 0$.

\item \label{Qrank0Ex}
Prove \fullcref{QrankEg}{0}.
\hint{($\Rightarrow$)~See \cref{GZCocpctIff}.
($\Leftarrow$)~If $a$ is diagonalizable over~$\rational$, then there exists $v \in \integer^\ell$, such that $a^n v \to 0$ as $n \to +\infty$, so the Mahler Compactness Criterion \pref{MahlerCpct} implies $G / G_{\integer}$ is not compact.}

\item \label{QrankWellDefd}
Show that \cref{QrankDefn} is consistent with \cref{Qrank-arithmetic}. More precisely, assume $\Gamma$ is arithmetic, and prove:
	 \begin{enumerate}
	 \item $G/\Gamma$ is compact if and only if $\Qrank \Gamma = 0$. 
	 \item If $G/\Gamma$ is not compact, and $\Rrank G = 1$, then $\Qrank \Gamma = 1$. 
%	$\Qrank(\Gamma) \le \Rrank(G) = 1$ \see{Qrank<Rrank}; so we
%	must have $\Qrank(\Gamma) = 1$.
	 \item If $\Gamma = \Gamma_1 \times \Gamma_2$
	is reducible, then $\Qrank \Gamma  = \Qrank \Gamma_1  + \Qrank \Gamma_2$.
%	 \item If $C$ is a compact, normal subgroup of~$G$, and
%	$\overline{\Gamma}$ is the image of~$\Gamma$ in
%	$\overline{G} = G/C$, then $\Qrank(\Gamma) =
%	\Qrank(\overline{\Gamma})$.
	 \end{enumerate}

\item \label{Qrank=Rrank}
Suppose $G$ is classical. Show that, for the natural embeddings
described in \cref{classical-fulllinear,classical-orthogonal}, we have
$\Qrank G_{\integer}  = \Rrank G$.
\hint{\cref{QrankEg}(\ref{QrankEg-SL},\ref{QrankEg-SOQ})).}
\end{exercises}









%\section{Lattices of $\rational$-rank one}
%
%\begin{thm} \label{Qrank1<>}
% The following are equivalent:
% \begin{enumerate}
% \item $\Qrank(\Gamma) \le 1$.
% \item Any two maximal unipotent subgroups of~$\Gamma$ either
%are equal or are disjoint.
% \end{enumerate}
% \end{thm}
%
%
%\begin{thm} \label{Qrank1<>GQ}
% If $\Gamma$ is commensurable to $G_{\integer}$, then the
%following are equivalent:
% \begin{enumerate}
% \item $\Qrank(\Gamma) \le 1$;
% \item If $U_1$ and $U_2$ are unipotent subgroups
%of~$G_{\rational}$, and $U_1 \cap U_2 \neq e$, then $\langle
%U_1,U_2 \rangle$ is unipotent.
% \item Any two maximal unipotent subgroups of~$G_{\rational}$
%either are equal or are disjoint.
% \item  \label{Qrank1<>GQ-unipP}
% If $P_1$ and $P_2$ are parabolic $\rational$-subgroups
%of~$G$, and $\unip P_1 \cap \unip P_2 \neq e$, then $P_1 = P_2$.
% \item All proper parabolic $\rational$-subgroups of~$G$ are
%conjugate to each other \textup(in fact, they are
%conjugate under $G_{\rational}$\textup).
% \end{enumerate}
% \end{thm}
% 
% \begin{exercises}
% 
%\item Show that if $\Qrank(\Gamma) = 1$, and $U_1$ and
%$U_2$ are unipotent subgroups of~$\Gamma$, such that $U_1
%\cap U_2 \neq e$, then $\langle U_1,U_2 \rangle$ is
%unipotent.
%
%\end{exercises}



\section{Lattices of higher \texorpdfstring{$\rational$}{Q}-rank}

This section closely parallels \cref{HigherRrankSect}, because the results there on semisimple groups of higher real rank can be extended in a natural way to lattices of higher $\rational$-rank.

\begin{assump}
Throughout this section, if the statement of a result mentions $G_\rational$, $G_\integer$, or a $\rational$-split torus in~$G$, then $G$ is assumed to be defined over~$\rational$.
\end{assump}

\begin{prop}[\csee{Qrank2<>C(a)gensEx}] \label{Qrank2<>C(a)gens}
Let $S$ be any maximal\/ $\rational$-split torus in~$G$. Then we have
 $\Qrank G_\integer \ge 2$
 if and only if there exist nontrivial elements $s_1$ and~$s_2$ of~$S_\rational$,
such that $G = \langle \czer_G(s_1), \czer_G(s_2)\rangle$.
\end{prop}


\begin{lem} \label{C(A)=AM}
If $S$~is any maximal $\rational$-split torus in~$G$, then we have $\czer_G(S) = S \times M = S \times CL$, where 
	\begin{itemize}
	\item $M$, $C$, and~$L$ are defined over~$\rational$,
	\item $\Qrank M = 0$,
	\item $L$ is semisimple,
	and
	\item $C$ is a torus that is the identity component of the center of~$M$.
	\end{itemize}
\end{lem}

 \begin{prop}[\csee{Qrank2<>au=uaEx}] \label{Qrank2<>au=ua}
 $\Qrank G_\integer \ge 2$ if and only if there exist nontrivial elements $a$ and~$u$ of~$G_\rational$, such that $a$~belongs to a\/ $\rational$-split torus of~$G$, $u$~is unipotent, and $au = ua$.
\end{prop}

\begin{lem}[\csee{Qrank1UniqMaxUnipEx}] \label{Qrank1UniqMaxUnip}
Assume\/ $\Gamma$ is commensurable to~$G_\integer$. The following are equivalent:
	\begin{enumerate}
	\item $\Qrank \Gamma \le 1$.
	\item Every nontrivial unipotent subgroup of\/~$\Gamma$ is contained in a \textbf{unique} maximal unipotent subgroup of\/~$\Gamma$.
	\item Every nontrivial unipotent\/ $\rational$-subgroup of~$G$ is contained in a \textbf{unique} maximal unipotent\/ $\rational$-subgroup of~$G$.
	\end{enumerate}
\end{lem}

\begin{prop} \label{Qrank2<>UnipGens}
$\Qrank \Gamma \ge 2$ if and only if\/ $\Gamma$ contains nontrivial unipotent subgroups $U_1,\ldots,U_k$, such that 
	\begin{itemize}
	\item $\langle U_1,\ldots,U_k \rangle$ is a finite-index subgroup of\/~$\Gamma$,
	and
	\item $U_i$ centralizes~$U_{i+1}$ for each~$i$.
	\end{itemize}
\end{prop}

% It would be good to give an application of unipotent generators or the following theorem @@@

\begin{prop} \label{Qrank2<>SL3orSO23}
Assume\/ $\Gamma$ is irreducible. Then $\Qrank \Gamma \ge 2$ if and only if\/ $\Gamma$~contains a subgroup that is commensurable to either\/ $\SL(3,\integer)$ or\/ $\SO(2,3)_\integer$.
\end{prop}

%\begin{thm} \label{Qrank2<>SL3orSO23}
%Assume $\Gamma$ is irreducible and $\Rrank G \ge 2$. Then:
%	\begin{enumerate}
%	\item $\Qrank \Gamma \ge 2$ if and only if $\Gamma$~contains a subgroup that is commensurable to either\/ $\SL(3,\integer)$ or\/ $\SO(2,3)_\integer$.
%	\item $\Qrank \Gamma \ge 1$ if and only if $\Gamma$~contains a subgroup that is isomorphic to a noncocompact, irreducible, arithmetic lattice in either\/ $\SL(3,\real)$, $\SL(3,\complex)$, or a group of the form $\SL(2,\real)^r \times \SL(2,\complex)^s$, with $r + s \ge 2$. \textup(These ``minimal'' lattices are either unitary groups or special linear groups.\textup)
%	\item If $\Qrank \Gamma = 0$, then $\Gamma$~contains a subgroup that is commensurable to either a special linear group or a unitary group\/ \textup(perhaps over a division algebra\textup).
%	\end{enumerate}
%\end{thm}


\begin{rems} \ 
\noprelistbreak
 \begin{enumerate}

\item Unfortunately, the list of lattices of $\rational$-rank one is longer and much more complicated than the list of simple groups of real rank one in \cref{rank1simple}. The classical arithmetic groups (of any $\rational$-rank) are described in \cref{ArithClassicalChap} (see the \lcnamecref{IrredInG} on \pageref{IrredInG}), but there are also infinitely many different lattices of $\rational$-rank one in exceptional groups of type $E_6$ and~$F_4$, and the nonarithmetic lattices of $\rational$-rank one in $\SO(1,n)$ and $\SU(1,n)$ have not yet been classified.

 \item Suppose $\Qrank \Gamma \le 1$.
\Cref{Qrank2<>UnipGens} shows that it is impossible to
find a generating set $\{\gamma_1,\ldots,\gamma_r\}$
for~$\Gamma$, such that each $\gamma_i$ is nontrivial and
unipotent, and $\gamma_i$ commutes with~$\gamma_{i+1}$, for
each~$i$. However, it is possible, in some cases, to find a
generating set $\{\gamma_1,\ldots,\gamma_r\}$ that has all
of these properties \emph{except} the requirement that
$\gamma_i$~is unipotent. For example, this is easy (up to
finite index) if $\Gamma$~is reducible \csee{RedCommGens}.

 \end{enumerate}
 \end{rems}
 

\begin{exercises}

\item \label{Qrank2<>C(a)gensEx}
	\begin{enumerate}
	\item Prove \cref{Qrank2<>C(a)gens}($\Rightarrow$) for the special case where we have $G_\rational = \SL(3,\rational)$.
	\item Prove \cref{Qrank2<>C(a)gens}($\Leftarrow$).
	\end{enumerate}

\item \label{CentGensGamma1xGamma2Ex}
Prove the following results in the special case where $\Gamma = \Gamma_1 \times \Gamma_2$, and $\Qrank \Gamma_i \ge 1$ for each~$i$.
	\begin{enumerate}
	\item \label{CentGensGamma1xGamma2Ex-C(a)}
	\cref{Qrank2<>C(a)gens}($\Rightarrow$)
	\item \cref{Qrank2<>au=ua}($\Rightarrow$)
	\item \cref{Qrank1UniqMaxUnip}($\Leftarrow$)
	\item \cref{Qrank2<>UnipGens}($\Rightarrow$)
	\end{enumerate}

\item \label{Qrank2<>au=uaEx}
	\begin{enumerate}
	\item Prove \cref{Qrank2<>au=ua}($\Rightarrow$) in the special case where we have $G_\rational = \SL(3,\rational)$.
	\item \label{Qrank2<>au=uaEx-not1}
	Prove \cref{Qrank2<>au=ua}($\Leftarrow$).
%	\hint{\cref{ZarAandCent}.}
	\end{enumerate}

\item \label{Qrank1UniqMaxUnipEx}
For each of these groups, find a nontrivial unipotent subgroup that is contained in two different maximal unipotent subgroups.
	\begin{enumerate}
	\item $\SL(3,\rational)$.
	\item $\SL(3,\integer)$.
	\end{enumerate}

\item \label{Qrank2<>UnipGensEx}
Prove \cref{Qrank2<>UnipGens}.

\item (\emph{Assumes the theory of $\rational$-roots})
Prove the general case of the following results.
	\begin{enumerate}
	\item \cref{Qrank2<>C(a)gens}.
	\item \cref{C(A)=AM}.
	\item \cref{Qrank2<>au=ua}($\Rightarrow$).
	\item \cref{Qrank1UniqMaxUnip}.
	\item \cref{Qrank2<>UnipGens}.
	\item \cref{Qrank2<>SL3orSO23}.
	\end{enumerate}

\item \label{RedCommGens}
 Show that if $\Gamma$ is reducible, and $G$ has no compact
factors, then there is a finite subset
$\{\gamma_1,\ldots,\gamma_r\}$ of~$\Gamma$, such that
 \begin{enumerate}
 \item $\{\gamma_1,\ldots,\gamma_r\}$ generates a
finite-index subgroup of~$\Gamma$,
 \item each $\gamma_i$ is nontrivial, and 
 \item $\gamma_i$ commutes with~$\gamma_{i+1}$, for each~$i$.
 \end{enumerate}
 
% \item \label{noCommGens}
%Suppose $\Lambda$ is a group such that:
%	\begin{enumerate}
%	\item if $\gamma_1$ and~$\gamma_2$ are any
%nontrivial elements of~$\Lambda$, such that $\gamma_1$
%commutes with~$\gamma_2$, then $\czer_{\Gamma}(\gamma_1) =
%\czer_{\Gamma}(\gamma_2)$,
%	and
%	\item there is a sequence $\lambda_1,\lambda_2,\ldots,\lambda_n$ of elements of~$\Lambda$, such 
%		\begin{enumerate}
%		\item $\{\lambda_1,\lambda_2,\ldots,\lambda_n\}$ generates~$\Lambda$,
%		and
%		\item $\lambda_i$ commutes with $\lambda_{i+1}$ for $1 \le i < n$.
%		\end{enumerate}
%	\end{enumerate}
%Show that $\Lambda$ is abelian.

\item Let $\Gamma$ be a torsion-free, cocompact lattice in $\SL(3,\real)$, constructed as in \cref{CocpctSL3Rbands}. Show that if $\gamma_1$ and~$\gamma_2$ are any
nontrivial elements of~$\Gamma$, such that $\gamma_1$
commutes with~$\gamma_2$, then $\czer_{\Gamma}(\gamma_1) =
\czer_{\Gamma}(\gamma_2)$. (Hence, it is impossible to find a
sequence of nontrivial generators of~$\Gamma$, such that each generator
commutes with the next.)
\hint{Let $D = \phi(L^3)$, so $D$ is a division ring of degree~$3$ over~$\rational$. Then $\czer_D(\gamma_1)$ is subring of~$D$ that contains the field $\rational[\gamma_1]$ in its center. Because the degree of~$D$ is prime, we conclude that
$\czer_D(\gamma_1) = \rational[\gamma_1] \subseteq \czer_D(\gamma_2)$.}

 \end{exercises}







\section{Minimal parabolic \texorpdfstring{$\rational$}{Q}-subgroups}

%Generally speaking, subgroups of~$G$ are more likely to be useful for the study of arithmetic subgroups if they are defined over~$\rational$. 

Minimal parabolic subgroups of~$G$ play an important role in the study of arithmetic subgroups, even when they are not defined over~$\rational$. However, for some purposes (especially when we construct a coarse fundamental domain in \cref{ReductionChap}), we want a subgroup that is both defined over~$\rational$ and is similar to a minimal parabolic subgroup:

\begin{defn}[(cf.~\cref{MinParabDefn})]
Let $S$ be a maximal $\rational$-split torus of~$G$, and let $a$ be a generic element of~$S$. Then the corresponding \defit[parabolic!Q-subgroup, minimal@$\rational$-subgroup, minimal]{minimal parabolic $\mpmb\rational$-subgroup} % @@@ mypmb
of~$G$ is
	$$P = \bigset{ g \in G }{ \limsup_{n \to \infty} \| a^{-n} g a^n \| < \infty } .$$
This is a Zariski closed subgroup of~$G$ that is defined over~$\rational$.
 \end{defn}

\begin{egs} \ \label{QParabEgs}
 \noprelistbreak
 \begin{enumerate}

	\item \label{QParabEgs-SLn}
	Since the group of upper triangular matrices is a minimal parabolic $\rational$-subgroup of $\SL(n,\real)$, we see that, in this case, the minimal parabolic $\rational$-subgroup is also a minimal parabolic subgroup. 
	%This is because the maximal $\rational$-split torus is also a maximal $\real$-split torus.
	
	\item This is a special case of the fact that if $\Qrank \Gamma = \Rrank G$, then every minimal parabolic $\rational$-subgroup is also a minimal parabolic subgroup \csee{MinParQisMin}. 
	
	 \item \label{QParabEgs-SOQ}
	 \fullCcf{parab=Stab(flag)}{SOmn}
	 Suppose $Q$ is a nondegenerate quadratic form on~$\rational^\ell$ that is defined over~$\rational$. A subgroup~$P$ of $\SO(Q; \real)$ is a minimal parabolic $\rational$-subgroup if and only if there is a chain $V_0 \subsetneq V_1 \subsetneq \cdots \subsetneq V_r$ of \textbf{totally isotropic} subspaces of $\rational^\ell$, such that 
	 	\begin{itemize}
		\item $\dim V_i = i$, for each~$i$,
		\item $V_r$~is a maximal totally isotropic subspace, 
		and
		\item $ P = \{\, g \in \SO(Q; \real) \mid \forall i, \ g V_i = V_i \,\} $.
		\end{itemize}
	 \end{enumerate}
 \end{egs}

We have a Langlands decomposition over~$\rational$. However, unlike in the real case, where the subgroup~$M$ is compact (i.e., $\Rrank M = 0$), we now have a subgroup that may be noncompact (but whose $\rational$-rank is~$0$):

\begin{thm}[(\thmindex{Langlands decomposition}Langlands decomposition)]
\label{LanglandsDecompQ}
 If $P$ is a minimal parabolic\/ $\rational$-subgroup of~$G$, then we may write $P$ in the form $P = MSN = LCSN$, where%
	 \begin{enumerate}
	 \item $M$, $S$, $N$, $L$, and~$C$ are defined over~$\rational$,
	 \item $S$~is a maximal $\rational$-split torus, 
	 \item \label{LanglandsDecompQ-M=0}
	 $\Qrank M = 0$,
	 \item $M S = \czer_G(S)$,
	 \item $M = LC$, where $L$ is semisimple and $C$ is the identity component of the center of~$M$,
	and 
	 \item $N$ is the {\upshape\defit[unipotent!radical]{unipotent radical}} of~$P$; that is, the unique maximal unipotent \textbf{normal} subgroup of~$P$. 
	 \end{enumerate}
Furthermore, 
%the subgroups $S$ and~$N$ are nontrivial if and only if $P \neq G$.
for some $a \in S_{\rational}$, we have
	 \begin{align} \label{aContractsP}
	  P = \bigset{ g \in G }{ \limsup_{n \to \infty} \| a^{-n}
	g a^n \| < \infty } 
	\end{align}
and
	 \begin{align}
	N = \bigset{ g \in G }{ \lim_{n \to \infty} a^{-n} g a^n = e } 
	. \end{align}
 \end{thm}

\begin{proof}
The examples and proof are essentially the same as for the real Langlands decomposition \pref{LanglandsDecomp}, but with $\rational$ in the place of~$\real$, and groups of $\rational$-rank~$0$ in place of compact groups.
\end{proof}

\begin{prop} \label{parab/Q}
 Assume $G$ is defined over~$\rational$, and $P$ is a minimal parabolic $\rational$-subgroup, with Langlands decomposition $P = MSN$. Then:
	 \begin{enumerate}
	 \item \label{parab/Q-conj}
	 Every minimal parabolic $\rational$-subgroup of~$G$ is $G_\rational$-conjugate to~$P$.
	 \item \label{parab/Q-U}
	Every unipotent $\rational$-subgroup of~$G$ is $G_\rational$-conjugate to a subgroup of~$N$.
	\item \label{parab/Q-nzer}
	$P = \nzer_G(N) = \nzer_G(P)$.
	 \end{enumerate}
 \end{prop}

\begin{defn} \label{PosWeylChamberDefn}
For $P$, $M$, $S$, $N$, $L$, and~$C$ as in \cref{LanglandsDecompQ}, the 
\defit[Weyl chamber, positive]{positive Weyl chamber}%
\index{positive!Weyl chamber|indsee{Weyl chamber, positive}}
of~$S$ (with respect to~$P$) is the set~$S^+$ of all elements~$a$ of~$S$, such that $P$ is contained in the right-hand side of \pref{aContractsP}. (Equivalently, it is the closure of the set of elements~$a$ of~$S$ for which equality holds in \pref{aContractsP}.)
\end{defn}

%\begin{cor} \label{MaxUnipQSubgrps}
% Assume $G$ is defined over~$\rational$.
% \begin{enumerate}
% \item \label{MaxUnipQSubgrps-UnipRad}
%The maximal unipotent $\rational$-subgroups of~$G$ are
%precisely the unipotent radicals of the minimal parabolic
%$\rational$-subgroups of~$G$.
% \item \label{MaxUnipQSubgrps-PisNorm}
%The minimal parabolic $\rational$-subgroups of~$G$ are
%precisely the normalizers of the maximal unipotent
%$\rational$-subgroups of~$G$.
% \item All of the maximal unipotent subgroups
%of~$G_{\rational}$ are conjugate \textup(via
%$G_{\rational}$\textup).
% \end{enumerate}
% \end{cor}


\begin{exercises}
\item \label{MinParQisMin}
Show that if we have $\Qrank \Gamma = \Rrank G$, then every minimal parabolic $\rational$-subgroup is also a minimal parabolic subgroup. 
\hint{Choose $A$ to be both a maximal $\rational$-split torus and a maximal $\real$-split torus.}

\item Show that the converse of \cref{MinParQisMin} is not true.
\hint{\cref{NoncocpctInSL3Eg}.}

\item Show that every minimal parabolic $\rational$-subgroup of~$G$ contains a minimal parabolic subgroup.
\hint{Choose a maximal $\rational$-split torus~$S$. Then choose a maximal $\real$-split torus~$A$ that contains~$S$. There is a generic element of~$A$ that is very close to a generic element of~$S$.}

\item \label{G=KP}
If $P$ is any minimal parabolic $\rational$-subgroup of~$G$, and $K$~is any maximal compact subgroup of~$G$, show that $G = KP$.
 \hint{The Iwasawa decomposition \pref{IwasawaDecomp} tells us $G = KAN$, and some conjugate of $AN$ is contained in~$P$.}

\item Assume the notation of \cref{LanglandsDecompQ}. Show that if $\Qrank G = 1$, then there is an isomorphism $\phi \colon S \stackrel{\iso}{\to} \real$, such that $\phi(S^+) = \real^+$.


\item \label{U/UZcpct}
 Show that if $U$ is a unipotent $\rational$-subgroup of $\SL(\ell,\real)$, then $U_{\integer}$ is a cocompact lattice in~$U$.
\hint{Induct on the nilpotence class of~$U$ \csee{UnipNilp}.
Note that the exponential map $\exp \colon \Lie U \to U$ is a polynomial with rational coefficients, as is its inverse, so $U_\integer$ is Zariski dense in~$U$.}
 
\item Show that if $U_1$ and $U_2$ are maximal unipotent
subgroups of~$\Gamma$, and $\Gamma$~is commensurable to
$G_{\integer}$, then there exists $g \in G_{\rational}$, such
that $g^{-1} U_1 g$ is commensurable to~$U_2$.

\end{exercises}






\section{Isogenies over \texorpdfstring{$\rational$}{Q}}

We have seen examples in which $G$ is isogenous (or even isomorphic)
to~$G'$, but the arithmetic subgroup $G_{\integer}$ is very different
from~$G'_{\integer}$. (For example, it may be the case that
$G_{\integer}$ is cocompact, but $G'_{\integer}$ is not.) This
does not happen if the isogeny is defined over~$\rational$, in the following sense:
%Because of our interest
%in restriction of scalars, we describe the theory over any
%algebraic number field~$F$. For the particularly motivated
%reader, we provide some proofs.

\begin{defn} 
\ %To avoid technical issues, assume $G$ is connected.
\noprelistbreak
	 \begin{enumerate}

	 \item A homomorphism $\phi \colon G \to G'$ is 
	 \defit[defined!over Q@over~$\rational$]{defined over~$\mpmb\rational$} %@@@ mypmb
	 if $\phi( G_{\rational} ) \subseteq G'_{\rational}$.
%	 \begin{enumerate}
%	 \item $\phi$ is differentiable,
%	 \item the derivative $d \phi_e$ is $F_\infty$-linear, and
%	 \item $\phi(G_F) \subseteq H_F$.
%	 \end{enumerate}
	 \item $G_1$ is \defit[isogenous!over~$\rational$]{isogenous to~$G_2$
	over~$\mpmb\rational$} %@@@ mypmb
	 (denoted $G_1 \approx_\rational G_2$) if there is a
	group~$G$ that is defined over~$\rational$, and isogenies $\phi_i
	\colon G \to G_i$ that are defined over~$\rational$.
	 \end{enumerate}
 \end{defn}

The following result shows that any isogeny over~$\rational$ can be thought of as a polynomial with rational coefficients.
 
\begin{defn} 
 A function $\phi \colon G \to G'$ is a \defit[polynomial!with rational coefficients]{polynomial with rational coefficients} if 
 	\begin{itemize}
	\item the matrix entries of~$\phi(g)$ can be written as polynomial functions of the coefficients of~$g$,
	and
	\item the polynomials can be chosen so that all of their coefficients are in~$\rational$.
	\end{itemize}
\end{defn}

\begin{prop} \label{isog/Q->poly}
 If $G_1 \approx_\rational G_2$, then there is a group~$G$ that is defined
over\/~$\rational$, and isogenies $\phi_i \colon G
\to G_i$ for $i = 1,2$, that are polynomials with rational coefficients.
 \end{prop}

\begin{proof}
 Given isogenies $\phi_i \colon G \to G_i$ that are defined
over~$\rational$, let 
	 $$G' =
	 \bigset{ \bigl( \phi_1(g), \phi_2(g) \bigr) 
	 }{ 
	 g \in G^\circ }
	 .$$
This is defined over~$\rational$, since $G'_\rational$ is dense \csee{QptsDense}. The projection maps $\phi_i' \colon G' \to G_i$
defined by $\phi_i'(g_1,g_2) = g_i$ are polynomials with rational coefficients.
 \end{proof}

\begin{warn}
 There are examples where $\phi \colon G_1 \to G_2$ is an
isomorphism, and $\phi$ is a polynomial, but
$\phi^{-1}$ is not a polynomial. For example, the natural
homomorphism $\phi \colon \SL(3,\real) \to
\PSL(3,\real)^\circ$ is an isomorphism (because
$\SL(3,\real)$ has no center). However, there is no
isomorphism from $\PSL(3,\complex)$ to $\SL(3,\complex)$
(because one of these groups has a center and the other does
not), so the inverse of~$\phi$ cannot be a polynomial
(because it does not extend to a well-defined map between the
complexifications).
 \end{warn}

The following fundamental result implies that different
embeddings of~$G$ with the same $\rational$-points have
essentially the same $\integer$-points.

\begin{prop} \label{phi(GZ)}
 Suppose $\phi \colon G \to G'$ is a surjective homomorphism
that is defined over~$\rational$. Then $\phi (G_\integer)$ is
commensurable to~$G'_\integer$.
 \end{prop}

\begin{proof}
% Let us assume $F = \rational$ and $\ints = \integer$.
%(The general case follows from this by Restriction of
%Scalars.) 
From the proof of \cref{isog/Q->poly}, we see
that, after replacing~$G$ with an isogenous group, we may
assume that $\phi$ is a polynomial with rational
coefficients. Assume $G \subseteq \SL(\ell,\real)$ and $G'
\subseteq \SL(m,\real)$.

Define $\widetilde\phi \colon G \to \Mat_{m \times m}(\real)$ by
$\widetilde\phi(x) = \phi(x - \Id)$. Then $\widetilde\phi$ is a polynomial, so it is defined on all of $\Mat_{\ell \times
\ell}(\real)$. Since the coefficients are in~$\rational$, there
is some nonzero $n \in \natural$, such that $\widetilde\phi\bigl( n
\Mat_{\ell \times \ell}(\real)  \bigr) \subseteq \Mat_{m \times
m}(\integer)$. Therefore, letting $\Gamma_n$ be the ``\term{principal
congruence subgroup}'' of~$G_{\integer}$ of level~$n$ (see page~\pageref{PrincCongSubgrp}), we have
$\phi(\Gamma_n) \subseteq G'_{\integer}$.

Because $\Gamma_n$ is a lattice in~$G$ (and
$\phi(\Gamma_n)$ is discrete), we know that
$\phi(\Gamma_n)$ is a lattice in~$G'$. Since
$\phi(\Gamma_n) \subseteq G'_{\integer}$, this implies that
$\phi(\Gamma_n)$ is commensurable to $G'_{\integer}$
\csee{finext->latt}.
 \end{proof}

%\begin{cor}
% Suppose $G$ and~$H$ are subgroups of $\SL(\ell,\real)$
%that are defined over~$\rational$. A differentiable
%homomorphism $\phi \colon G \to H$ is defined
%over~$\rational$ if and only if some finite-index subgroup
%of $\phi(G_{\integer})$ is contained in $H_{\rational}$.
% \end{cor}

The following fundamental fact is, unfortunately, not obvious from our definition of ``$\rational$-split\zz.''

\begin{prop} \label{QsplitInvtIsog}
Assume 
	\begin{itemize}
	\item $T$ and~$H$ are connected Lie groups that are defined over\/~$\rational$,
	and
	\item $T \approx_\rational H$.
	\end{itemize}
Then $T$ is a\/ $\rational$-split torus if and only if $H$~is a\/ $\rational$-split torus.
\end{prop}

\begin{cor} \label{Qrank(isog)=}
 If $G \approx_\rational G'$, then $\Qrank G_\integer = \Qrank G'_\integer$.
 \end{cor} 

\begin{proof}
Suppose $G$ is a $\rational$-group, and there is an isogeny $\varphi_i \colon G \to G_i$ that is defined over~$\rational$ for $i = 1,2$.
If $T_1$ is a maximal $\rational$-split torus in~$G_1$, then \cref{QsplitInvtIsog} implies that $\varphi_2 \bigl( \varphi_1^{-1}(T_1)^\circ \bigr)$ is a $\rational$-split torus in~$G_2$. Since isogeny preserves dimension, we conclude that $\Qrank G_1 \le \Qrank G_2$. By symmetry, equality must hold.
\end{proof}

%\begin{exercises}
%
%\item It would be good to have some exercises here @@@
%
%\end{exercises}



\begin{notes}

As was mentioned in the notes of \cref{RrankChap}, the comprehensive treatise of Borel and Tits \cite{BorelTits-GrpRed} is the standard reference on rank, parabolic subgroups, and other fundamental properties of reductive groups over any field (including~$\rational$).
Abbreviated accounts can be found in many texts, including \cite[\S10 and \S11]{Borel-IntroGrpArith} and  \cite[Chap.~5]{Borel-LinAlgGrps}.

See \cite[Rem.~8.11, p.~60]{Borel-IntroGrpArith} for a proof of \cref{phi(GZ)}.
	

\end{notes}

\begin{references}{9}


\bibitem{Borel-IntroGrpArith}
A.\,Borel:
\emph{Introduction aux Groupes Arithm\'etiques}.
%Publications de l'Institut de Mathmatique de l'Universit de Strasbourg, XV. Actualits Scientifiques et Industrielles, No. 1341 
Hermann, Paris, 1969.
\MR{0244260} 

\bibitem{Borel-LinAlgGrps}
A.\,Borel:
\emph{Linear Algebraic Groups, 2nd ed.}.
Springer, New York, 1991.
ISBN 0-387-97370-2,
\MR{1102012}

\bibitem{BorelTits-GrpRed}
A.\,Borel and J.\,Tits:
Groupes r\'eductifs,
\emph{Inst. Hautes \'Etudes Sci. Publ. Math.} 27 (1965) 55--150.
\MR{207712},
\maynewline
\url{http://www.numdam.org/item?id=PMIHES_1965__27__55_0}

\end{references}



