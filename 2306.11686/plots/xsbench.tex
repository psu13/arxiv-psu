\begin{tikzpicture}

\begin{axis}[
    enlarge y limits={abs=0.01},
    enlarge x limits={abs=0.5},
    xticklabels={},
    yticklabels={},
    legend columns=3,
    legend style={
      at={(1.33,1.13)},
      anchor=center,
      draw=none,
      /tikz/every even column/.append style   = {column sep= 0mm, text width=15em},
    },
    legend image code/.code={
      \draw [fill=#1] (0cm,-1.5mm) rectangle (4mm,1.5mm);
    },
    xmin=0, xmax=1,
    ymin=0.0, ymax=1.1,
    width=\linewidth,
    height=64mm,
    xmajorticks=false,
    axis line style={draw=none},
    tick style={draw=none},
]
\addlegendimage{col3, postaction={pattern color=gray, pattern=crosshatch}}
\addlegendentry{manual offload (event, small)}
\addlegendimage{col4, postaction={pattern color=gray, pattern=north east lines}}
\addlegendentry{GPU First (event, small)}
\addlegendimage{col8, postaction={pattern color=gray, pattern=vertical lines}}
\addlegendentry{GPU First (history, small)}
\addlegendimage{col10!40, postaction={pattern color=gray, pattern=crosshatch}}
\addlegendentry{manual offload (event, large)}
\addlegendimage{col11!40, postaction={pattern color=gray, pattern=north east lines}}
\addlegendentry{GPU First (event, large)}
\addlegendimage{col13!40, postaction={pattern color=gray, pattern=vertical lines}}
\addlegendentry{GPU First (history, large)}
\end{axis}

\begin{axis}[
    extra y ticks={1},
    extra y tick labels={CPU},
    ymin=0.0, ymax=16.5,
    name nodes near coords/.default=coordnode,
    bar width=0.10,
    name nodes near coords/.style={
      every node near coord/.append style={
        shift={(axis direction cs:0, -\ycoord)},
        name=#1-\coordindex,
        alias=#1-last,
        %rotate=90,
        %anchor=west,
        rotate=0,
        anchor=south,
        align=center,
        /pgf/number format/fixed,
      },
    },
]

\addplot+[
  name nodes near coords=offloadEventSmall,
  col3, postaction={pattern color=gray, pattern=crosshatch},
%  error bars/.cd,y dir=both,y explicit, error bar style={color=black,ultra thick},
 ] 
coordinates {
  (0, 9.757)
  };

\addplot+[
  name nodes near coords=gpuFirstEventSmall,
  col4, postaction={pattern color=gray, pattern=north east lines},
]
coordinates {
  (0, 11.772)
  };

\addplot+[
  name nodes near coords=missing1,
  white,
]
coordinates {
(0,0)
  };


\addplot+[
%  xshift=2mm,
  name nodes near coords=gpuFirstHistorySmall,
  col8, postaction={pattern color=gray, pattern=vertical lines},
]
coordinates {
  (0, 14.360)
  };

\addplot+[
]
coordinates {
  };

\addplot+[
  name nodes near coords=offloadEventLarge,
  col10!40, postaction={pattern color=gray, pattern=crosshatch},
]
coordinates {
  (0, 11.503)
  };

\addplot+[
  name nodes near coords=gpuFirstEventLarge,
  col11!40, postaction={pattern color=gray, pattern=north east lines},
]
coordinates {
  (0, 11.434)
  };

\addplot+[
  name nodes near coords=missing2,
  white,
]
coordinates {
(0,0)
  };

\addplot+[
%  xshift=2mm,
  name nodes near coords=gpuFirstHistory,
  col13!40, postaction={pattern color=gray, pattern=vertical lines},
]
coordinates {
  (0, 10.64)
  };



\addplot[black!70,dotted,thick,sharp plot,nodes near coords={},
update limits=false,shorten >=-3mm,shorten <=-3mm]
coordinates {(-1,1) (1,1)};
\addplot[black!70,dashed,thick,sharp plot,nodes near coords={},
update limits=false,shorten >=-3mm,shorten <=-3mm]
coordinates {(0,0) (0,18)};
\node[] (top) at (axis description cs:1,1) {};
\node[anchor=north] (small) at (axis description cs:0.24,1) {small};
\node[anchor=north] (large) at (axis description cs:0.76,1) {large};

\end{axis}

\node[rotate=90,anchor=west,fill=white] (test) at ($(missing1-0) + (0,0.2)$) {no offload history};
\node[rotate=90,anchor=west,fill=white] (test) at ($(missing2-0) + (0,0.2)$) {no offload history};

\end{tikzpicture}

