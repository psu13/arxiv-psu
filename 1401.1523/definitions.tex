

%\def\wit{wit}
\def\toto{\mathop{\to}\limits^{TO}}
\def\pij{p_{i\to j}}
\def\dmin{D_{\min}}
\def\dmax{D_{\max}}
\def\<{\langle}
\def\>{\rangle}
\def\ot{\otimes}
\def\ermax{E_R^{\max}}
\def\esmax{E_S^{\max}}
\def\ecal{{\cal E}}
\def\hcal{{\cal H}}
\def\ecalr{{\ecal_R}}
\def\etaE{\eta_{E-E_S}^R}
\def\etaEprim{\eta'_{E-E_S}}
\def\ideta{\eta}
\def\rhor{\rho_R}
\def\rhos{\rho_S}
\def\rhors{\rho_{RS}}
\def\energy{E_0}

\def\rhoinr{\rho^{\rm in}_R}
\def\rhoins{\rho^{\rm in}_S}
\def\rhoinw{\rho^{\rm in}_W}
\def\rhoinc{\rho^{\rm in}_C}
\def\rhooutr{\rho^{\rm out}_R}
\def\rhoouts{\rho^{\rm out}_S}
\def\rhooutw{\rho^{\rm out}_W}
\def\rhooutsc{\rho^{\rm out}_{SC}}
\def\rhooutsw{\rho^{\rm out}_{SW}}
\def\rhooutc{\rho^{\rm out}_C}
\def\rhozeror{\rho^{0}_R}
\def\rhozeros{\rho^{0}_S}
\def\rhozeroc{\rho^{0}_C}
\def\sgibbs{\rho_S^\beta}
\def\rgibbs{\rho_R^\beta}
\def\cgibbs{\rho_C^\beta}
\def\ancgibbs{\rho_{\rm anc}^\beta}
\def\rscgibbs{\rho_{\rm RSC}^\beta}
\def\scgibbs{\rho_{\rm SC}^\beta}

\def\twirl{{\cal T}}
%\def\rk{{\rm rank}}
\def\tred{\textcolor{red}}
\def\tblue{\textcolor{blue}}
\def\funny{{f-smooth}}
\def\funnyh{{f-smooth}}
\def\Funnyh{{F-smooth}}
\def\fh{\tilde H}
\def\Funny{{F-smooth}}
\def\frk{{\rm{frk}}}
\def\ftail{{\rm{ftail}}}
\def\tail{{\rm tail}}
\def\rk{{\rm rk}}
\def\rkd{{\rm rk}^\delta}

\def\stipp{\bar{p}^{(\delta)}}
\def\stipq{\bar{q}^{(\delta)}}
\def\stipf{\bar{f}^{(\delta)}}
\def\flatp{\underline{p}^{(\delta)}}
\def\flatq{\underline{q}^{(\delta)}}
\def\flatf{\underline{f}^{(\delta)}}
\def\flattest{flattest}
\def\stippest{steeppest}




\newcommand{\be}{\begin{eqnarray} \begin{aligned}}
\newcommand{\ee}{\end{aligned} \end{eqnarray} }
\newcommand{\benn}{\begin{eqnarray*} \begin{aligned}}
\newcommand{\eenn}{\end{aligned} \end{eqnarray*} }


\newcommand{\ben}{\begin{eqnarray} \begin{aligned}}
\newcommand{\een}{\end{aligned} \end{eqnarray} }

\newcommand{\hmax}{\mathrm{H}_{\max}}
\newcommand{\hminp}{\mathrm{H}_{\min}}
\newcommand{\h}{\mathrm{H}}
\newcommand{\bc}{\begin{center}}
\newcommand{\ec}{\end{center}}
\newcommand{\half}{\frac{1}{2}}
\newcommand{\ran}{\rangle}
\newcommand{\lan}{\langle}
\newcommand{\id}{\mathbb{I}}
\newcommand{\im}{\mathbbmss{1}}
\newcommand{\idop}{\mathcal{I}}
\newcommand{\nullmat}{\mathbf{0}}
\newcommand{\fid}{\mathcal{F}}
\newcommand{\Cn}{\mathbb{C}}
\newcommand{\re}{\mathop{\mathbb{R}}\nolimits}
\newcommand{\natnum}{\mathop{\mathbb{N}}\nolimits}
\newcommand{\esp}{\mathbb{E}}
\newcommand{\cov}{\mathop{\mathrm{Cov}} \nolimits}
\newcommand{\var}{\mathop{\mathrm{Var}} \nolimits}
\newcommand{\mse}{\mathop{\mathrm{MSE}} \nolimits}
\newcommand{\rlprt}{\mathop{\mathrm{Re}} \nolimits}
\newcommand{\nth}{\mathrm{th}}
\newcommand{\imprt}{\mathop{\mathrm{Im}}\nolimits}
\newcommand{\tr}{\mathop{\mathsf{tr}}\nolimits}
\newcommand{\Tr}{\mathop{\mathsf{Tr}}\nolimits}
\newcommand{\eval}[2]{\left. #1 \right \arrowvert _{#2}}
\newcommand{\norm}[1]{\left\| #1\right \|}
\newcommand{\smalloh}{\mathrm{o}}
\newcommand{\bigoh}{\mathrm{O}}
\newcommand{\pr}{\prime}
\newcommand{\di}{\text{d}}
\newcommand{\trans}[1]{#1^{\top}}
\newcommand{\iu}{i}
\newcommand{\vc}[1]{#1}				% VECTORS
\newcommand{\abs}[1]{\left|#1 \right|}				% ABS
\newcommand{\der}[1]{\frac{\partial}{\partial #1}}
\newcommand{\e}{\mathrm{e}}
\newcommand{\upa}{\uparrow}
%
%\newtheorem{theorem}{Theorem}[section]
%\newtheorem{proposition}{Proposition}[section]
%MH
\newcommand{\beq}{\begin{eqnarray} \begin{aligned}}
\newcommand{\eeq}{\end{aligned} \end{eqnarray} }
\newcommand{\bea}{\begin{array}}
\newcommand{\eea}{\end{array}}


\newcommand{\bee}{\begin{enumerate}}
\newcommand{\eee}{\end{enumerate}}
\newcommand{\bei}{\begin{itemize}}
\newcommand{\eei}{\end{itemize}}
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}[theorem]{Proposition}
%MH
\newtheorem{examp}[theorem]{Example}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{corollary}[theorem]{Corollary}
\newcommand{\dna}{\downarrow}
\newcommand{\ra}{\rightarrow}
\newcommand{\hil}{\mathcal{H}}
\newcommand{\kil}{\mathcal{K}}
\newcommand{\allrhos}{\mathcal{M}}
\newcommand{\allrhosin}[1]{\mathcal{S}(#1)}
\newcommand{\pop}[1]{\mathcal{M}_{+}(#1)}
\newcommand{\cpmap}{\mathcal{E}}
\newcommand{\uop}{\mathcal{U}}
\newcommand{\su}{\mathfrak{su}}
\newcommand{\finproof}{$\Box$}
\newcommand{\textmath}{}
\newcommand{\wt}{\widetilde}
\newcommand{\wavyline}[3]{
\multiput(#1,#2)(4,0){#3}{
\qbezier(0,0)(1,1)(2,0)
\qbezier(2,0)(3,-1)(4,0)}}
\newcommand{\spann}{\mathop{\mathrm{span}}\nolimits}  %%% Space spanned by a set of vectors.



\newcommand{\wigglyline}[3]{
\multiput(#1,#2)(1,0){#3}{
\qbezier(0,0)(0.25,0.25)(0.5,0)
\qbezier(0.5,0)(0.75,-0.25)(1,0)}}

\newcommand{\allsigmasin}[1]{\tilde{\mathcal{S}}(#1)}
\newcommand{\instr}{\mathcal{N}}
\newcommand{\dfdas}{\stackrel{\textrm{\tiny def}}{=}}
\newcommand{\argmax}{\mathop{\mathrm{argmax}}\nolimits}
\newcommand{\bin}{\textrm{Bin}}
\newcommand{\topr}{\stackrel{P}{\to}}
\newcommand{\todst}{\stackrel{D}{\to}}
\newcommand{\lil}{\mathcal{L}}
\newcommand{\myabstract}[1]{\begin{quote}{\small  #1 }\end{quote}}
\newcommand{\myacknowledgments}{\begin{center}{\bf Acknowledgments}\end{center}\par}
\newcommand{\otherfid}{\mathsf{F}}
\newcommand{\mypacs}[1]{\begin{flushleft} {\small PACS numbers: #1}\end{flushleft}}
\newcommand{\basedon}[1]{\begin{flushleft} {\small This chapter is based on #1.}\end{flushleft}}
\newcommand{\onbased}[1]{\begin{flushleft} {\small  #1 is based on this chapter.}\end{flushleft}}
\newcommand{\ds}{\displaystyle}
%\newcommand{\note}[1]{\textsc{#1} $\clubsuit$}
\newcommand{\co}{\textrm{co}}
%%%%%%%%%%%%%% Greek Letters %%%%%%%%%%%%%%%%%%%%%%
\newcommand{\eg}{\epsilon}
\newcommand{\zg}{\theta}
\newcommand{\ag}{\alpha}
\newcommand{\bg}{\beta}
\newcommand{\dg}{\delta}
\newcommand{\mc}{\mathcal}

\usepackage{amsfonts}
\def\Real{\mathbb{R}}
\def\Complex{\mathbb{C}}
\def\Natural{\mathbb{N}}
\def\id{\mathbb{I}}

\def\01{\{0,1\}}
\newcommand{\ceil}[1]{\lceil{#1}\rceil}
\newcommand{\floor}[1]{\lfloor{#1}\rfloor}
\newcommand{\eps}{\varepsilon}
\newcommand{\ket}[1]{|#1\rangle}
\newcommand{\bra}[1]{\langle#1|}
\newcommand{\outp}[2]{|#1\rangle\langle#2|}
\newcommand{\proj}[1]{|#1\rangle\langle#1|}
\newcommand{\ketbra}[2]{|#1\rangle\langle#2|}

\newcommand{\inp}[2]{\langle{#1}|{#2}\rangle} % inproduct, < | >
\newcommand{\braket}[2]{\langle #1|#2\rangle}

\newcommand{\rank}{\operatorname{rank}}

\newtheorem{conjecture}{Conjecture}
\newtheorem{fact}{Fact}

\newtheorem{lemmaApp}{Lemma A.}
\newtheorem{corollaryApp}{Corollary A.}

\newcommand{\mX}{\mathcal{X}}
\newcommand{\mY}{\mathcal{Y}}
\newcommand{\mB}{\mathcal{B}}


\newenvironment{sdp}[2]{
\smallskip
\begin{center}
\begin{tabular}{ll}
#1 & #2\\
subject to
}
{
\end{tabular}
\end{center}
\smallskip
}

\newcommand{\ens}{\mathcal{E}}
\newcommand{\Y}{|\mY|}
\newcommand{\psucRAC}{P^{\rm uncert}}
\newcommand{\psuc}{P^{\rm succ}}
\newcommand{\pgame}{{P^{\rm game}}}
\newcommand{\pgameMAX}{{P^{\rm game}_{\rm max}}}
\newcommand{\cE}{\mathcal{E}}
\newcommand{\cU}{\mathcal{U}}
\newcommand{\sx}{\mathcal{S}_x}
\newcommand{\hmin}{\ensuremath{H}_{\infty}}

\newcommand{\stateSet}{\mathscr{S}}


\newcommand{\secchsh}{\ref{sec:chsh}}
\newcommand{\nn}[1]{\textcolor{magenta}{nelly: #1}}
\newcommand{\mcomment}[1]{{\sf [#1]}\marginpar[\hfill !!!]{!!!}}
\newcommand{\steph}[1]{{\textcolor{blue}{steph: #1}}}
\newcommand{\jono}[1]{\textcolor{blue}{jono: #1}}
\newcommand{\mh}[1]{\textcolor{red}{mh: #1}}
\newcommand{\pc}[1]{\textcolor{green}{\tt Piotr: #1}}
\newcommand{\fer}[1]{\textcolor{brown}{\tt Fernando: #1}}
\newcommand{\xstr}{{\vec{x}_{s,a}}}
\newcommand{\str}{{\vec{x}}}
\newcommand{\vstr}{x}
\newcommand{\vxstr}{{x_{s,a}}}
\newcommand{\xstrsub}{s,a}
\newcommand{\probun}[1]{P^{\rm un}(#1)}
\newcommand{\probsteer}[1]{P^{\rm st}(#1)}

\newcommand{\prob}[1]{p(#1)}

\newcommand{\good}{\mathcal{G}}
\newcommand{\bstate}[1]{\sigma_{\xstrsub}^{#1}}
\newcommand{\xor}{XOR}
%\newcommand{\eeq}{\end{align}}
%\newcommand{\beq}{\begin{align}}
\newcommand{\avgb}{\rho}
\newcommand{\icaus}{I_{caus}}
\newcommand{\irac}{I_{rac}}
\newcommand{\unop}{Q}
\newcommand{\supl}{Appendix}
%\newcommand{\supl}{Supplementary Materials}
\newcommand{\stateset}{\mathcal{F}_{s}}
\newcommand{\badproj}{\Pi_{bad}}

\newcommand{\setA}{\mathcal{A}}
\newcommand{\setB}{\mathcal{B}}
\newcommand{\setS}{\mathcal{S}}
\newcommand{\setT}{\mathcal{T}}
\newcommand{\secxor}{I}

\newcommand{\dist}[2]{{\cal D}(#1\rangle#2)}

\def\<{\langle}
\def\>{\rangle}
\def\ot{\otimes}
\def\ermax{E_R^{\max}}
\def\esmax{E_S^{\max}}
\def\ecal{{\cal E}}
\def\hcal{{\cal H}}
\def\ecalr{{\ecal_R}}
\def\etaE{\eta_{E-E_S}}
\def\rhor{\rho_R}
\def\rhos{\rho_S}
\def\gibbs{\rho_\beta}
\def\final{\rho'}
\def\ergotropymin{F_\epsilon^{min}}
\def\ergotropymax{F_\epsilon^{max}}
\def\gmin{G_\epsilon^{min}}
\def\gmax{G_\epsilon^{max}}
\def\supthermomaj{C}
\def\supdistillation{D}
\def\supformation{D}
\def\supparadigm{A}
\def\supprocesses{E}

\def\rhodec{\omega}
\def\s{\,\,\,\,}
\def\dmin{D_{min}}
\def\dmax{D_{max}}
\def\dmine{D^\epsilon_{min}}
\def\dmaxe{D^{\epsilon}_{max}}
\def\wit{\psi_W}
\def\witi{0}
\def\initial{\rho}
\def\Hw{\hat{W}}
\def\Hin{H}
\def\Hout{H'}
\def\Zout{Z'}
\def\mainsection{Main Section}
\newcommand{\alfree}[1]{F_\alpha(#1,\gibbs)}
\newcommand{\qalfree}{{\hat F}}
%_\alpha(#1,H)}
% oh no, I can't believe we're hatting, especially here!
\newcommand{\qalfreesimple}{{\tilde F}}
%_\alpha(#1,H)}
%Michal's defs
\def\fmin{F_{\rm min}}
\def\fmax{F_{\rm max}}
\def\tauout{\tau'}
\def\ep{\epsilon}
\newcommand{\sgn}{\operatorname{sgn}}
\def\qrenyi{S}
\def\qrenyisimple{\tilde S}
% jono'ss
\def\trumpd{\rm D_{work}}
\def\catalyst{\sigma}
\def\expbound{\exp(-\Omega(\sqrt{\log(N)}))} 

\def\gibbsin{\rho_\beta^{(0)}}
\def\gibbsout{\rho_\beta^{(1)}}

\def\genFs{generalized free energies}




\newtheorem*{rep@theorem}{\rep@title}
\newcommand{\newreptheorem}[2]{%
\newenvironment{rep#1}[1]{%
 \def\rep@title{#2 \ref{##1} (restatement)}%
 \begin{rep@theorem}}%
 {\end{rep@theorem}}}
\makeatother






\newreptheorem{thm}{Theorem}
\newreptheorem{lem}{Lemma}


