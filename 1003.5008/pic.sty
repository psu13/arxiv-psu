% start of file amo.sty; version 3, collapses citation lists with thin sp
%   added, redef of \refname, running heads should only come out _after_
%   first page of chapter, includes REVTeX equation coding. 9/13/94.
% version 2, allows tc to flow over a page, 7/1/94.
%Last update Dec. 4/95 by G. Drake - main TOC coding added.

%********************************
%Don't look for figure ps files *
\def\epsfig#1{\vspace{50mm}}% ***
%********************************

% ch, 1/10/95. Enables multiple chapter outlines.
%\def\@starttoc#1{\begingroup
%  \makeatletter
%  \@input{\jobname.tc}
%  \if@filesw
%    \expandafter\ifx\csname tf@#1\endcsname\relax
%      \expandafter\newwrite\csname tf@#1\endcsname
%      \immediate\openout\csname tf@#1\endcsname \jobname.#1\relax
%    \fi
%  \fi
%  \global\@nobreakfalse
%  \endgroup
%}
%
\pretolerance1000
\tolerance9999
\emergencystretch1pc
\parskip0pt

\flushbottom

\ifx\reset@font\undefined
  \global\let\reset@font\relax
\fi

\def\refname{REFERENCES}

%% chapter number

\newcounter{chapter}

\newif\ifchapnumset \chapnumsetfalse

\def\setchapnum#1{%
  \global\chapnumsetflse \setcounter{chapter}{#1}%
}

\gdef\thechapter{\arabic{chapter}}

%% equation numbers

\def\theequation{\arabic{equation}}

%%% tables and figures

\def\thetable{\arabic{table}}
\def\fnum@table{{\bf Table \thetable}}

\def\thefigure{\arabic{figure}}
\def\fnum@figure{{\bf Figure \thefigure}}

\long\def\@makecaption#1#2{%
   \vskip 10\p@
   % changed colon to dot on next line
   \setbox\@tempboxa\hbox{#1. #2}%
   \ifdim \wd\@tempboxa >\hsize
   % changed colon to dot on next line
       #1. #2\par
     \else
       \hbox to\hsize{\hfil\box\@tempboxa\hfil}%
   \fi}

\newif\ifoutertab \outertabfalse

\newtoks\@mytoksa
\newtoks\@mytoksb
\newtoks\@mytoksc

%   set up font for bold face subscripts - G. Drake.
\font\sevenbf=cmbx7
\font\sevmib = cmmib10  \@ptscale7 % bold math italic
\font\sevsyb = cmbsy10 \@ptscale7 % bold math symbols
\def\sbf#1 {\mbox{\sevenbf #1}}
\@mytoksa=\expandafter{\xpt}
\@mytoksb={\def\pbf{\fam\bffam\tenbf}\textfont\bffam\tenbf
    \scriptfont\bffam\sevenbf \scriptscriptfont\bffam\sevenbf
\def\boldmath{\@ifundefined{tenmib}{\global\font\tenmib\@mbi
   \global\font\tensyb\@mbsy
   \global\font\tenlyb\@lasyb\relax\@addfontinfo\@xpt
   {\def\boldmath{\everymath{\mit}\everydisplay{\mit}\@prtct\@nomathbold
        \textfont\@ne\tenmib \textfont\tw@\tensyb
        \scriptfont\@ne\sevmib \scriptfont\tw@\sevsyb
        \textfont\lyfam\tenlyb \@prtct\@boldtrue}}}{}\@xpt\boldmath}}%

\xdef\xpt{\the\@mytoksa\the\@mytoksb}

\@mytoksa={\outertabtrue}
\@mytoksb=\expandafter{\table}
\xdef\table{\the\@mytoksa\the\@mytoksb}

%   added by G. Drake so that changes also apply to \table*.
\def\@xnamedef#1{\expandafter\xdef\csname #1\endcsname}
\@mytoksb=\expandafter{\@dblfloat{table}}
\@xnamedef{table*}{\the\@mytoksa\the\@mytoksb}

\@mytoksa=\expandafter{\endtable}
\@mytoksb={\outertabfalse}
\xdef\endtable{\the\@mytoksa\the\@mytoksb}

%    modified by G. Drake 9/15/94 to add \vskip and \headstretch,
%    where \headstretch is the \arraystretch for table headings.
%    A \headstretch is important if \cline is used to separate levels
%    of table leadings.
%    Since \hline is modified below to re-set \@arstrut and \arraystretch,
%    a different value for \arraystretch can be set for the body of
%    the table.

%% page dimens

\normalsize
\small
%\showthe\baselineskip

\oddsidemargin  -1.75pc
\evensidemargin -1.75pc
\marginparwidth 3.5pc
\parindent0pt
\parskip\baselineskip

\marginparsep .5pc

\topmargin -3pc

\headheight 12pt
\headsep 18pt
\headsep .60in
\topskip 10pt

%\footskip 18pt
\footskip 1in

\textheight = 55\baselineskip \advance\textheight by \topskip
\textwidth 43.5pc

\columnsep 1.5pc
\columnseprule 0pt

\renewcommand{\topfraction}{0.8}
\renewcommand{\textfraction}{0.2}
\renewcommand{\dbltopfraction}{0.8}

%% running heads

%
\pagestyle{plain}
%
\@twosidetrue
%
%\def\@oddhead{\normalsize\hfill
%\def\@evenhead{\normalsize\rm\thepage ~/\,
%\sl Atomic, Molecular, and Optical Physics Handbook\hfill}
\def\@evenhead{\rule{\textwidth}{1pt}}
\def\@oddhead{\rule{\textwidth}{1pt}}
\def\@evenfoot{\vbox{\hbox{\rule{\textwidth}{1pt}}\large\bf\thepage\mbox{\boldmath{$\;\cdot$}
\sc Physics in Canada}}}
% \def\@oddfoot{\hbox to \textwidth{\rule{\textwidth}{1pt}}\hbox to \textwidth{\hfill$\cdot$\,
\def\@oddfoot{\vbox{\large\bf\sc\hbox to \textwidth{\rule{\textwidth}{1pt}}
\hbox to \textwidth{\hfill
\large\bf\sc Physics in Canada\mbox{\boldmath{$\;\cdot\,$}}
\large\bf\thepage }}}
%\def\@oddfoot{}\let\@evenfoot\@oddfoot
%

%% front matter


\def\title#1{\gdef\@ctitle{#1} \gdef\@title{} \gdef\@authoraddress{} \gdef\@date{}
\ifchapnumset\else\addtocounter{chapter}{1}\fi \global\chapnumsetfalse
\addcontentsline{toc}{settocnum}{\thechapter}
\setcounter{part}{0}
\setcounter{table}{0}
\setcounter{figure}{0}
\setcounter{equation}{0}
\setcounter{section}{0}
\setcounter{subsection}{0}
\setcounter{subsubsection}{0}
\setcounter{paragraph}{0}
%\gdef\@evenhead{\normalsize{\def\\{\unskip\ \ignorespaces}\rm\thepage
\gdef\@oddhead{\normalsize{\def\\{\unskip\ \ignorespaces}\hfill
   \large\sc#1}}%
\gdef\@evenhead{\normalsize{\def\\{\unskip\ \ignorespaces}
   \large\sc#1\hfill}}%

\gdef\@title{\par
  \vspace*{-4pc}
  {\huge\sc\raggedright\baselineskip27pt
%   \vbox{\hrule height.5pt\vskip4pt
%         \hbox to.75in{\hfil\thechapter\hfil}\vskip4pt\hrule height.5pt}%
   \nointerlineskip\vskip22pt\noindent#1\unskip\par}
  }
}

\def\author#1{%
% add chapter titles and authors to TOC - G. Drake, Dec. 4/95
\addcontentsline{toc}{settoctitle}{\protect\numberline{\hfil%
\protect\large\protect\bf{\thechapter}}\@ctitle}%
\addcontentsline{toc}{settocauthor}{#1}%
\expandafter\def\expandafter\@authoraddress\expandafter%
{\@authoraddress %
{\par\dimen0=-\prevdepth \advance\dimen0 by1.5pc \nointerlineskip
\vskip\dimen0 \noindent \large\rm\relax\ignorespaces\sc\bf by
#1\gdef\@cauthor{#1}\par
}%
}%
}

\def\address#1{\expandafter\def\expandafter\@authoraddress\expandafter
{\@authoraddress
{\par \nointerlineskip \vskip1pc \noindent \normalsize\sl\ignorespaces#1\par }%
}%
}

\def\date#1{\gdef\@date{\par{\small\rm\centering(\ignorespaces#1\unskip)\par}}}

\def\maketitle{\par
%\thispagestyle{plain}
\thispagestyle{empty}
\begingroup
\let\cite\@bylinecite
\def\thefootnote{\fnsymbol{footnote}}%
\setbox0=\vbox{\hsize=\textwidth
  \@maketitle\vskip2pc
}
\loop
\ifdim\ht0>\textheight
   \setbox1=\vsplit0 to\textheight
   \box1\vfil
\repeat
\twocolumn[\box0]
\@thanks
\endgroup
\def\thefootnote{\arabic{footnote}}%
\setcounter{footnote}{0}%
% \let\maketitle\relax \let\@maketitle\relax % keep!! multiple chapters!!
\let\thanks\relax
\gdef\@thanks{}\def\@authoraddress{}\def\@title{}\def\@date{}%
}

\newif\ifsettingtocentries \settingtocentriesfalse
\def\currtocchapnum{0}%
\let\@oldcontentsline\contentsline

%\def\contentsline#1#2#3{%
\def\contentsline#1#2#3{\spaceskip=\fontdimen2\font\pretolerance10000%
  \def\@toctemp{#1}\def\@settype{settocnum}\def\@settitle{settoctitle}%
   \def\@setauthor{settocauthor}%
  \ifx\@toctemp\@settype
    \def\currtocchapnum{#2}%
  \else
    \ifx\@toctemp\@settitle\else
       \ifx\@toctemp\@setauthor\else
          \ifnum\c@chapter=\currtocchapnum
            \@oldcontentsline{#1}{#2}{#3}%
          \fi
       \fi
    \fi
  \fi
}%

\def\@maketitle{%
  \@title
  \ifdim\prevdepth=-1000pt \prevdepth0pt\fi
  \@authoraddress
%  \@date
  {\hsize 31pc
%  \vskip1.5pc\hrule width\hsize\vskip2pt\hrule width\hsize\vskip1.5pc
%  {\tracingall \tracingonline0
  {
%  \tableofcontents
  }
%  \vskip1.5pc\hrule width\hsize\vskip2pt\hrule width\hsize\vskip1.5pc
  }
}

%% table of contents

\def\@pnumwidth{2em}
\def\@tocrmarg {2.55em}
\def\@dotsep{4.5}
\setcounter{tocdepth}{2}

\def\tableofcontents{\@starttoc{toc}}

\def\l@section#1#2{\addpenalty{\@secpenalty}% good place for page break
%   \addvspace{1.0em plus\p@}%
   \@tempdima 3.75em
   \begingroup
     \parindent \z@ \rightskip \@pnumwidth
     \parfillskip -\@pnumwidth
     \bf
     \leavevmode
      \advance\leftskip\@tempdima
      \hskip -\leftskip
     #1\nobreak\hfil \nobreak\hbox to\@pnumwidth{\hss #2}\par
   \endgroup}


\font\foofont=cmbx10 at11pt
\def\l@settocauthor{\@undottedtocline{0}{5em}{2.5em}}
\def\l@settoctitle{\@undottedtocline{1}{0em}{2.5em}}
\def\l@subsection{\@undottedtocline{2}{3.75em}{4.5em}}
\def\l@subsubsection{\@undottedtocline{3}{8.25em}{5.75em}}
\def\l@paragraph{\@undottedtocline{4}{14em}{6em}}
\def\l@subparagraph{\@undottedtocline{5}{20em}{6em}}


%% RmS 91/09/29: added \reset@font for page number
%% CbH 93/12/28: deleted \reset@font for page number
%  Use #1=0 for author and #1=1 for title:  G. Drake, Dec. 4/95
\def\@undottedtocline#1#2#3#4#5{\ifnum #1>\c@tocdepth \else

  \vskip \z@ plus.2\p@
  {\leftskip #2\relax \rightskip \@tocrmarg \parfillskip -\rightskip
    \parindent #2\relax\@afterindenttrue
   \interlinepenalty\@M
   \leavevmode
   \@tempdima #3\relax \advance\leftskip \@tempdima \hbox{}\hskip -\leftskip%
   \ifnum #1=2\def\boldmath{}\fi{\ifnum#1=1\large\fi\ifnum#1=0\sl\fi#4\ifnum#1=1\nobreak\leaders\hbox{$\m@th \mkern \@dotsep mu.\mkern \@dotsep mu$}\hfill\hbox{}\fi}\ifnum#1=1\else\nobreak\hfill\nobreak\fi
%   \ifnum #1=2\def\boldmath{}\fi{\ifnum#1=1\large\bf\fi\ifnum#1=0\foofont\bf\fi#4}
%% added by G. Drake to suppress \boldmath for subsections in TOC
%    \nobreak\hfill\nobreak
    \ifnum #1>\z@\hbox to\@pnumwidth{\hfil\reset@font\rm\ifnum#1=1\large\fi#5}
    \else\vskip8pt \nointerlineskip\fi\par}\fi}
%    \else\vskip6pt \nointerlineskip\fi\par}\fi}

%% section numbers

%\def\thesection{\thechapter.\arabic{section}}
%\def\thesubsection{\thesection.\arabic{subsection}}
%\def\thesubsubsection{\thesubsection.\arabic{subsubsection}}
\def\thesection{}
\def\thesubsection{}
\def\thesubsubsection{}

%% section style

\def\section#1{%
  \def\@tempa{#1}\def\@tempb{*}%
  \ifx\@tempa\@tempb
     \def\@tempa##1{%
        \@startsection{section}{1}{-14pt}{0.3cm plus1ex minus
           .2ex}{0.2cm plus1ex minus.2ex}{\reset@font\raggedright
           \large\bf\hyphenpenalty10000}*{\expandafter\uppercase\expandafter
                                                                    {##1}}%
     }%
  \else
     \def\@tempa{%
        \@startsection{section}{1}{-14pt}{0.3cm plus1ex minus
           .2ex}{0.2cm plus1ex minus.2ex}{\reset@font\raggedright
           \large\bf\hyphenpenalty10000}{\expandafter\uppercase\expandafter
                                                                     {#1}}%
     }%
  \fi
  \@tempa
}

\def\subsection{\@startsection{subsection}{2}{-14pt}{0.3cm plus1ex minus
.2ex}{0.2cm plus1ex minus.2ex}{\reset@font\raggedright
\large\bf\hyphenpenalty10000}}
\def\subsubsection{\@startsection{subsubsection}{3}{-14pt}{.3cm plus1ex minus
.2ex}{0.2cm plus1ex minus.2ex}{\reset@font\raggedright
\large\sl\hyphenpenalty10000}}
\def\paragraph{\@startsection
     {paragraph}{4}{\parindent}{\z@}{-1em}{\reset@font
     \normalsize\bf}}
\def\subparagraph{\@startsection
     {subparagraph}{4}{\parindent}{3.25ex plus1ex minus
     .2ex}{-1em}{\reset@font\normalsize\bf}}




\setcounter{secnumdepth}{2}

\def\appendix{\par
  \setcounter{section}{0}
  \setcounter{subsection}{0}
  \def\thesection{\Alph{section}}}

%\leftmargini 25pt
\leftmarginii 22pt
\leftmarginiii 18.7pt
\leftmarginiv 17pt
\leftmarginv 10pt
\leftmarginvi 10pt

%\leftmargin\leftmargini
\labelsep 5pt
%\labelwidth\leftmargini\advance\labelwidth-\labelsep
\settowidth{\labelwidth}{9.}
\leftmargini\labelwidth
\advance\leftmargini by \labelsep
\leftmargin\leftmargini

\def\@listI{\leftmargin\leftmargini \parsep 4\p@ plus2\p@ minus\p@
\itemsep 2.5\p@ plus1\p@ minus\p@
\topsep  6\p@ plus1\p@ minus2\p@}
%\topsep 8\p@ plus2\p@ minus4\p@
%\itemsep 4\p@ plus2\p@ minus\p@}

\let\@listi\@listI
\@listi

\def\@listii{\leftmargin\leftmarginii
   \labelwidth\leftmarginii\advance\labelwidth-\labelsep
   \topsep 4\p@ plus2\p@ minus\p@
   \parsep 2\p@ plus\p@ minus\p@
   \itemsep \parsep}

\def\@listiii{\leftmargin\leftmarginiii
    \labelwidth\leftmarginiii\advance\labelwidth-\labelsep
    \topsep 2\p@ plus\p@ minus\p@
    \parsep \z@ \partopsep \p@ plus\z@ minus\p@
    \itemsep \topsep}

\def\@listiv{\leftmargin\leftmarginiv
     \labelwidth\leftmarginiv\advance\labelwidth-\labelsep}

\def\@listv{\leftmargin\leftmarginv
     \labelwidth\leftmarginv\advance\labelwidth-\labelsep}

\def\@listvi{\leftmargin\leftmarginvi
     \labelwidth\leftmarginvi\advance\labelwidth-\labelsep}

% bibliography

%%% Following stuff to collapse refs, a la REVTEX. 9/8/94, chamlin

\def\cite{\@ifnextchar[{\@tempswatrue\@citex}{\@tempswafalse\@citex[]}}

\def\@citex[#1]#2{%
\if@filesw\immediate\write\@auxout{\string\citation{#2}}\fi
\leavevmode\@cite{\@collapse{#2}}{#1}}

\def\@cite#1#2{$^{[{#1\if@tempswa , #2\fi}]}$} %

\def\@collapse#1{%
{%
\let\@temp\relax
\@tempcntb\@MM
\def\@citea{}%
\@for \@citeb:=#1\do{%
\@ifundefined{b@\@citeb}%
{\@temp\@citea{\bf ?}%
\@tempcntb\@MM\let\@temp\relax
\@warning{Citation `\@citeb ' on page \thepage\space undefined}%
}%
{\@tempcnta\@tempcntb \advance\@tempcnta\@ne
% next line new for PROD, to keep fragile commands from blowing sky high
\expandafter\expandafter\expandafter\def
  \expandafter\expandafter\expandafter\MyTemp
  \expandafter\expandafter\expandafter{\csname b@\@citeb\endcsname}%
% \edef\MyTemp{\csname b@\@citeb\endcsname}% out in PROD
\def\@tempa{\@temptokena=\bgroup}%
\if0A{\fi%
\afterassignment\@tempa %
\@tempcntb=0\MyTemp\relax}%
\ifnum\@tempcntb=0\relax%
\@tempcntb=\@MM
\@citea\MyTemp
\let\@temp = \relax
\else %
\edef\@tempd{\number\@tempcntb}%
\ifnum\@tempcnta=\@tempcntb %
\ifx\@temp\relax %
\edef\@temp{\@citea\@tempd}%
\else
\edef\@temp{\hbox{--}\@tempd}%
\fi
\else %
\@temp\@citea\@tempd
\let\@temp\relax
\fi
\fi
}%
\def\@citea{,\,}%
}%
\@temp %
}%
}%

%%%


% cross refs across chapters

\def\@getfirstofthree#1#2#3{{#1}}
\def\@getsecondofthree#1#2#3{{#2}}
\def\@getthirdofthree#1#2#3{{#3}}

%LaTeX-2e versions for x-refs.
\def\G@refundefinedtrue{%
  \gdef\@refundefined{%
    \@latex@warning@no@line{There were undefined/empty references}}}
\let\@refundefined\relax
\def\@setref#1#2#3{%
  \ifx#1\relax
   \protect\G@refundefinedtrue
   \nfss@text{\reset@font\bfseries ??}%
   \@latex@warning{Reference `#3' on page \thepage \space
             undefined}%
  \else
  \setbox\@tempboxb=\hbox{\expandafter#2#1\null}%
   \ifdim\wd\@tempboxb=0pt
   \protect\G@refundefinedtrue
   \nfss@text{\reset@font\bfseries !?}%
   \@latex@warning{Reference `#3' on page \thepage \space
             empty}%
\else\box\@tempboxb\fi
  \fi}

\def\chapref#1{\expandafter\@setref\csname r@#1\endcsname\@getfirstofthree{#1}}
\def\ref#1{\expandafter\@setref\csname r@#1\endcsname\@getsecondofthree{#1}}
\def\pageref#1{\expandafter\@setref\csname r@#1\endcsname
                                   \@getthirdofthree{#1}}

\def\@newl@bel#1#2#3{%
  \@ifundefined{#1@#2}%
    \relax
    {\gdef \@multiplelabels {%
       \@latex@warning@no@line{There were multiply-defined labels}}%
     \@latex@warning@no@line{Label `#2' multiply defined}}%
  \global\@namedef{#1@#2}{#3}}
\def\newlabel{\@newl@bel r}
\@onlypreamble\@newl@bel
\let \@multiplelabels \relax
\def\label#1{\@bsphack
  \protected@write\@auxout{}%
         {\string\newlabel{#1}{{\thechapter}{\@currentlabel}{\thepage}}}%
  \@esphack}
\def\refstepcounter#1{\stepcounter{#1}%
    \protected@edef\@currentlabel
       {\csname p@#1\endcsname\csname the#1\endcsname}%
}


%\def\chapref#1{\@ifundefined{r@#1}{{\reset@font\bf ??}\@warning
%   {Reference `#1' on page \thepage \space
%    undefined}}{\edef\@tempa{\csname r@#1\endcsname}\expandafter
%    \@getfirstofthree\@tempa}}
%
%\def\ref#1{\@ifundefined{r@#1}{{\reset@font\bf ??.?.?}\@warning
%   {Reference `#1' on page \thepage \space
%    undefined}}{\edef\@tempa{\csname r@#1\endcsname}\expandafter
%    \@getsecondofthree\@tempa}}
%
%\def\pageref#1{\@ifundefined{r@#1}{{\reset@font\bf ???}\@warning
%   {Reference `#1' on page \thepage \space
%    undefined}}{\edef\@tempa{\csname r@#1\endcsname}\expandafter
%    \@getthirdofthree\@tempa}}
%
%\def\newlabel#1#2{\@ifundefined{r@#1}{}{\@warning{Label `#1' multiply
%   defined}}\global\@namedef{r@#1}{#2}}
%
%% \label and \refstepcounter changed to allow \protect'ed commands to
%% work properly.  For example,
%%   \def\thechapter{\protect\foo{\arabic{chapter}.\roman{section}}}
%% will cause a \label{bar} command to define \ref{bar} to expand to
%% something like \foo{4.d}.  Change made 20 Jul 88.
%
%\def\label#1{\@bsphack\if@filesw{\let\thepage\relax%
%\def\protect{\noexpand\noexpand\noexpand}%
%\edef\@tempa{\write\@auxout{\string%
%\newlabel{#1}{{\thechapter}{\@currentlabel}{\thepage}}}}%
%\expandafter}\@tempa%
%\if@nobreak\ifvmode\nobreak\fi\fi\fi\@esphack}


% here \@bsphack and \@esphack functionality duplicated around that that
%   is already present in \label, but can nest this because of names,
%   so just add extra @'s and define. 9/8/94, chamlin.
%\newdimen\@@savsk
%\newcount\@@savsf
%
%\def\keyword#1{%
%\relax\ifhmode\@@savsk\lastskip\@@savsf\spacefactor\fi
%\typeout{Keyword #1 located.}%
%\label{#1}%
%\relax\ifhmode\spacefactor\@@savsf\ifdim\@@savsk>\z@\ignorespaces\fi\fi
%\ignorespaces}
%}

%   Back to simple \unskip because this works correctly in all our cases.
%   It only fails if \keyword happens to follow an intentional skip.
%   The spaces appear when \@tempa in \label is executed. (G. Drake)
\def\keyword#1{\ifhmode\unskip\fi
\relax\typeout{Keyword #1 located.}%
\label{#1}%
}

% reference section

\def\thebibliography#1{\def\@listctr{enumiv}\section*{\refname\@mkboth
  {\uppercase{\refname}}{\uppercase{\refname}}}\small\list
  {\@biblabel{\arabic{enumiv}}}{\settowidth\labelwidth{\@biblabel{#1}}%
    \leftmargin\labelwidth
    \advance\leftmargin\labelsep
    \usecounter{enumiv}%
    \let\p@enumiv\@empty
    \def\theenumiv{\arabic{enumiv}}}%
    \itemsep=0pt \parskip=0pt
    \let\newblock\relax
    \sloppy\clubpenalty4000\widowpenalty4000
    \sfcode`\.=1000\relax}

\def\endthebibliography{%
  \def\@noitemerr{\@warning{Empty `thebibliography' environment}}%
  \endlist}
\def\@biblabel#1{#1.}
%\def\bibline{\def\@biblabel##1{}\def\@bibitem ##1{}bibitem[]
\def\@bibitem #1{\item
\if@filesw \immediate \write \@auxout
{\string \bibcite {#1}{\the \value {\@listctr }}}\fi \ignorespaces }


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% equation code from REVTeX, modified by GDrake, added in by chamlin, 9/12/94
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%  \FLL is defined in parallel with \FL through \@@indentflag and
%  \@@indentamount.  (G Drake).
%\def\@revmess#1#2{\typeout{REVTeX #1: #2}}
\def\@revmess#1#2{\relax}
\newcount\@indentflag \global\@indentflag=1 %
\newcount\@@indentflag \global\@@indentflag=1 %
\newdimen\@eqtoeqnum \@eqtoeqnum=6pt %
\def\@indentamount{%
\ifcase\@indentflag 0pt\or\@centering\or0pt plus1fil\fi\relax
}
\def\@@indentamount{%
\ifcase\@@indentflag \@indentamount\or\@centering\or 1em\fi\relax}
\def\FL{\global\@indentflag=0 }
\def\FR{\global\@indentflag=2 }
\def\FLL{\global\@@indentflag=0 \FL}
\def\FLLI{\global\@@indentflag=2 \FL}

\abovedisplayskip 8.0\p@ plus3\p@ minus4\p@
\belowdisplayskip \abovedisplayskip
\abovedisplayshortskip \z@ plus2\p@
\belowdisplayshortskip 4\p@ plus2\p@ minus2\p@

\newcounter{eqletter} \setcounter{eqletter}{0}

\def\@eqnnum{\hbox{\reset@font\rm(\theequation)}}
\let\make@eqnnum=\@eqnnum %
\def\eqnum#1{\dec@eqnnum \global\def\make@eqnnum{\reset@font\rm(#1)}%
\def\@currentlabel{#1}%
}
\def\inc@eqnnum{\addtocounter{equation}{1}}
\def\dec@eqnnum{\addtocounter{equation}{-1}}
%
%\@definecounter{equation}%
%\ifsecnumbers %
%\@addtoreset{equation}{section} %
%\def\theequation@prefix{\arabic{section}.} %
%\else %
%\def\theequation@prefix{}
%\fi
%
%\def\theequation{\theequation@prefix\arabic{equation}}%

\def\mathletters{\ifmmode\else\par\vskip-\lastskip\vskip\abovedisplayskip\fi%
\inc@eqnnum\setcounter{eqletter}{0}%
\edef\@currentlabel{\theequation}%
%   modified to agree with amo.sty
\def\theequation{\thechapter.\arabic{equation}\alph{eqletter}}%
\def\inc@eqnnum{\addtocounter{eqletter}{1}}%
\def\dec@eqnnum{\addtocounter{eqletter}{-1}}%
}

\def\endmathletters{\global\@ignoretrue}%


\def\[{\relax
\ifmmode\@badmath\else\par\vskip-\lastskip\vskip\abovedisplayskip\fi
\def\fln{\flbracket}%
\hbox to\hsize\bgroup
%\def\label##1{\@revmess{warning}{\string\label{##1} used
%in \string\[\space environment after (\theequation)}}%
\hskip\@totalleftmargin\hskip\@indentamount$\displaystyle
}

\def\]{\relax
\ifmmode
$\hskip\@centering\egroup
\else
\@badmath
\fi
\vskip\belowdisplayskip
\global\@indentflag=1 %
\global\@@indentflag=1 %
\noindent\ignorespaces
}

\newbox\@testboxa
\newbox\@testboxb

\def\equation{\par\vskip-\lastskip\vskip\abovedisplayskip
\def\fln{\fleqnum}
\inc@eqnnum\let\@currentlabel=\theequation
\setbox\@testboxa=\hbox\bgroup\hskip\@totalleftmargin\hskip\@indentamount
\hbox\bgroup$\displaystyle
}

\def\endequation{$\egroup\hskip\@centering\egroup %
\setbox\@testboxb=\hbox{\make@eqnnum}%
\bgroup
\@tempdima\wd\@testboxa \advance\@tempdima by\wd\@testboxb
\ifcase\@indentflag
\advance\@tempdima by\@eqtoeqnum
\ifdim\@tempdima<\hsize %
\def\@tempa{0}%
\else
\def\@tempa{1}%
\fi
\or
\advance\@tempdima by2\@eqtoeqnum
\ifdim\@tempdima<\hsize %
\def\@tempa{0}%
\else %
\@tempdima\wd\@testboxa \advance\@tempdima by\wd\@testboxb
\advance\@tempdima by\@eqtoeqnum
\ifdim\@tempdima<\hsize %
\def\@tempa{0}%
\setbox\@testboxa\hbox{\hfill\box\@testboxa\kern\@eqtoeqnum}%
\else
\def\@tempa{1}%
\fi
\fi
\or
\advance\@tempdima by2\@eqtoeqnum
\ifdim\@tempdima<\hsize %
\def\@tempa{0}%
\setbox\@testboxb=\hbox{\kern\@eqtoeqnum\make@eqnnum}%
\else
\def\@tempa{1}%
\fi
\fi
\ifnum\@tempa=0 %
\hbox to\hsize{\unhbox\@testboxa\box\@testboxb}%
\else %
\vbox{\hbox to\hsize{\unhbox\@testboxa}%
\vskip6pt %
\hbox to\hsize{\hfil\box\@testboxb}}%
\fi
\egroup
\global\let\make@eqnnum\@eqnnum %
\vskip\belowdisplayskip\noindent\global\@indentflag=1 %
\global\@@indentflag=1 \global\@ignoretrue
}

\def\eqnarray{\par\vskip-\lastskip\vskip\abovedisplayskip
\def\fln{\flbracket}
\inc@eqnnum\let\@currentlabel=\theequation
\global\@eqnswtrue\m@th
\global\@eqcnt\z@
\tabskip\@totalleftmargin\advance\tabskip by\@indentamount\let\\\@eqncr
%% replaced by G. Drake to set all equations flush left.
%\halign to\hsize\bgroup\hskip\@centering
\halign to\hsize\bgroup\hskip\@@indentamount
$\displaystyle\tabskip\z@{##{}}$&\global\@eqcnt\@ne
\hfil${{}##{}}$\hfil
&\global\@eqcnt\tw@ $\displaystyle\tabskip\z@{##}$\hfil
\tabskip\@centering \ifnum\@indentflag=2 \if@eqnsw
\phantom{\make@eqnnum\kern\@eqtoeqnum}\fi\fi
&\llap{##}\tabskip\z@\cr}

\def\endeqnarray{%
\@@eqncr\egroup
\vskip\belowdisplayskip\noindent
\dec@eqnnum\global\@indentflag=1 \global\@@indentflag=1
\global\let\make@eqnnum\@eqnnum %
\global\@ignoretrue
}

\def\nonumber{\global\@eqnswfalse
%\def\label##1{\@revmess{error}{\string\label{##1} used
%with \string\nonumber\space before (\theequation)}}%
}%

\def\@@eqncr{\let\@tempa\relax
\ifcase\@eqcnt \def\@tempa{& & &}\or \def\@tempa{& &}%
\else \def\@tempa{&}\fi
\@tempa \if@eqnsw\make@eqnnum\inc@eqnnum\fi
\global\@eqnswtrue\global\@eqcnt\z@\global\let\make@eqnnum=\@eqnnum\cr
}

\@namedef{eqnarray*}{\def\@eqncr{\nonumber\@seqncr}%
%\def\label##1{\@revmess{warning}{\string\label{##1} used
%in eqnarray* environment before (\theequation)}}%
\eqnarray}

\newskip\@qskip
\newbox\@tempboxb
\def\eqnsplit{\par\vskip-\lastskip
   \setbox1=\vbox\bgroup
   \begin{eqnarray*}}

\def\endeqnsplit{%
\end{eqnarray*}
   \vskip-\belowdisplayskip
   \egroup
   \addtocounter{equation}{1}
   \@qskip=-\abovedisplayskip
   \advance\@qskip by \ht1
   \@qskip=0.5\@qskip
%   \advance\@qskip by 0.5\belowdisplayskip
   \advance\@qskip by 0.9\baselineskip
%   \setbox1=\vbox{\box1 \vskip-\@qskip \hfill (\theequation)\vskip \@qskip}
   \setbox1=\vbox{\box1 \vskip-\@qskip \hfill (\theequation)\vskip \@qskip%
     \vskip-\baselineskip}
%   \box1\vskip -2\belowdisplayskip\noindent\global\@ignoretrue
   \box1\vskip\belowdisplayskip\noindent\global\@ignoretrue
}
%    miscelaneous definitions (G Drake)
\def\AA{\leavevmode\setbox0\hbox{h}\dimen@\ht0\advance\dimen@-1ex%
  \rlap{\raise.67\dimen@\hbox{\char'27}}A}
\def\case#1#2{\mbox{$\frac{#1}{#2}$}}
\def\tab#1{&#1&}
%    \lambdabar from REVTeX.
\def\lambdabar{\protect\@lambdabar}
\def\@lambdabar{%
\relax
\bgroup
\def\@tempa{\hbox{\raise.73\ht0
\hbox to0pt{\kern.25\wd0\vrule width.5\wd0
height.1pt depth.1pt\hss}\box0}}%
\mathchoice{\setbox0\hbox{$\displaystyle\lambda$}\@tempa}%
{\setbox0\hbox{$\textstyle\lambda$}\@tempa}%
{\setbox0\hbox{$\scriptstyle\lambda$}\@tempa}%
{\setbox0\hbox{$\scriptscriptstyle\lambda$}\@tempa}%
\egroup
}
%  Define \gtsim and \ltsim for greater than or approx. equal to, and
%  less than or approx. equal to.
\def\gtsim{\,\mbox{\raisebox{-.5ex}{$\sim$}} \mbox{\hspace{-.8em}} \mbox{\raisebox{.6ex}{$>$}~}\,}
\def\ltsim{\,\mbox{\raisebox{-.5ex}{$\sim$}} \mbox{\hspace{-.8em}} \mbox{\raisebox{.6ex}{$<$}~}\,}
%
\def\boldbox#1{\mathchoice{\mbox{\protect\boldmath{$#1$}}}%
{\mbox{\protect\boldmath{$#1$}}}{\mbox{\protect\boldmath{$\scriptstyle #1$}}}%
{\mbox{\protect\boldmath{$\scriptstyle #1$}}}}
%  put bold hat on boldface character
\def\bhat #1{{\bf\hat{\ifcat\noexpand#1a#1\else{\ifcat\noexpand#11#1%
   \else\boldbox{#1}\fi}\fi}}}
%  define bold "dot" for vector dot product.
\def\bdot{\boldbox{\cdot}\kern0.5pt}
%
%  function \stretchline{}to stretch a line to fill column width.
\newlength{\cn@t}                                                 %%
\def\stretchline#1{\setlength{\cn@t}{\columnwidth}                %%
\addtolength{\cn@t}{-\leftmargin}\leavevmode\hbox to \cn@t{#1}}   %%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newskip\captionsep
\newskip\footlinesep
\newskip\footnotesep
\newskip\prehlineskip
\newskip\posthlineskip
\newskip\t@thlineskip

%   parameters for fine tuning of table layout as follows:
%                         Caption ....
\captionsep 3.5pt
%                         -------------------------------------------
\def\headstretch{1.25}
%\def\headstretch{1.00}
%                         Col. label       Col. label ...
%\prehlineskip 0.2ex    0.22293 not ok, 0.22294 ok with headstretch = 1.
\prehlineskip 1.248pt
%                         -------------------------------------------
\posthlineskip 0.5ex
%                         Body of table ...
\footlinesep 0.3ex
%                         -------------------------------------------
\footnotesep 0.67ex
%                         Footnotes ....
%
\t@thlineskip = \prehlineskip
\advance\t@thlineskip by \posthlineskip
%   Make centered tables independent of lists.
%\advance\captionsep-\topsep
\advance\footnotesep-\topsep
\xdef\s@vestretch{\arraystretch}

%    In the following, \tabular replaced by \@tabular so that modifications
%    also apply to the \tabular* environment (G. Drake).
\catcode`@=12
\newtoks\lltemp
\newtoks\rrtemp
\newtoks\cctemp
\lltemp={l@{\extracolsep{0pt}}}
\rrtemp={r@{\extracolsep{0pt}}}
\cctemp={c@{\extracolsep{0pt}}}
\xdef\lo{\the\lltemp}
\xdef\ro{\the\rrtemp}
\xdef\co{\the\cctemp}
\lltemp={l@{\extracolsep{\fill}}}
\rrtemp={r@{\extracolsep{\fill}}}
\cctemp={c@{\extracolsep{\fill}}}
\catcode`@=11

% Modification for tables immediately following \section etc.
% G. Drake - Feb. 21, 1996.
\@mytoksa={\ifoutertab\topsep 6pt\partopsep 2pt\begin{center}%
\ifdim\lastskip>\z@\vskip-\lastskip\vskip 2pt\fi\nointerlineskip\vskip\captionsep\hrule
    \xdef\s@vestretch{1}\xdef\arraystretch{\headstretch}
%    \xdef\s@vestretch{\arraystretch}\xdef\arraystretch{\headstretch}
\xdef\l{\the\lltemp}
\xdef\r{\the\rrtemp}
\xdef\c{\the\cctemp}
    \fi\begingroup\outertabfalse}
\@mytoksb=\expandafter{\@tabular}
\xdef\@tabular{\the\@mytoksa\the\@mytoksb}

\@mytoksa=\expandafter{\endtabular}
%    \@mytoksb modified by G. Drake 9/15/94 to add \vskip's.
%    \vskip 0.001pt is used to defeat the subsequent \unskip.
\@mytoksb={\endgroup\ifoutertab\vskip\footlinesep\hrule
   \vskip\footnotesep\vskip 0.001pt\end{center}\fi}
\xdef\endtabular{\the\@mytoksa\the\@mytoksb}
\expandafter \let \csname endtabular*\endcsname = \endtabular

%    modified from LaTeX by G. Drake 9/15/94 to add \vskip's,
%    and restore \arraystretch and \@arstrutbox for body of table.
\def\hline{\noalign{\ifnum0=`}\fi\vskip\prehlineskip\hrule \@height \arrayrulewidth \vskip\posthlineskip
  \global\xdef\arraystretch{\s@vestretch}
  \global\setbox\@arstrutbox=\hbox{\vrule
  height\arraystretch \ht\strutbox
  depth\arraystretch \dp\strutbox
  width\z@}
\futurelet\@tempa\@xhline}

\def\@xhline{\ifx\@tempa\hline\vskip-\t@thlineskip\vskip \doublerulesep\fi
      \ifnum0=`{\fi}}

%========================================================================
% Definition of combined equation and picture environment.
%\begin\eqnpict(#1,#2)(#3,#4)(#5)
%  #1 = width of picture.
%  #2 = height of picture (determines space allowed in text).
%  #3 = extra displacement to the left.
%  #4 = extra displacement down.
%  #5 = displacement of eq. no. from centre (positive for down).
%\end{eqnpict}
%%
\newdimen\@eqloc
\newdimen\@ysave
\newdimen\colwidth
\colwidth=0.5\textwidth\advance\colwidth -0.5\columnsep
%
\def\@eqnpict(#1,#2)(#3,#4){\@picht #2\unitlength
\setbox\@picbox\hbox to #1\unitlength\bgroup
\hskip -#3 \lower #4 \hbox\bgroup\ignorespaces}
%
\def\end@eqnpict{\endpicture}
%
\def\eqnpict(#1,#2)(#3,#4)(#5){\par\vskip-\lastskip\vskip\abovedisplayskip
\inc@eqnnum\let\@currentlabel=\theequation
\bgroup
\@xdim=-#1\unitlength\advance\@xdim\colwidth
\@ysave=#2\unitlength
\@eqloc=.5\@ysave
\setbox\@testboxa\hbox{(\theequation)}
\advance\@xdim -\wd\@testboxa\divide\@xdim by 2
\advance\@eqloc by #5\unitlength
\@ydim=#4\unitlength\advance\@ydim -#2\unitlength
\par\noindent\ifdim\@xdim>0pt\hskip\@xdim\fi
\begin{@eqnpict}(0,0)(#3\unitlength,\the\@ydim)\ignorespaces}%
%
\def\endeqnpict{\end{@eqnpict}%
\@ydim\@ysave\advance\@ydim -\@eqloc\advance\@ydim -2.5pt
\setbox\@picbox\hbox{\rule{0pt}{\@ysave}%
\raise \@ydim\hbox{(\theequation)}}\hfill\box\@picbox%
\vskip\belowdisplayskip\egroup\noindent\global\@ignoretrue}
%
% Macros from TCILaTeX
\def\RIfM@{\relax\ifmmode}%
%Companion to stackrel
\def\stackunder#1#2{\mathrel{\mathop{#2}\limits_{#1}}}%
\def\text#1{\mbox{#1}}
\def\dsum{\mathop{\displaystyle \sum }}%
\def\tfrac#1#2{{\textstyle {#1 \over #2}}}%
\def\dfrac#1#2{{\displaystyle {#1 \over #2}}}%
\def\QATOP#1#2{{#1 \atop #2}}%
\def\QTATOP#1#2{{\textstyle {#1 \atop #2}}}%
\def\QDATOP#1#2{{\displaystyle {#1 \atop #2}}}%
\long\def\TeXButton#1#2{#2}%
\def\QTR#1#2{{\csname#1\endcsname #2}}%(gp) Is this the best?

%\makeindex
\endinput
% end of file amo.sty
